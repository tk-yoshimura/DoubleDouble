using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class EllipticFunctionTests {
        [TestMethod]
        public void EllipticKTest() {
            ddouble[] expecteds = {
                "1.311028777146059905232419794945559706841",
                "1.313822521602589932785737602386333742705",
                "1.316641860447711171700198953321625573022",
                "1.319487225274569533321064057717161032722",
                "1.322359058397556893387197019618083211351",
                "1.325257813206285230088993846901426835783",
                "1.328183954534201614989195685134639646133",
                "1.331137959042574144402942806333049787831",
                "1.334120315620621629167376588489276788078",
                "1.337131525802605468712331684470317129129",
                "1.340172104202750840587260500299613905516",
                "1.343242578968916377486557127051506571809",
                "1.346343492255987139270874119806492844022",
                "1.349475400720025198937944412070579649756",
                "1.352638876034275855061587700909744623005",
                "1.355834505428195692077008317847124135695",
                "1.359062892250741796861736238323674147272",
                "1.362324656559239800937708968100614812060",
                "1.365620435735232483833147210176808609048",
                "1.368950885128800915786323708787316455926",
                "1.372316678732947051725405953486726501109",
                "1.375718509889730876056996966488123243126",
                "1.379157092029967255017791487872130220672",
                "1.382633159448408254553030245390195654618",
                "1.386147468116466566020136774629062217040",
                "1.389700796534675660293833222990863326713",
                "1.393293946627233253284408670352225489335",
                "1.396927744681137590715846583551686794604",
                "1.400603042332602023180180836809718604614",
                "1.404320717603623528450070494886909611956",
                "1.408081675991786551937748300292462998034",
                "1.411886851616606217520138233461175561848",
                "1.415737208425956198892165965423613532473",
                "1.419633741466388092343295470085255181151",
                "1.423577478221432938048159068735476541996",
                "1.427569480022283749790175353618877138870",
                "1.431610843535592917031509532700845427527",
                "1.435702702333482784439893945251779468042",
                "1.439846228551264531798477104902532753660",
                "1.444042634638792940616600529524495454375",
                "1.448293175211856382304508764595670235339",
                "1.452599149010516453395878820515528113281",
                "1.456961900971874643489724084176756772154",
                "1.461382824425359310109072962305113826154",
                "1.465863363419300710944125088010808453797",
                "1.470405015188301247349238011584774886866",
                "1.475009332771719513778209490646364721366",
                "1.479677927794478211580972543838506598435",
                "1.484412473422386452907343887925897958167",
                "1.489214707505246565246816816636192644853",
                "1.494086435922205615692548833135316687572",
                "1.499029536145125389037968716045263797715",
                "1.504045961037196047202439394644583143152",
                "1.509137742905624677125251283581216633723",
                "1.514306997829009130628528630964508377000",
                "1.519555930281981259362721420858958347928",
                "1.524886838081896082232208976852428428240",
                "1.530302117684782222175295771115219779171",
                "1.535804269860485675170364492938434548120",
                "1.541395905779969742701215898255655563624",
                "1.547079753551120173209579004972943717930",
                "1.552858665243193773431993887183098410082",
                "1.558735624444295693735157847096045117534",
                "1.564713754401038368379572630580725617048",
                "1.570796326794896619231321691639751442099",
                "1.576986771215813142124403053228808080382",
                "1.583288685400424467834512481846404542297",
                "1.589705846309983478854188856183168840001",
                "1.596242222131783510148969071497949879506",
                "1.602901985297796194899595693857169929056",
                "1.609689526625502369048575814940384280546",
                "1.616609470698736063142211740574470552222",
                "1.623666692621027323464926297218007730743",
                "1.630866336290717176779250478449835999908",
                "1.638213834366378955857038295184925651749",
                "1.645714930113231773852407148469514701781",
                "1.653375701346771208939713955078915548290",
                "1.661202586719363028752815025000156828695",
                "1.669202414629759719643593847915060753000",
                "1.677382435075262495085563772069234376033",
                "1.685750354812596042871203657799076989501",
                "1.694314376247740184839825165621903568713",
                "1.703083240538492139398334147676236628499",
                "1.712066275468270414988459985659563777503",
                "1.721273448737889660359178078725676366211",
                "1.730715427426532021355366325537346985260",
                "1.740403644497371368395497664706511221821",
                "1.750350373371563761220239626820809198348",
                "1.760568811771954495787446718089955385429",
                "1.771073176251581444370173363882960896208",
                "1.781878809080336200262569749752396240989",
                "1.793002299476700193289563657076436273826",
                "1.804461621553968222373600625610670759688",
                "1.816276291819331182734396045846770312043",
                "1.828467549642229195725066223199414850585",
                "1.841058564824889077152012806705465059630",
                "1.854074677301371918433850347195260046218",
                "1.867543675112457692676500068417255056187",
                "1.881496118219621122748647418095262114722",
                "1.895965717522425286122280812067898297925",
                "1.910989780751829196553148218761342559253",
                "1.926609739893582920450191931223535890369",
                "1.942871778680434609327759540683773642856",
                "1.959827583798844600024972758211979273007",
                "1.977535250235611428253516532627795954406",
                "1.996060380284727858764126571705948161026",
                "2.015477428073705161311473896289558325034",
                "2.035871358413585753245350234081539258498",
                "2.057339712356378169733488050058303384784",
                "2.079995205129674679276612360896141580852",
                "2.103969029848747389220371705983744677231",
                "2.129415110036352177279981271719275922987",
                "2.156515647499643235438674998800322028864",
                "2.185488469278223686913080323730158689730",
                "2.216596921627807102342718723262938628408",
                "2.250163448669196475776138067004540472233",
                "2.286588633650667991686729186098045732541",
                "2.326378569035678846420299092711924217737",
                "2.370185344296105705673486664430425773553",
                "2.418868993809016045900274727784415867562",
                "2.473596173751343911975589752733039465815",
                "2.536005227467480679724400685529749852156",
                "2.608499627175084267858481569466979096393",
                "2.694811911971635312977987861752946067877",
                "2.801206084665204046360361673619437209228",
                "2.939446126743500419208180657425821245078",
                "3.135992158076202184437643690967039845094",
                "3.475447457496819511777186630121955422167"
            };

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticK(m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticETest() {
            ddouble[] expecteds = {
                "1.910098894513856008952381041085721645955",
                "1.905411215387931619682406730567280051397",
                "1.900708546529360647988455595862534435963",
                "1.895990732791744916122647243383500390971",
                "1.891257616240004171800827289006995366104",
                "1.886509036078205936830657745092336508654",
                "1.881744828574941557880851952861154896486",
                "1.876964826986144644613995757819138832971",
                "1.872168861475242807751118793763676557427",
                "1.867356759030528023588439554135467122415",
                "1.862528343379625030656241032447173953868",
                "1.857683434900930885555534148206510982617",
                "1.852821850531892143694417239933353356354",
                "1.847943403673979059886394596338448102206",
                "1.843047904094208694658692571350269767037",
                "1.838135157823060833430798275509206284502",
                "1.833204967048622143726142625544452760370",
                "1.828257130006784973793236436534659827415",
                "1.823291440867317594963180848136600327718",
                "1.818307689615612467016288742099841085646",
                "1.813305661929908214458092148401394300685",
                "1.808285139053769391695320480776531564993",
                "1.803245897663595732162445544407056209615",
                "1.798187709730919361304683605593978678287",
                "1.793110342379234341667903876174744136954",
                "1.788013557735087840243820347639470904959",
                "1.782897112773146087552428743157691963357",
                "1.777760759154931051801409722287462656738",
                "1.772604243060905289459741494512323896454",
                "1.767427305015562657108227636935252395034",
                "1.762229679705161370804817528401959611863",
                "1.757011095787713160748895740296879786369",
                "1.751771275694817862026501838984512041414",
                "1.746509935424906565746094720108516012744",
                "1.741226784327428274511982987024013761010",
                "1.735921524877484692562165234621892957972",
                "1.730593852440385148081478928956394016292",
                "1.725243455025558488864628818416027788924",
                "1.719870013029220887895391694788658297840",
                "1.714473198965157595059995877409890955527",
                "1.709052677182932502364253674201120496417",
                "1.703608103572791651723565528804460469968",
                "1.698139125256475174229439333740570793389",
                "1.692645380263096240201078105597438188413",
                "1.687126497189185013417898968827541738792",
                "1.681582094841929889765035087313962879869",
                "1.676011781864576959777254359220197612637",
                "1.670415156342871110431490288264826577286",
                "1.664791805391337855827232677690668000837",
                "1.659141304718113170675208093639100631092",
                "1.653463218166928527144181111344174975895",
                "1.647757097234749147497366527698174171797",
                "1.642022480563444223822209319197881495368",
                "1.636258893403737449171767475943257437587",
                "1.630465847049543448754147551057458440173",
                "1.624642838240639244890810654515476936991",
                "1.618789348531448216682358353347551753736",
                "1.612904843623525414410165919527655914578",
                "1.606988772659125630569180002795579540704",
                "1.601040567473007134634595338912734769051",
                "1.595059641799371980868588815588244729380",
                "1.589045390430565501900464522403149250391",
                "1.582997188323849830716400330773053213831",
                "1.576914389652225438489527846127335433735",
                "1.570796326794896619231321691639751442099",
                "1.564642309262556894432573809162726348812",
                "1.558451622552203074196241225507151658254",
                "1.552223526925666030918786333873743344283",
                "1.545957256105465034950412439920610612017",
                "1.539652015880942614952994349377704121844",
                "1.533306982616908930541600250946435198301",
                "1.526921301656207700637980170791955730154",
                "1.520494085606697204776575183367852127363",
                "1.514024412502105109430704365649183056112",
                "1.507511323825047792128701171147486880523",
                "1.500953822379183498450923308152845466788",
                "1.494350869995970712483570005666964564066",
                "1.487701385059801116221901493214322862662",
                "1.481004239833338144245486253424661157028",
                "1.474258257562679230883104710173186919456",
                "1.467462209339427155459795266990916136025",
                "1.460614810693849625728995877851527717163",
                "1.453714717889962229250741269948828132958",
                "1.446760523889511305428185712162640276480",
                "1.439750753947367844854309876665730819549",
                "1.432683860795659883788094479571374322165",
                "1.425558219367934232788193723237029812651",
                "1.418372121007584864635847035771534998823",
                "1.411123767096514752546251031667024451041",
                "1.403811262030264903115686232825870910848",
                "1.396432605454346217356590247247887913419",
                "1.388985683662871916053531826740146996508",
                "1.381468260044344065330349153992028798642",
                "1.373877964440013265237412598744235715176",
                "1.366212281256870631643524897703955809219",
                "1.358468536149114656320927388032779490797",
                "1.350643881047675502520174735338725841350",
                "1.342735277275552795496778300996727275956",
                "1.334739476435361799343854437390976563942",
                "1.326652998692024300566133381256361066466",
                "1.318472107994620997371842794497930930603",
                "1.310192783682589568876562034128701823610",
                "1.301810687796760389663726021044820319647",
                "1.293321127257150860432173162453826895891",
                "1.284719009866063196619995708659895713811",
                "1.275998792831796528565272550687606072574",
                "1.267154422164207183376791836112837595468",
                "1.258179260838798560780214178796743285989",
                "1.249066003018567637514700647249200107915",
                "1.239806570800815200800950762984528750725",
                "1.230391988828439807058927441530411703448",
                "1.220812230534859095994658627212167640451",
                "1.211056027568459524803562899548978676494",
                "1.201110630736914697794518710797492052304",
                "1.190961506094848633304973210479384947333",
                "1.180591942697681287846662735354380583095",
                "1.169982537577002396340474563375145196732",
                "1.159110506049795300438964492342998827029",
                "1.147948736783822538094599525589385922037",
                "1.136464461974017156198235279940278114495",
                "1.124617325119752213158613719354261980648",
                "1.112356462659774003758220423882152916982",
                "1.099615879389268469753904131999471451112",
                "1.086306657414100891123787901941189062217",
                "1.072302721894604277869651076107464594147",
                "1.057411715024108431749476615851308004636",
                "1.041304202018977361305105434385948585556",
                "1.023279893756109396403927911329924147047",
                "1.000000000000000000000000000000000000000"
            };

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticE(m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNp0p75Test() {
            ddouble[] expecteds = {
                "2.477710158375750016700255445589138128515",
                "2.484542040045383273737267327344449272219",
                "2.491443313913927138869434692904220317022",
                "2.498415224196370770293883547296380915289",
                "2.505459047349383686797028608639823751624",
                "2.512576093169835300361884184104195738039",
                "2.519767705939882878635874247966667349400",
                "2.527035265620996875256728822368846614774",
                "2.534380189099433527474411760736196897691",
                "2.541803931485815208827350051681465165572",
                "2.549307987471639983436778201124110993679",
                "2.556893892745713945589967211443047274835",
                "2.564563225473684121858587629497970915351",
                "2.572317607844046918345523621180368050111",
                "2.580158707684218352715186692252008088023",
                "2.588088240150478752328121742256463354991",
                "2.596107969495847461108143435851480463071",
                "2.604219710920203726108767390122026197940",
                "2.612425332507249801179963133147749823163",
                "2.620726757253213016984293442133247745252",
                "2.629125965192506881429149960936241103992",
                "2.637624995625919115725091420340799298833",
                "2.646225949457269005240398090200201895129",
                "2.654930991644879860053051196911948343098",
                "2.663742353774647270591823679977952449735",
                "2.672662336761952990129593187513720622368",
                "2.681693313690180734349430977757825061284",
                "2.690837732794137320206435388627438365956",
                "2.700098120597274072379357572001743849637",
                "2.709477085212243383265671521225547883263",
                "2.718977319815018218838814697827813286262",
                "2.728601606303553182369674997314566823296",
                "2.738352819152779967041632991033763661627",
                "2.748233929478613715059875855477716674194",
                "2.758248009324606673903330940952804905584",
                "2.768398236185929047001222934453752097134",
                "2.778687897786492339218996695448145309028",
                "2.789120397126266974966552188833439926834",
                "2.799699257817193723811708302868302580109",
                "2.810428129727558865690048190725737850924",
                "2.821310794956308726037147745813718493293",
                "2.832351174160534337035636559192806090152",
                "2.843553333261277315476619472629862121989",
                "2.854921490554911240698552387592488431442",
                "2.866460024259658633373538165521393168354",
                "2.878173480529334240491042398963799312088",
                "2.890066581969185607070528972492949352654",
                "2.902144236691759835840867018264014143651",
                "2.914411547954092495936561385524937735472",
                "2.926873824421226344959115864473449691554",
                "2.939536591105163958805038388156469648559",
                "2.952405601032884839512123506423052148924",
                "2.965486847702065408733056617803531962820",
                "2.978786578388687688653502993361787739643",
                "2.992311308376875524718708860758013535004",
                "3.006067836188131118707996608510567575982",
                "3.020063259894745116972868880501954700089",
                "3.034304994610618366401622146707823546610",
                "3.048800791262174580139644216492546458495",
                "3.063558756752588702500486583518998515209",
                "3.078587375644352811973515148116010978269",
                "3.093895533498419080607011713369190491968",
                "3.109492542022992471925503075110404433849",
                "3.125388166201719453069258673581159373350",
                "3.141592653589793238462643383279502884197",
                "3.158116765987672634484588810957320398650",
                "3.174971813726040889569283066809595156396",
                "3.192169692822721169290747731394975129469",
                "3.209722925302992672622162011428473211997",
                "3.227644703009673219497021314626179164650",
                "3.245948935269103905180708633449925585403",
                "3.264650300824557563469789083949839727327",
                "3.283764304500501213502136356445820250378",
                "3.303307339120644266995220431403044732381",
                "3.323296753271068512679322232472504614018",
                "3.343750925578472034266985880506857834806",
                "3.364689346264467014828589385971633266595",
                "3.386132706842103698631726898292470064691",
                "3.408102998942933202033368759287962972689",
                "3.430623623405081256522575981598915868684",
                "3.453719510918742140223065947190538656273",
                "3.477417255719775135273372385121686776703",
                "3.501745264050243019698793239522836668184",
                "3.526733919373553035012511398021764356800",
                "3.552415766649663661816470462572816342998",
                "3.578825718352854486859773690817808622948",
                "3.606001285363505466222716217203569250053",
                "3.633982836401965728100287969682271473560",
                "3.662813890316611300718105224598576344725",
                "3.692541446314330953343932249974253264227",
                "3.723216358161159703688391362828932722297",
                "3.754893759523223058856396763868388438922",
                "3.787633549014139671105518232990512244807",
                "3.821500945229511012816289105511760523080",
                "3.856567124166056980124539655998436866623",
                "3.892909954051574448872939609151425668051",
                "3.930614845895350913875751766062302351104",
                "3.969775742195951715233063460430946580908",
                "4.010496271465918964865639645597226495667",
                "4.052891102888370590641085968416792490803",
                "4.097087543965707836739217492660174163824",
                "4.143227435080151055441728722329421173936",
                "4.191469409321823850224484589617981745764",
                "4.241991604955771493203345921977413890561",
                "4.294994943193040359614488154675194640390",
                "4.350707117929968843837333107853266190799",
                "4.409387490339156228567125949366475701138",
                "4.471333144798777352444464107304924278278",
                "4.536886451337544602722067458256819621439",
                "4.606444605238025926945572797329331083935",
                "4.680471794739557404098730545469708933328",
                "4.759514911379342146068550498371502728946",
                "4.844224110273838099214251598195914705977",
                "4.935380125293062643123447893401974747617",
                "5.033931175033695836255194969544187016013",
                "5.141043784182555315082498534844279943610",
                "5.258174297007593616076759492674163108337",
                "5.387172037487060787561066292693906862897",
                "5.530432470024246646571468883670993471624",
                "5.691132425460332561445085413733009466640",
                "5.873606252091230580774851191703220955123",
                "6.083977570987410547335711217665777582332",
                "6.331287061746980144368960560637955608074",
                "6.629669289392392127048364623313737750964",
                "7.003015211663010115900904184048593023070",
                "7.496538831993589013284337648603819157035",
                "8.212797131164662505497922794808371830220",
                "9.482884976178598685801026347821389702232"
            };

            const double n = 0.75;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNp0p50Test() {
            ddouble[] expecteds = {
                "1.800473988685746308971971577274643085483",
                "1.804898426013661011343256740050006410364",
                "1.809365720667221539643262472670601089498",
                "1.813876618949480656073798836361705683087",
                "1.818431886106051807309534569512399612605",
                "1.823032306960389888455925318813649597462",
                "1.827678686575665256441728813006553523929",
                "1.832371850944569811371956706404279191532",
                "1.837112647708472935048280017706444033474",
                "1.841901946907429399445983329572091165593",
                "1.846740641762631445198501545449878775060",
                "1.851629649492993527129021789278833039885",
                "1.856569912167661215253118103391272050301",
                "1.861562397596345952455367952009039072962",
                "1.866608100259505377640778437131205511351",
                "1.871708042280515349961962301131989004289",
                "1.876863274442115336087267417308940800377",
                "1.882074877249554190307345403262286647320",
                "1.887343962043019376195174725982138565044",
                "1.892671672162100232719980936889812242028",
                "1.898059184165215943531602550647468234878",
                "1.903507709107132482591656028313036052732",
                "1.909018493877901139525117765445068217627",
                "1.914592822606775541685055707371911330448",
                "1.920232018134905776963527465703572702016",
                "1.925937443560868807249439421220293846288",
                "1.931710503863375522577035132144441361833",
                "1.937552647605798362290600743065332244376",
                "1.943465368727491448594488842032705438418",
                "1.949450208427229871611656784661368804547",
                "1.955508757144478593902739201020368508070",
                "1.961642656644617121028052017030570638061",
                "1.967853602214696611449820735115032303059",
                "1.974143344976794788594032208054177333807",
                "1.980513694326564538467058392202774011720",
                "1.986966520505148491493242890160987392289",
                "1.993503757313258703578110368397539037582",
                "2.000127404976902771489690173074275239087",
                "2.006839533174980901204267929056314185584",
                "2.013642284239788780547667843741549134338",
                "2.020537876542345479203606285010221476727",
                "2.027528608075431693253454925001446439312",
                "2.034616860248280046070309763679215466195",
                "2.041805101908015441621361675668199834028",
                "2.049095893604210372260907717885096129105",
                "2.056491892114309637925910278645444651425",
                "2.063995855249204632788446506409352905044",
                "2.071610646959914362342418172938500892134",
                "2.079339242768175729371344369072091452266",
                "2.087184735545778593471200160517083691782",
                "2.095150341669723354187801998226449115896",
                "2.103239407582754839145030486748807591509",
                "2.111455416791563828654013424545758572624",
                "2.119801997337978049029414120752232224837",
                "2.128282929781823598414231447822850647399",
                "2.136902155737866099541439902484756240385",
                "2.145663787013384605764275086628720872093",
                "2.154572115397543127971171864979844526095",
                "2.163631623158864835677573848153343410761",
                "2.172846994312851475788390574120908567660",
                "2.182223126728204441686122648971420520767",
                "2.191765145147285103109261264553715981200",
                "2.201478415204505120850077504843453566126",
                "2.211368558535383247562617006535848840104",
                "2.221441469079183123507940495030346849307",
                "2.231703330689518500580313543719463678675",
                "2.242160636180265890872850342806649687879",
                "2.252820207948778275550337719514293069032",
                "2.263689220335001996037386258202690828189",
                "2.274775223893960137562171808308428605604",
                "2.286086171780528689613000470458580502273",
                "2.297630448469906695582521163122548824684",
                "2.309416901065151688137349066431409215699",
                "2.321454873475187738880209151988226767180",
                "2.333754243783471579551302913204085862342",
                "2.346325465169825757447960314351498013651",
                "2.359179610796773853956500698661240451062",
                "2.372328423128185548852605110707490221901",
                "2.385784368213530748181187568109065154812",
                "2.399560695547202859969421575730346966036",
                "2.413671504201194640666923520539289936849",
                "2.428131816033310833371372216790840268438",
                "2.442957656895017310356854915556730447526",
                "2.458166146906542963147586509487436920927",
                "2.473775601036364833425443182377642615688",
                "2.489805641423131845902452448605030042071",
                "2.506277323117111366699863963562751911936",
                "2.523213275203690513305869653505644648423",
                "2.540637859613709442085222483552072739318",
                "2.558577350337466814855231084631689244273",
                "2.577060136257537814759546970801072479659",
                "2.596116951420903105594386727310343652300",
                "2.615781137309857184619052473199791294016",
                "2.636088942577818929372620290753535618957",
                "2.657079866834503928577963052489336883382",
                "2.678797056452135204266021735091732095215",
                "2.701287762095351005040349470677451682699",
                "2.724603869850991097776944245385206050925",
                "2.748802520581327204971747895809556496497",
                "2.773946835621603911005954809410012215686",
                "2.800106771428104638172933908972820171837",
                "2.827360131581500623719358947004386708206",
                "2.855793772110422988683197969472847521570",
                "2.885505046047182558698646248543645996640",
                "2.916603546342931845080836525412853177728",
                "2.949213224011889828282488052779490388678",
                "2.983474982464242872931568818398771702413",
                "3.019549882096787224523520375934347354847",
                "3.057623135321011206452538605486303440631",
                "3.097909137354299748638036876829610565496",
                "3.140657871594373122496463824585638275316",
                "3.186163164903645047646893807444600729577",
                "3.234773471249464853158012498200483043296",
                "3.286906170793683540936071283381826634031",
                "3.343066851618606626062947673090788935967",
                "3.403875807878793513889073528093814061192",
                "3.470105249031650587148874590534317834719",
                "3.542732859694054499354613291357503190081",
                "3.623021142666066998133159693830939911148",
                "3.712638994629356155140172280880546984950",
                "3.813855654722725601018092359142685101860",
                "3.929865638331331889629327419438789727660",
                "4.065367295837246049850859614576354955427",
                "4.227676505779574777601391209438225080819",
                "4.429105250459929276011454932665585822315",
                "4.692844330034645603011756639337770859326",
                "5.071221894438481651723831819379051690532",
                "5.732149060091635576281067134097686631742"
            };

            const double n = 0.50;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNm8Test() {
            ddouble[] expecteds = {
                "0.4772507191595812077460399481301857432433",
                "0.4777859516603065096626794459370511224573",
                "0.4783251742277098473505182414980472231723",
                "0.4788684480400609062799383530863344051254",
                "0.4794158357156062938183915793260287924139",
                "0.4799674013584961277070232036794076285195",
                "0.4805232106065650768324344899505903782113",
                "0.4810833306810587077303929704470381125648",
                "0.4816478304384012360650599257482542952273",
                "0.4822167804241063776385916954652735250134",
                "0.4827902529289389647439391362083855931298",
                "0.4833683220474413695637181035907261209702",
                "0.4839510637389455879800471802108294308525",
                "0.4845385558911991184217793835953055173003",
                "0.4851308783867405580092881030974233965212",
                "0.4857281131721691722654553362580041194213",
                "0.4863303443304616185921516178680542489649",
                "0.4869376581564985650053579333699511788472",
                "0.4875501432359741960005110756007226809876",
                "0.4881678905278725933131863736500980352564",
                "0.4887909934507067823648068499589076985086",
                "0.4894195479727289126693152979504390478122",
                "0.4900536527063336660587730909681669639600",
                "0.4906934090068916408568635746411154674241",
                "0.4913389210762652313723370685695482078373",
                "0.4919902960712765070877521781943129107421",
                "0.4926476442174149008863719412172143072074",
                "0.4933110789280922572293996411305476861133",
                "0.4939807169297740975775356860951851357575",
                "0.4946566783933389726051964642421307235087",
                "0.4953390870720426442238283575810066004415",
                "0.4960280704464907463423116206623086913745",
                "0.4967237598770527005727811696648448402559",
                "0.4974262907641812203937821201054110307452",
                "0.4981358027171359552845695410154741563437",
                "0.4988524397316469603250468586442004395039",
                "0.4995763503770940095208671419931176874665",
                "0.5003076879938216162950091356335946422834",
                "0.5010466109012573303837712384113295025047",
                "0.5017932826175528337895589645824403439797",
                "0.5025478720915239900958804602409520091186",
                "0.5033105539477277910521383546447888272171",
                "0.5040815087455816269170130439047844124202",
                "0.5048609232535040800612111886084080130309",
                "0.5056489907391371727560590060281291056269",
                "0.5064459112767984377008453591051841409500",
                "0.5072518920734081618793298347871273376791",
                "0.5080671478142436215984936667513333328856",
                "0.5088919010299891364612578589504618279601",
                "0.5097263824866795126689264560442524909685",
                "0.5105708316002762628058119224262607484500",
                "0.5114254968777723941814917821646295225228",
                "0.5122906363868942624199851419945127923867",
                "0.5131665182566599290031087772404927696465",
                "0.5140534212112648381358803548201026345011",
                "0.5149516351399999351398699495864751597427",
                "0.5158614617061674246058380127125276673732",
                "0.5167832149982484469853985008308201301687",
                "0.5177172222268987303503256185731177430197",
                "0.5186638244717069731744239012606443141244",
                "0.5196233774820511729886889899084882629838",
                "0.5205962525368358888421085657801626652964",
                "0.5215828373683949004581675562946556808553",
                "0.5225835371564062649422743899527183489789",
                "0.5235987755982988730771072305465838140329",
                "0.5246289960633411079458538859978689850043",
                "0.5256746628384045160454323732804039417959",
                "0.5267362624743017738409899903128338987673",
                "0.5278143052426241171053420614052221064246",
                "0.5289093267141668340585001472374044880382",
                "0.5300218894713535219880527287059137807685",
                "0.5311525849685753524825298370203921371531",
                "0.5323020355560797433107559631731915974417",
                "0.5334708966850080016175517574923344575582",
                "0.5346598593134343927900873037629216182556",
                "0.5358696525358480087506843851643376497660",
                "0.5371010464615012524837075558110102553994",
                "0.5383548553704933635184207498476336715099",
                "0.5396319411804463957016860412193155508097",
                "0.5409332172612632231580153194124854431084",
                "0.5422596526408516351282497452930308635925",
                "0.5436122766509995768408377841283393835155",
                "0.5449921840699692619932592416440207968547",
                "0.5464005408270558317439536315953135016209",
                "0.5478385903445910183457780573414555871338",
                "0.5493076606049854989160203492258960208020",
                "0.5508091720447924950215464080679165600313",
                "0.5523446463949324935672054963486642479243",
                "0.5539157166067590971484433480604147463733",
                "0.5555241380283387048212451678962920086947",
                "0.5571718010251314751714687714262387937145",
                "0.5588607452754256401608284928174975800785",
                "0.5605931760149556422474057633041881433362",
                "0.5623714825591308925936894581055088841724",
                "0.5641982594978008390857446831323539413641",
                "0.5660763310398391912942729405746742554034",
                "0.5680087790874332324877616220650648748804",
                "0.5699989757485930550883511213009544918824",
                "0.5720506211587244743301960571270416724230",
                "0.5741677876884130865734174591573922397488",
                "0.5763549718787245814486168161398572652218",
                "0.5786171557862634014982591923926368454441",
                "0.5809598798640149985777342823440732488202",
                "0.5833893300869161495159224856950125597657",
                "0.5859124428042580367185837260766278580557",
                "0.5885370318372869211118056914688050914134",
                "0.5912719437449829868518428194614052871849",
                "0.5941272491082119835384650877045228641010",
                "0.5971144803618001933981066906974956301260",
                "0.6002469304829573538071516164570587486577",
                "0.6035400322582424047523778178403677697086",
                "0.6070118457416954825268464421452381349664",
                "0.6106836932366748439731958786026342988851",
                "0.6145809989108115017135441070047621758552",
                "0.6187344177548641489234606740616594935556",
                "0.6231813825888098726421879325491088899564",
                "0.6279682700411048206224125055837271088383",
                "0.6331535090574421674926271295013071506659",
                "0.6388121719425019550429119336069765334802",
                "0.6450429875939473236710012129407293362150",
                "0.6519794948342567275201967556585576150059",
                "0.6598086690442678633976478218073688023956",
                "0.6688039804299403910322640438164449655846",
                "0.6793888186611709386906191566132769436323",
                "0.6922714910842477126179186721920055236695",
                "0.7087779218945786321211627030743217005419",
                "0.7318804155416557734266990178614049562201",
                "0.7710481350290348289760521087062483185031"
            };

            const double n = -8;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNm16Test() {
            ddouble[] expecteds = {
                "0.3542265752067889697702668268736907654293",
                "0.3545405983452070630660382822951281883013",
                "0.3548568323988125633553853079321740517539",
                "0.3551753106306654611267172207674450100869",
                "0.3554960670801823513483377601521525121810",
                "0.3558191365877848806576244888586372620933",
                "0.3561445548205406762695383753053179292737",
                "0.3564723582988452888080923835291701053444",
                "0.3568025844241964797063993395999673207214",
                "0.3571352715081151685228205504195860554735",
                "0.3574704588022705405632503419532344526708",
                "0.3578081865298702158572080966357582021168",
                "0.3581484959183800133888501209615035290344",
                "0.3584914292336417275441186748968198132209",
                "0.3588370298154614865800218322913744918449",
                "0.3591853421147457068480519125448324188726",
                "0.3595364117322664146936483762990150412527",
                "0.3598902854591428056616227115695284472823",
                "0.3602470113191313753949968801731988649420",
                "0.3606066386128228184584219546383511773192",
                "0.3609692179638501830423786133729923242364",
                "0.3613348013672195269457628070114012434869",
                "0.3617034422398815825802409125231216959082",
                "0.3620751954736707488794769289792498954990",
                "0.3624501174907461329096018374590476529606",
                "0.3628282663016784151672225879010677673595",
                "0.3632097015663360665285305195726336852986",
                "0.3635944846577349636370655431301689407066",
                "0.3639826787290268014021682187898146538149",
                "0.3643743487838139612716881735620628390777",
                "0.3647695617499917446814877478537282035718",
                "0.3651683865573332136592466258944807389268",
                "0.3655708942190473954681866681981610146348",
                "0.3659771579175584164041383955282711161612",
                "0.3663872530947713541005364603101878751149",
                "0.3668012575471103737249491197144109898207",
                "0.3672192515256361916744125331698299636865",
                "0.3676413178415732575887847632991186951580",
                "0.3680675419776024468686876220397043267087",
                "0.3684980122053027172004646918878170365154",
                "0.3689328197091553328312536602791767080912",
                "0.3693720587175571545694683431188841297223",
                "0.3698158266413254161765295152038629544997",
                "0.3702642242202156766047447708018701131739",
                "0.3707173556780176075453481872895491032381",
                "0.3711753288868403445086461041136045930794",
                "0.3716382555412507427419476473262715097244",
                "0.3721062513429845367955495484113476863514",
                "0.3725794361970126665181271828594067054642",
                "0.3730579344198135352488784436681054939785",
                "0.3735418749607774208829727823446150530670",
                "0.3740313916377524719679497836630630101029",
                "0.3745266233878335985931257381054338816548",
                "0.3750277145345971412666110770076414703825",
                "0.3755348150730966377960737453166148039377",
                "0.3760480809740596344046027902305262345968",
                "0.3765676745088638113599517227635581686075",
                "0.3770937645970244341541682204013337210186",
                "0.3776265271780962608314401129687848307028",
                "0.3781661456100837781418820326865433939020",
                "0.3787128110966665742769208595476161043524",
                "0.3792667231457847344052633178983819958284",
                "0.3798280900623957600943408142443421947070",
                "0.3803971294785135748121039177075702617302",
                "0.3809740689239761997006901461043671775548",
                "0.3815591464417668907178524619400741281698",
                "0.3821526112521399780799848642554061661191",
                "0.3827547244702843826512496074072172448878",
                "0.3833657598828030037610245643135419807150",
                "0.3839860047889044567981512522975613989416",
                "0.3846157609129061986114768256994019193147",
                "0.3852553453954480719715219872038563468616",
                "0.3859050918717282090409625350917361618973",
                "0.3865653516461173240088668093077092705911",
                "0.3872364949737043080094072356652714676856",
                "0.3879189124607013583813788229265331950017",
                "0.3886130165972211479705943848405993683399",
                "0.3893192434377682026983165255855680368265",
                "0.3900380544469053433327152337780575428720",
                "0.3907699385300161971044076787086160057152",
                "0.3915154142719496271618903097782840238564",
                "0.3922750324096779838656856817382917608122",
                "0.3930493785690213030169172091349491966154",
                "0.3938390763000973117156533003404067811126",
                "0.3946447904515911364923365957823835485248",
                "0.3954672309303695836271565558945027150937",
                "0.3963071569006035175714046122169159729773",
                "0.3971653814856696533524427568708101634963",
                "0.3980427770470059309880775660130147379204",
                "0.3989402811272008964759613881262167395288",
                "0.3998589031604214582230472084699479958930",
                "0.4007997320724762961288237168568051580418",
                "0.4017639449162035978418420024315845178791",
                "0.4027528167165246519219673481123416548364",
                "0.4037677317347899407303255875229953089795",
                "0.4048101964057414031317396965574558510931",
                "0.4058818542548503098793628735228311314932",
                "0.4069845031720297231233541714046555467042",
                "0.4081201155038331329241255261540242582064",
                "0.4092908615356846552480979300884779733770",
                "0.4104991370758000335398829027811157886897",
                "0.4117475960332856301864411731467689698273",
                "0.4130391891182642859931068951102394998640",
                "0.4143772101010110022358111765828723717951",
                "0.4157653514770792555618789758836778020214",
                "0.4172077719348819699027446593653257122505",
                "0.4187091787669518886827344961344373247640",
                "0.4202749293878987401932667042550678728281",
                "0.4219111575425661682604285984097352815613",
                "0.4236249317911750911896962596576775691421",
                "0.4254244567280522669859618692534941080165",
                "0.4273193315729648293826662244217834324986",
                "0.4293208869859941945970382551385692394797",
                "0.4314426303785956501380136714427118970961",
                "0.4337008446212792085113113518040517307787",
                "0.4361154083614884626541260897253483182115",
                "0.4387109444361190735263640266458923491067",
                "0.4415184678411846928620674127368619246033",
                "0.4445778194028066896469266837200943513342",
                "0.4479413830330300434124801870458620092113",
                "0.4516799967467888860720217171915305933230",
                "0.4558928233024906628095343015701186790801",
                "0.4607248665793401762284536394916731973392",
                "0.4664005743574717014168908602266501961169",
                "0.4732953534235920596121060773239388864953",
                "0.4821117968935886669491754498757764257117",
                "0.4944245469887573911787111012159280014050",
                "0.5152489276895301866838960698192101526192"
            };

            const double n = -16;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPikp0p50Test() {
            ddouble[] expecteds = {
                "0.4058818542548503098793628735228311314932",
                "0.4066687095640588297182390431892578074014",
                "0.4074600529689684693240346941368419784841",
                "0.4082559269336364341040520885228171447060",
                "0.4090563744841747785372096083242180054068",
                "0.4098614392183242299020506719665154077020",
                "0.4106711653152276920908898996048140523276",
                "0.4114855975454083630542020647058129403608",
                "0.4123047812809575404478133585619570009737",
                "0.4131287625059373356663077813145731954278",
                "0.4139575878270036668062467852649473163863",
                "0.4147913044842550563859936525642050318719",
                "0.4156299603623129200358541459882390589126",
                "0.4164736040016391980509668616642116169936",
                "0.4173222846100973528656611408350325727442",
                "0.4181760520747629323656387921778654989266",
                "0.4190349569739900817155124483701042630995",
                "0.4198990505897405752649049902578689579773",
                "0.4207683849201821353366092459774118530832",
                "0.4216430126925630065349428812665400911514",
                "0.4225229873763699628911566509928131436753",
                "0.4234083631967771409458015679267447199964",
                "0.4242991951483933150265428957925955577078",
                "0.4251955390093154617967199240509478650196",
                "0.4260974513554966999197012431724802969330",
                "0.4270049895754369377140655042702356848915",
                "0.4279182118852048172853061165977855238068",
                "0.4288371773437998081453629490168628664086",
                "0.4297619458688635771205142424090638496020",
                "0.4306925782527500447648343059217465657205",
                "0.4316291361789638319202025717494088988781",
                "0.4325716822389771038910102827747766979400",
                "0.4335202799494351343459317863331110816380",
                "0.4344749937697612369523341327291800708557",
                "0.4354358891201720503421489482833043038764",
                "0.4364030324001145117724449577582993866400",
                "0.4373764910071362172716827984974464286633",
                "0.4383563333562012416679481849613752642540",
                "0.4393426288994638812157536841471144848767",
                "0.4403354481465131851349957199074872265781",
                "0.4413348626851015608365974354959187129083",
                "0.4423409452023711715483033726746794858085",
                "0.4433537695065922951132049481416751989470",
                "0.4443734105494282795846136735977120038228",
                "0.4453999444487422155866662476517925232355",
                "0.4464334485119609479859821294824075494598",
                "0.4474740012600125709955422538157000892213",
                "0.4485216824518540922135208476730034127321",
                "0.4495765731096065131308036585526789666072",
                "0.4506387555443151572049693553225303679339",
                "0.4517083133823536826211546845007203125071",
                "0.4527853315924908463111711929529406517007",
                "0.4538698965136397396976551623382512738481",
                "0.4549620958833098960349841451305173291157",
                "0.4560620188667833752497512809328910689380",
                "0.4571697560870366660115556566554070050176",
                "0.4582853996554310076176789460373331513876",
                "0.4594090432031945274410095162201468177318",
                "0.4605407819137204145209235052976040042129",
                "0.4616807125557062077901975572799641160181",
                "0.4628289335171601699163906354405478225313",
                "0.4639855448403016463568508290245716110982",
                "0.4651506482573832756243996017681228698839",
                "0.4663243472274639226604385276500466664416",
                "0.4675067469741622544257187301489442024221",
                "0.4686979545244219672505768652935350733963",
                "0.4698980787483208111377661110535401924921",
                "0.4711072303999567391866987374061497262574",
                "0.4723255221594457428213010975829089581370",
                "0.4735530686760672178830047783265786719649",
                "0.4747899866125940453453745936549017674780",
                "0.4760363946908459659956659039630858053364",
                "0.4772924137385062836252260259263727005404",
                "0.4785581667372434489328539188787283275274",
                "0.4798337788721806594828613655786921364125",
                "0.4811193775827582628435035047499627111093",
                "0.4824150926150354738030237069037337721301",
                "0.4837210560754797158417217788324661327044",
                "0.4850374024862937755424554739947609340782",
                "0.4863642688423329202648248883850497601995",
                "0.4877017946696661783209028832731151324620",
                "0.4890501220858381214316129989255024053596",
                "0.4904093958618897260133237712155195149590",
                "0.4917797634861992277010386827485413948833",
                "0.4931613752302063275870768871762373495975",
                "0.4945543842160856643607675633073069098973",
                "0.4959589464864381396007962586785379170360",
                "0.4973752210760714799489313176283187266517",
                "0.4988033700859443461799638921591987222586",
                "0.5002435587593513620442572417178279691706",
                "0.5016959555604296423545098890836190838867",
                "0.5031607322550707576920970395563798424038",
                "0.5046380639943255903389883457342496816238",
                "0.5061281294003932210890627365889902634892",
                "0.5076311106552888484505455722820034569388",
                "0.5091471935922897899475017454703736715634",
                "0.5106765677902628598614646286588675958472",
                "0.5122194266709808695310068738085381911816",
                "0.5137759675995406666023180752681817913504",
                "0.5153463919880000304441333067945588599245",
                "0.5169309054023558850900486828211218846385",
                "0.5185297176729916921224349057612803951311",
                "0.5201430430087275582780022739295364413766",
                "0.5217711001146125515472829412473118392783",
                "0.5234141123136049814307806577012334020006",
                "0.5250723076722929811017088678993502115411",
                "0.5267459191308146499053379431401013416489",
                "0.5284351846371442934688066707135835868643",
                "0.5301403472859189565307852951538626771465",
                "0.5318616554619875026016743324028202971252",
                "0.5335993629888729783480805257548343592732",
                "0.5353537292823479343213352853496744569730",
                "0.5371250195093317841366002436606610631498",
                "0.5389135047523292000511565725091092966690",
                "0.5407194621796389945887204302917563516437",
                "0.5425431752215739579584141243780859440922",
                "0.5443849337529437442673949370366612869570",
                "0.5462450342820651630313369435566434105743",
                "0.5481237801465771758912012125126501268080",
                "0.5500214817163515641215067042321348375539",
                "0.5519384566038046657744228227483403912371",
                "0.5538750298819308306157621859092213750088",
                "0.5558315343103943582471426777104438321510",
                "0.5578083105700337255138324646865793379168",
                "0.5598057075061499329632126547026148989700",
                "0.5618240823809698705000208467619021291737",
                "0.5638638011356957878363222960482934880750",
                "0.5659252386625733291760447441426252502711",
                "0.5680087790874332324877616220650648748804",
                "0.5701148160631857861816912354080653020566",
                "0.5722437530747725707591480731026090393809",
                "0.5743960037561069875638133076442068836039",
                "0.5765719922195636959884668572911564890603",
                "0.5787721533986074571762998614632117797881",
                "0.5809969334041841378080230313632537833171",
                "0.5832467898955308927217395131292798425334",
                "0.5855221924660989607315700492164122932521",
                "0.5878236230453212259398223113774081371308",
                "0.5901515763169978808546363339156547892633",
                "0.5925065601551173544752186970536589153446",
                "0.5948890960779763290330951289969947355806",
                "0.5972997197215123694622309173390638801336",
                "0.5997389813328156527942084204483078079582",
                "0.6022074462848427516085851973138813500536",
                "0.6047056956134156573135919825773154810595",
                "0.6072343265776535079172936249692070042132",
                "0.6097939532450531172097010720296337020074",
                "0.6123852071025077198307167703784073076494",
                "0.6150087376946317096453015880454311880639",
                "0.6176652132908429481036492148537969790014",
                "0.6203553215827438794791449192612690889985",
                "0.6230797704134386726425633541207911334961",
                "0.6258392885405264164304703839662489690330",
                "0.6286346264346205741942539726634888396373",
                "0.6314665571153630480176472452622941496940",
                "0.6343358770270279631589826590100896671007",
                "0.6372434069559463661727988544320094755243",
                "0.6401899929921292083242249004532181560551",
                "0.6431765075376231030724946752780039274133",
                "0.6462038503643023248951193825725093097391",
                "0.6492729497239823655480260842555684646102",
                "0.6523847635139361876694031881908953663016",
                "0.6555402805011053247789177721803968830750",
                "0.6587405216085254983946649423939343349518",
                "0.6619865412677319136995742381941565203698",
                "0.6652794288411744546877330960385167136607",
                "0.6686203101189593865647589296532475145893",
                "0.6720103488945438221468851089799785625765",
                "0.6754507486243442506270970658445523307937",
                "0.6789427541765832095135965976849245570442",
                "0.6824876536750912941652468124164414616081",
                "0.6860867804442080043487404402896185801784",
                "0.6897415150613875847268476840459600451415",
                "0.6934532875246185231699432074327212674886",
                "0.6972235795423115996615238700859843994570",
                "0.7010539269539056216895273720346602769260",
                "0.7049459222900870020495182554214498356665",
                "0.7089012174822244219359559025195837263809",
                "0.7129215267313888579948910792660842744686",
                "0.7170086295481687838009108122144527502715",
                "0.7211643739754076796139686924816777351803",
                "0.7253906800069942380404740376289752184612",
                "0.7296895432169339271596996612159737188512",
                "0.7340630386141340306097753576092447018638",
                "0.7385133247396543044250182648237854307809",
                "0.7430426480246247266873577748158964312830",
                "0.7476533474286247812235523867507075840337",
                "0.7523478593800713940441283925721111425616",
                "0.7571287230420931274452684323892548057988",
                "0.7619985859294969203626083632168812931613",
                "0.7669602099047835472901063566841956638890",
                "0.7720164775837650397868090473873949274812",
                "0.7771703991842109769617646945056137173676",
                "0.7824251198541341191614212752078123955265",
                "0.7877839275198571364501567985265189892188",
                "0.7932502612979241345181509680628514256942",
                "0.7988277205192822107628369057502729855376",
                "0.8045200744190151404754678623254785933001",
                "0.8103312725503271732547989820803078435470",
                "0.8162654559875226545432174748507230569809",
                "0.8223269693894902480707211632521803493812",
                "0.8285203740027747455541390593647319611103",
                "0.8348504616918150153123829759513665363148",
                "0.8413222700934705451825283592958663243869",
                "0.8479410990036978770246232070042964684225",
                "0.8547125281163415927543279239294386069047",
                "0.8616424362476689646161243281361111859783",
                "0.8687370221957312550550288704796015690115",
                "0.8760028274011437394987170225907397078042",
                "0.8834467605957509262665755003242802284527",
                "0.8910761246482457752895676665437490320340",
                "0.8988986458415669964025493596242638060722",
                "0.9069225058463061302248960816577734481581",
                "0.9151563766880043235137759295271005995223",
                "0.9236094590448022054142107123933821832707",
                "0.9322915242562476655382470245440927423035",
                "0.9412129604751424024025439871370204022143",
                "0.9503848234532819832361853085094628399257",
                "0.9598188925202049666041957634586285432775",
                "0.9695277323932784996480001206655673122135",
                "0.9795247615496105343991092818831192041570",
                "0.9898243279978035356900791357709262981004",
                "1.000441793413368152941756527033506744149",
                "1.011393626749238928468684993789606028385",
                "1.022697508606592391221063288120449366337",
                "1.034372447856337969887704858499332640129",
                "1.046438912244713768320209374673436550873",
                "1.058918975005361337965951165833496893636",
                "1.071836479844967911002454323917700914734",
                "1.085217227082353316727564371826152303444",
                "1.099089184217112910592072587687824833450",
                "1.113482724802905315629874905404769389758",
                "1.128430900226545474095768290156159386997",
                "1.143969749878118494957106781565959834073",
                "1.160138656278767535467893437701610528224",
                "1.176980753062175375169215266321949101649",
                "1.194543395348294463375433483739580451119",
                "1.212878704088327727420994333768208611382",
                "1.232044198509139693960347705033204123751",
                "1.252103533989122927708637371858315293903",
                "1.273127366749682458457242076742137073923",
                "1.295194371905845737977491679541386245137",
                "1.318392448035165743335469926777351472368",
                "1.342820149970936946892889132297376058227",
                "1.368588402655798261557765235426432137764",
                "1.395822563509194836214967562275190260786",
                "1.424664920134002376744608274248921002541",
                "1.455277736109770624940153404969791583960",
                "1.487846992668798385273647399274200838436",
                "1.522587021970573511530486711405225924954",
                "1.559746293997188377767884976746364571245",
                "1.599614712040483317589343581441262757638",
                "1.642532903889501906603379213134398489871",
                "1.688904186573328262746388750580468825330",
                "1.739210162503567690434322364044336403835",
                "1.794031323445906952213675586602684741410",
                "1.854074677301371918433850347195260046218",
                "1.920211408820190510760734917078775722850",
                "1.993529178569172786463995681929176692142",
                "2.075406284800636499869837852859249294836",
                "2.167619360766555959906157571538397474939",
                "2.272504106750153651892019032827114255050",
                "2.393202910648986418866807734689289821143",
                "2.534060838288938875273316576944921354912",
                "2.701287762095351005040349470677451682699",
                "2.904127190453591811829134902120060406245",
                "3.157063680838831730355125798734162388831",
                "3.484369010741340448548683595079273163403",
                "3.930614845895350913875751766062302351104",
                "4.589324472266679104452228820118524097738",
                "5.703926819342179010742891747919890544549",
                "8.247440865028414790022890733102253908200",
                ddouble.PositiveInfinity
            };

            const double m = 0.5;

            for ((int i, double n) = (0, -16); i < expecteds.Length; i++, n += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(n);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPikm0p50Test() {
            ddouble[] expecteds = {
                "0.3655708942190473954681866681981610146348",
                "0.3662225986904733923237483378090249156531",
                "0.3668778563626574863010558433949986980621",
                "0.3675366998296205270693437836983731784731",
                "0.3681991621068067597929965879126950425252",
                "0.3688652766381288994844649424291503495058",
                "0.3695350773031578791246043955115343169538",
                "0.3702085984244607991872382621324264110662",
                "0.3708858747750907058995467885436408535552",
                "0.3715669415862319284717261384630479097003",
                "0.3722518345550048117540380725636261196087",
                "0.3729405898524337904473184786756848083644",
                "0.3736332441315828642295092764255324504940",
                "0.3743298345358626500961619554739591362702",
                "0.3750303987075133089827542815674253082585",
                "0.3757349747962677684822061621959599508097",
                "0.3764436014681997923390844746692958956322",
                "0.3771563179147615805455836484237746809156",
                "0.3778731638620157214426902738376570510008",
                "0.3785941795800664594088000051571906857182",
                "0.3793194058926953886701495901455795742577",
                "0.3800488841872068356726482580835604395485",
                "0.3807826564244883495004592389459770542279",
                "0.3815207651492918822082845587894636240969",
                "0.3822632535007414088552712638804718547475",
                "0.3830101652230729107009298692077594878721",
                "0.3837615446766128246686007322885104245345",
                "0.3845174368490012480304273157641858480171",
                "0.3852778873666663795599878665963023121576",
                "0.3860429425065568773855408108773766667384",
                "0.3868126492081390197199371137982715595589",
                "0.3875870550856657678156844652227126533129",
                "0.3883662084407250511803516091187721744075",
                "0.3891501582750748235858837905053246308617",
                "0.3899389543037726750259389802776279594622",
                "0.3907326469686080298422274471813388587663",
                "0.3915312874518452150925891545181423230444",
                "0.3923349276902859462237862244145213771216",
                "0.3931436203896600496101380594908961539585",
                "0.3939574190393535239111834665010312631839",
                "0.3947763779274833348909171849159669742015",
                "0.3956005521563286417494816865356139914278",
                "0.3964299976581284675863371716673229522375",
                "0.3972647712112561528028550086541149170531",
                "0.3981049304567812685440993881033151770533",
                "0.3989505339154300181786082376066823283745",
                "0.3998016410049555188489257804123185688508",
                "0.4006583120579297328466711159606131378633",
                "0.4015206083399692105520273359507030078631",
                "0.4023885920684072135337880389091720033644",
                "0.4032623264314252087660923601729669855833",
                "0.4041418756076571634452889943837065097998",
                "0.4050273047862805252801124420921866687767",
                "0.4059186801876082461088446376721105916915",
                "0.4068160690841966980316261895465647723519",
                "0.4077195398224848417346127324634628714692",
                "0.4086291618449805371640187382575610916767",
                "0.4095450057130104380618295989271724566325",
                "0.4104671431300504850236540754631092097717",
                "0.4113956469656546076506918845102789980907",
                "0.4123305912799998660577093677736676765925",
                "0.4132720513490669065331921040339648254474",
                "0.4142201036904752766455038185089144584783",
                "0.4151748260899938427249475782916704382172",
                "0.4161362976287472786601987323391393224364",
                "0.4171045987111403506251092239869057683556",
                "0.4180798110935225090606365731391586012351",
                "0.4190620179136161184083902164384970168931",
                "0.4200513037207325082321737553595384150624",
                "0.4210477545068009180546358789743267897288",
                "0.4220514577382363341423663916606019455306",
                "0.4230625023886731813457378179105717660333",
                "0.4240809789725928387823197820407224586669",
                "0.4251069795798739965844485531978826662456",
                "0.4261405979112959641546308470329733018530",
                "0.4271819293150261805374175959011159955542",
                "0.4282310708241243668884604882179226075011",
                "0.4292881211950970019874058741413516862795",
                "0.4303531809475370968164894829388565953854",
                "0.4314263524048855960628691980563486273425",
                "0.4325077397363521457959982883812648351852",
                "0.4335974490000344404709162330834639128088",
                "0.4346955881872769019257599659781085897952",
                "0.4358022672683110514607791799154072446816",
                "0.4369175982392216168730338802491312293805",
                "0.4380416951702841731359641602487830894005",
                "0.4391746742557219521221394439820709326186",
                "0.4403166538649313774552339701965972116621",
                "0.4414677545952278895602888015556030782153",
                "0.4426280993261657278229273903731407749330",
                "0.4437978132754875362939056413799594882496",
                "0.4449770240567619616895027493001886154912",
                "0.4461658617387698229416345116118991076994",
                "0.4473644589067019559605481371314469737687",
                "0.4485729507252344816397085579297095308287",
                "0.4497914750035500158667384234000122703220",
                "0.4510201722623762441965846027081871765175",
                "0.4522591858031163280897707329723693215309",
                "0.4535086617791488018484511168807840522067",
                "0.4547687492693779676859129743823687143285",
                "0.4560396003541193093229147683360767246052",
                "0.4573213701934081312233066449428708315049",
                "0.4586142171078235007284024115206522271615",
                "0.4599183026619236341893168123398548037051",
                "0.4612337917503931366325960128332604732372",
                "0.4625608526870069891133212201485990358015",
                "0.4638996572965208910276570038883387955126",
                "0.4652503810096025193702534410589556530589",
                "0.4666132029609234771627245381982381909837",
                "0.4679883060905371838730525853064544998723",
                "0.4693758772486737273745519485717043001545",
                "0.4707761073040887666642988827961612123138",
                "0.4721891912561099650804034923697410371665",
                "0.4736153283505311642083810147305245088137",
                "0.4750547221995115993952656743799270741604",
                "0.4765075809056449304971163907462409655790",
                "0.4779741171903707393268250188294488834211",
                "0.4794545485269094529623041435203226913576",
                "0.4809490972779104160160532752496318043631",
                "0.4824579908380120833554752729774419009316",
                "0.4839814617815230677386183686279298419230",
                "0.4855197480154430866186666731365065582556",
                "0.4870730929380537434452081918549030073826",
                "0.4886417456033205880427776130227532043462",
                "0.4902259608913600675753120209458499554839",
                "0.4918259996852378465161679141416634392115",
                "0.4934421290543785862741113476826682514187",
                "0.4950746224448816812821108619841535157997",
                "0.4967237598770527005727811696648448402559",
                "0.4983898281504764380886072376433754124165",
                "0.5000731210569745912724646676219780752354",
                "0.5017739396018092303740788444275578898051",
                "0.5034925922335124597287421380160332687286",
                "0.5052293950827430815688435630532942318939",
                "0.5069846722105927329176147607757553448804",
                "0.5087587558667869631092575239869900992177",
                "0.5105519867582511464372589100895620661111",
                "0.5123647143285370815088292343371492977555",
                "0.5141972970486337240475528711079222658353",
                "0.5160501027197148495948795875003697473370",
                "0.5179235087884076724935527259000069781010",
                "0.5198179026751996934015703157856146508112",
                "0.5217336821166364560060579334356724757348",
                "0.5236712555220006230867887275165245954649",
                "0.5256310423452030040684853044112785321391",
                "0.5276134734726590662614987711302682181148",
                "0.5296189916279702410792821358639581325850",
                "0.5316480517942782124013434339154273425954",
                "0.5337011216552125830430831556315971301941",
                "0.5357786820554081131872682220748687882667",
                "0.5378812274816273897649127674030100816597",
                "0.5400092665655886203134506716336179135094",
                "0.5421633226096665772761786473750550167136",
                "0.5443439341367079063823449188666746696316",
                "0.5465516554652804446599620481696227236427",
                "0.5487870573117602935343375153302061733595",
                "0.5510507274207506222889862627164055758710",
                "0.5533432712254230408323485598582102158938",
                "0.5556653125394764283470780949074022134092",
                "0.5580174942825199370072537488886306063409",
                "0.5604004792408071646289763636143330635344",
                "0.5628149508653779258412328988530544622936",
                "0.5652616141098034354106810527612215666231",
                "0.5677411963098809125007175105809071616416",
                "0.5702544481077855671604754259562762117521",
                "0.5728021444233626789205490234594618878845",
                "0.5753850854754311631290998958000326739440",
                "0.5780040978561738982844247535692882389352",
                "0.5806600356619105378820956724227120541627",
                "0.5833537816837870740699199230591290043940",
                "0.5860862486621747343907998516092984605601",
                "0.5888583806088507272794581028356246387990",
                "0.5916711542013369503023235296806910008558",
                "0.5945255802541022966395626174934494285658",
                "0.5974227052716921401630060996936009289527",
                "0.6003636130892377171647692681303436526148",
                "0.6033494266062215243013240569067550690660",
                "0.6063813096198359263875211267632183426814",
                "0.6094604687647747019802304289382811864892",
                "0.6125881555668454624738124053872219330191",
                "0.6157656686183894534486799716037946035079",
                "0.6189943558841494157384105090614156019725",
                "0.6222756171469417858037479271083838339085",
                "0.6256109066032730735373164869342043765759",
                "0.6290017356198990680442742828388423220457",
                "0.6324496756632677620729780926763828475076",
                "0.6359563614148217204070028512110199361791",
                "0.6395234940862733401610571454303300125849",
                "0.6431528449502186352291962059960915721971",
                "0.6468462591028348535138369991814830075230",
                "0.6506056594769290944452202205225472642325",
                "0.6544330511252857206744444895426947819058",
                "0.6583305257961185022572312076227644865503",
                "0.6623002668244903239776523976944977549767",
                "0.6663445543658429995235097575674374028762",
                "0.6704657710003096083356707152548851572205",
                "0.6746664077392928975615335415921562649925",
                "0.6789490704689210984194656328487311630432",
                "0.6833164868684774190637730260145786125798",
                "0.6877715138457877038610422962051229000259",
                "0.6923171455358952034817597790648306065610",
                "0.6969565219142127755080084744324641342556",
                "0.7016929380807908798790381889136640881629",
                "0.7065298542784547514915785379489219452597",
                "0.7114709067144387589037448068928027920301",
                "0.7165199192628872651045202666728918322730",
                "0.7216809161343233038627258511339492696556",
                "0.7269581356080530023946272582673220074051",
                "0.7323560449346423257412916651387576173333",
                "0.7378793565282685388684821572730866637803",
                "0.7435330455831397853008651666807212733148",
                "0.7493223692645593896940915420678878505225",
                "0.7552528876439003831700732914828497725207",
                "0.7613304865681192577003895188072929219784",
                "0.7675614026789114008809156715330929399387",
                "0.7739522508247090710973182010043930802288",
                "0.7805100541410571472770489755220178038632",
                "0.7872422771121991533189649265415546548108",
                "0.7941568619698336043066964454600336004519",
                "0.8012622688349966948710312272190521597353",
                "0.8085675200671381812469705487325273644759",
                "0.8160822493521843899314635484543452372502",
                "0.8238167561405402413836354864566524563836",
                "0.8317820661387719067543510193292719962126",
                "0.8399899986678123413358251682688170245483",
                "0.8484532418292170492531612865217688243869",
                "0.8571854365732827141337583875457245505393",
                "0.8662012709436729269158699486362381355022",
                "0.8755165859886912881260756635340195483646",
                "0.8851484950871040374071419927404806106093",
                "0.8951155187459299518522045597573184008295",
                "0.9054377373007842879671591986996544887822",
                "0.9161369644011859410006444048174976232846",
                "0.9272369447127202365553993149049613144442",
                "0.9387635799393125201516485188174252523966",
                "0.9507451880931470339101474890781705871340",
                "0.9632128019569778973801224582681438941011",
                "0.9762005139456468330192306456341944873472",
                "0.9897458761483681981640976619512694506023",
                "1.003890366309983159200366599033508186874",
                "1.018679933006156206673666921948332671513",
                "1.034165636442310997560557406703997171325",
                "1.050404405371665445969962294375484231518",
                "1.067459935872995747175247877857406645986",
                "1.085403764550017059523667424014996718234",
                "1.104316557660372407360532879884443725054",
                "1.124289669521413018252678053984863984915",
                "1.145427039359732012349036379261188289733",
                "1.167847517129878574684334559323008027609",
                "1.191687737986230995280175540942983481716",
                "1.217105705378768709093384540830677508148",
                "1.244285299130520995334386949303841940309",
                "1.273442004891368949163519445837629156313",
                "1.304830276716713842317472202537926299540",
                "1.338753113570048027480913380698348512742",
                "1.375574682864915459752475703197893747361",
                "1.415737208425956198892165965423613532473",
                "1.459783938678718417913112898465160565544",
                "1.508390966318892902982634129425416295098",
                "1.562412239322241076670658968084044747811",
                "1.622944760954741603710555258247964135990",
                "1.691425644502004606860765492404867798806",
                "1.769781233475969665870651165674537083809",
                "1.860664911836072739043218447248966496025",
                "1.967853602214696611449820735115032303059",
                "2.096945603784697201241948157208851752056",
                "2.256674414710741256710499684941067386284",
                "2.461605753491579880711829077171714192593",
                "2.738352819152779967041632991033763661627",
                "3.142453622443274381631419018198184552488",
                "3.817599906505218640221138189610972753222",
                "5.334144700788700541592419802683252100729",
                ddouble.PositiveInfinity
            };

            const double m = -0.5;

            for ((int i, double n) = (0, -16); i < expecteds.Length; i++, n += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(n);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void IncompEllipticFTest() {
            HPAssert.AreEqual("0.2506474362662866035530540133777640230902", ddouble.EllipticF(0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2513040086544925794134591303987751449373", ddouble.EllipticF(0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5050887275786480788831082896236055222278", ddouble.EllipticF(0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.5104671356280047563361040911115799362540", ddouble.EllipticF(0.5, 0.5), 1e-30);
        }

        [TestMethod]
        public void IncompEllipticETest() {
            HPAssert.AreEqual("0.2493555587876163503851462800891098248369", ddouble.EllipticE(0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2487081058046058223763081867139695534492", ddouble.EllipticE(0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.4950017030164151928870375499599796260010", ddouble.EllipticE(0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.4899109597925171552108607317418823427392", ddouble.EllipticE(0.5, 0.5), 1e-30);
        }

        [TestMethod]
        public void IncompEllipticPiTest() {
            HPAssert.AreEqual("0.2512963700347440990856202815164922658139", ddouble.EllipticPi(0.125, 0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2519559961634921785098113692037503925298", ddouble.EllipticPi(0.125, 0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5102226593583425038841480467872258270987", ddouble.EllipticPi(0.125, 0.5,  0.25), 1e-30);
            HPAssert.AreEqual("0.5156986389890165328218962101195858179987", ddouble.EllipticPi(0.125, 0.5,  0.5), 1e-30);
            HPAssert.AreEqual("0.2519513603223101654980384692723856596327", ddouble.EllipticPi(0.25,  0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2526140741318178608951800063127917558966", ddouble.EllipticPi(0.25,  0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5155452979192924731104300897370205260060", ddouble.EllipticPi(0.25,  0.5,  0.25), 1e-30);
            HPAssert.AreEqual("0.5211231226642416591338219890234919559207", ddouble.EllipticPi(0.25,  0.5,  0.5), 1e-30);
            HPAssert.AreEqual("0.2532799189809456359052213341202224845743", ddouble.EllipticPi(0.5,   0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2539489124677518319918153736199858971238", ddouble.EllipticPi(0.5,   0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5268086118981364167278162005049954648917", ddouble.EllipticPi(0.5,   0.5,  0.25), 1e-30);
            HPAssert.AreEqual("0.5326042322277693780755771455389210311823", ddouble.EllipticPi(0.5,   0.5,  0.5), 1e-30);
        }
    }
}
