using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class EllipticFunctionTests {
        [TestMethod]
        public void EllipticKTest() {
            ddouble[] expecteds = {
                "1.311028777146059905232419794945559706841",
                "1.313822521602589932785737602386333742705",
                "1.316641860447711171700198953321625573022",
                "1.319487225274569533321064057717161032722",
                "1.322359058397556893387197019618083211351",
                "1.325257813206285230088993846901426835783",
                "1.328183954534201614989195685134639646133",
                "1.331137959042574144402942806333049787831",
                "1.334120315620621629167376588489276788078",
                "1.337131525802605468712331684470317129129",
                "1.340172104202750840587260500299613905516",
                "1.343242578968916377486557127051506571809",
                "1.346343492255987139270874119806492844022",
                "1.349475400720025198937944412070579649756",
                "1.352638876034275855061587700909744623005",
                "1.355834505428195692077008317847124135695",
                "1.359062892250741796861736238323674147272",
                "1.362324656559239800937708968100614812060",
                "1.365620435735232483833147210176808609048",
                "1.368950885128800915786323708787316455926",
                "1.372316678732947051725405953486726501109",
                "1.375718509889730876056996966488123243126",
                "1.379157092029967255017791487872130220672",
                "1.382633159448408254553030245390195654618",
                "1.386147468116466566020136774629062217040",
                "1.389700796534675660293833222990863326713",
                "1.393293946627233253284408670352225489335",
                "1.396927744681137590715846583551686794604",
                "1.400603042332602023180180836809718604614",
                "1.404320717603623528450070494886909611956",
                "1.408081675991786551937748300292462998034",
                "1.411886851616606217520138233461175561848",
                "1.415737208425956198892165965423613532473",
                "1.419633741466388092343295470085255181151",
                "1.423577478221432938048159068735476541996",
                "1.427569480022283749790175353618877138870",
                "1.431610843535592917031509532700845427527",
                "1.435702702333482784439893945251779468042",
                "1.439846228551264531798477104902532753660",
                "1.444042634638792940616600529524495454375",
                "1.448293175211856382304508764595670235339",
                "1.452599149010516453395878820515528113281",
                "1.456961900971874643489724084176756772154",
                "1.461382824425359310109072962305113826154",
                "1.465863363419300710944125088010808453797",
                "1.470405015188301247349238011584774886866",
                "1.475009332771719513778209490646364721366",
                "1.479677927794478211580972543838506598435",
                "1.484412473422386452907343887925897958167",
                "1.489214707505246565246816816636192644853",
                "1.494086435922205615692548833135316687572",
                "1.499029536145125389037968716045263797715",
                "1.504045961037196047202439394644583143152",
                "1.509137742905624677125251283581216633723",
                "1.514306997829009130628528630964508377000",
                "1.519555930281981259362721420858958347928",
                "1.524886838081896082232208976852428428240",
                "1.530302117684782222175295771115219779171",
                "1.535804269860485675170364492938434548120",
                "1.541395905779969742701215898255655563624",
                "1.547079753551120173209579004972943717930",
                "1.552858665243193773431993887183098410082",
                "1.558735624444295693735157847096045117534",
                "1.564713754401038368379572630580725617048",
                "1.570796326794896619231321691639751442099",
                "1.576986771215813142124403053228808080382",
                "1.583288685400424467834512481846404542297",
                "1.589705846309983478854188856183168840001",
                "1.596242222131783510148969071497949879506",
                "1.602901985297796194899595693857169929056",
                "1.609689526625502369048575814940384280546",
                "1.616609470698736063142211740574470552222",
                "1.623666692621027323464926297218007730743",
                "1.630866336290717176779250478449835999908",
                "1.638213834366378955857038295184925651749",
                "1.645714930113231773852407148469514701781",
                "1.653375701346771208939713955078915548290",
                "1.661202586719363028752815025000156828695",
                "1.669202414629759719643593847915060753000",
                "1.677382435075262495085563772069234376033",
                "1.685750354812596042871203657799076989501",
                "1.694314376247740184839825165621903568713",
                "1.703083240538492139398334147676236628499",
                "1.712066275468270414988459985659563777503",
                "1.721273448737889660359178078725676366211",
                "1.730715427426532021355366325537346985260",
                "1.740403644497371368395497664706511221821",
                "1.750350373371563761220239626820809198348",
                "1.760568811771954495787446718089955385429",
                "1.771073176251581444370173363882960896208",
                "1.781878809080336200262569749752396240989",
                "1.793002299476700193289563657076436273826",
                "1.804461621553968222373600625610670759688",
                "1.816276291819331182734396045846770312043",
                "1.828467549642229195725066223199414850585",
                "1.841058564824889077152012806705465059630",
                "1.854074677301371918433850347195260046218",
                "1.867543675112457692676500068417255056187",
                "1.881496118219621122748647418095262114722",
                "1.895965717522425286122280812067898297925",
                "1.910989780751829196553148218761342559253",
                "1.926609739893582920450191931223535890369",
                "1.942871778680434609327759540683773642856",
                "1.959827583798844600024972758211979273007",
                "1.977535250235611428253516532627795954406",
                "1.996060380284727858764126571705948161026",
                "2.015477428073705161311473896289558325034",
                "2.035871358413585753245350234081539258498",
                "2.057339712356378169733488050058303384784",
                "2.079995205129674679276612360896141580852",
                "2.103969029848747389220371705983744677231",
                "2.129415110036352177279981271719275922987",
                "2.156515647499643235438674998800322028864",
                "2.185488469278223686913080323730158689730",
                "2.216596921627807102342718723262938628408",
                "2.250163448669196475776138067004540472233",
                "2.286588633650667991686729186098045732541",
                "2.326378569035678846420299092711924217737",
                "2.370185344296105705673486664430425773553",
                "2.418868993809016045900274727784415867562",
                "2.473596173751343911975589752733039465815",
                "2.536005227467480679724400685529749852156",
                "2.608499627175084267858481569466979096393",
                "2.694811911971635312977987861752946067877",
                "2.801206084665204046360361673619437209228",
                "2.939446126743500419208180657425821245078",
                "3.135992158076202184437643690967039845094",
                "3.475447457496819511777186630121955422167"
            };

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticK(m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticETest() {
            ddouble[] expecteds = {
                "1.910098894513856008952381041085721645955",
                "1.905411215387931619682406730567280051397",
                "1.900708546529360647988455595862534435963",
                "1.895990732791744916122647243383500390971",
                "1.891257616240004171800827289006995366104",
                "1.886509036078205936830657745092336508654",
                "1.881744828574941557880851952861154896486",
                "1.876964826986144644613995757819138832971",
                "1.872168861475242807751118793763676557427",
                "1.867356759030528023588439554135467122415",
                "1.862528343379625030656241032447173953868",
                "1.857683434900930885555534148206510982617",
                "1.852821850531892143694417239933353356354",
                "1.847943403673979059886394596338448102206",
                "1.843047904094208694658692571350269767037",
                "1.838135157823060833430798275509206284502",
                "1.833204967048622143726142625544452760370",
                "1.828257130006784973793236436534659827415",
                "1.823291440867317594963180848136600327718",
                "1.818307689615612467016288742099841085646",
                "1.813305661929908214458092148401394300685",
                "1.808285139053769391695320480776531564993",
                "1.803245897663595732162445544407056209615",
                "1.798187709730919361304683605593978678287",
                "1.793110342379234341667903876174744136954",
                "1.788013557735087840243820347639470904959",
                "1.782897112773146087552428743157691963357",
                "1.777760759154931051801409722287462656738",
                "1.772604243060905289459741494512323896454",
                "1.767427305015562657108227636935252395034",
                "1.762229679705161370804817528401959611863",
                "1.757011095787713160748895740296879786369",
                "1.751771275694817862026501838984512041414",
                "1.746509935424906565746094720108516012744",
                "1.741226784327428274511982987024013761010",
                "1.735921524877484692562165234621892957972",
                "1.730593852440385148081478928956394016292",
                "1.725243455025558488864628818416027788924",
                "1.719870013029220887895391694788658297840",
                "1.714473198965157595059995877409890955527",
                "1.709052677182932502364253674201120496417",
                "1.703608103572791651723565528804460469968",
                "1.698139125256475174229439333740570793389",
                "1.692645380263096240201078105597438188413",
                "1.687126497189185013417898968827541738792",
                "1.681582094841929889765035087313962879869",
                "1.676011781864576959777254359220197612637",
                "1.670415156342871110431490288264826577286",
                "1.664791805391337855827232677690668000837",
                "1.659141304718113170675208093639100631092",
                "1.653463218166928527144181111344174975895",
                "1.647757097234749147497366527698174171797",
                "1.642022480563444223822209319197881495368",
                "1.636258893403737449171767475943257437587",
                "1.630465847049543448754147551057458440173",
                "1.624642838240639244890810654515476936991",
                "1.618789348531448216682358353347551753736",
                "1.612904843623525414410165919527655914578",
                "1.606988772659125630569180002795579540704",
                "1.601040567473007134634595338912734769051",
                "1.595059641799371980868588815588244729380",
                "1.589045390430565501900464522403149250391",
                "1.582997188323849830716400330773053213831",
                "1.576914389652225438489527846127335433735",
                "1.570796326794896619231321691639751442099",
                "1.564642309262556894432573809162726348812",
                "1.558451622552203074196241225507151658254",
                "1.552223526925666030918786333873743344283",
                "1.545957256105465034950412439920610612017",
                "1.539652015880942614952994349377704121844",
                "1.533306982616908930541600250946435198301",
                "1.526921301656207700637980170791955730154",
                "1.520494085606697204776575183367852127363",
                "1.514024412502105109430704365649183056112",
                "1.507511323825047792128701171147486880523",
                "1.500953822379183498450923308152845466788",
                "1.494350869995970712483570005666964564066",
                "1.487701385059801116221901493214322862662",
                "1.481004239833338144245486253424661157028",
                "1.474258257562679230883104710173186919456",
                "1.467462209339427155459795266990916136025",
                "1.460614810693849625728995877851527717163",
                "1.453714717889962229250741269948828132958",
                "1.446760523889511305428185712162640276480",
                "1.439750753947367844854309876665730819549",
                "1.432683860795659883788094479571374322165",
                "1.425558219367934232788193723237029812651",
                "1.418372121007584864635847035771534998823",
                "1.411123767096514752546251031667024451041",
                "1.403811262030264903115686232825870910848",
                "1.396432605454346217356590247247887913419",
                "1.388985683662871916053531826740146996508",
                "1.381468260044344065330349153992028798642",
                "1.373877964440013265237412598744235715176",
                "1.366212281256870631643524897703955809219",
                "1.358468536149114656320927388032779490797",
                "1.350643881047675502520174735338725841350",
                "1.342735277275552795496778300996727275956",
                "1.334739476435361799343854437390976563942",
                "1.326652998692024300566133381256361066466",
                "1.318472107994620997371842794497930930603",
                "1.310192783682589568876562034128701823610",
                "1.301810687796760389663726021044820319647",
                "1.293321127257150860432173162453826895891",
                "1.284719009866063196619995708659895713811",
                "1.275998792831796528565272550687606072574",
                "1.267154422164207183376791836112837595468",
                "1.258179260838798560780214178796743285989",
                "1.249066003018567637514700647249200107915",
                "1.239806570800815200800950762984528750725",
                "1.230391988828439807058927441530411703448",
                "1.220812230534859095994658627212167640451",
                "1.211056027568459524803562899548978676494",
                "1.201110630736914697794518710797492052304",
                "1.190961506094848633304973210479384947333",
                "1.180591942697681287846662735354380583095",
                "1.169982537577002396340474563375145196732",
                "1.159110506049795300438964492342998827029",
                "1.147948736783822538094599525589385922037",
                "1.136464461974017156198235279940278114495",
                "1.124617325119752213158613719354261980648",
                "1.112356462659774003758220423882152916982",
                "1.099615879389268469753904131999471451112",
                "1.086306657414100891123787901941189062217",
                "1.072302721894604277869651076107464594147",
                "1.057411715024108431749476615851308004636",
                "1.041304202018977361305105434385948585556",
                "1.023279893756109396403927911329924147047",
                "1.000000000000000000000000000000000000000"
            };

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticE(m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNp0p75Test() {
            ddouble[] expecteds = {
                "2.477710158375750016700255445589138128515",
                "2.484542040045383273737267327344449272219",
                "2.491443313913927138869434692904220317022",
                "2.498415224196370770293883547296380915289",
                "2.505459047349383686797028608639823751624",
                "2.512576093169835300361884184104195738039",
                "2.519767705939882878635874247966667349400",
                "2.527035265620996875256728822368846614774",
                "2.534380189099433527474411760736196897691",
                "2.541803931485815208827350051681465165572",
                "2.549307987471639983436778201124110993679",
                "2.556893892745713945589967211443047274835",
                "2.564563225473684121858587629497970915351",
                "2.572317607844046918345523621180368050111",
                "2.580158707684218352715186692252008088023",
                "2.588088240150478752328121742256463354991",
                "2.596107969495847461108143435851480463071",
                "2.604219710920203726108767390122026197940",
                "2.612425332507249801179963133147749823163",
                "2.620726757253213016984293442133247745252",
                "2.629125965192506881429149960936241103992",
                "2.637624995625919115725091420340799298833",
                "2.646225949457269005240398090200201895129",
                "2.654930991644879860053051196911948343098",
                "2.663742353774647270591823679977952449735",
                "2.672662336761952990129593187513720622368",
                "2.681693313690180734349430977757825061284",
                "2.690837732794137320206435388627438365956",
                "2.700098120597274072379357572001743849637",
                "2.709477085212243383265671521225547883263",
                "2.718977319815018218838814697827813286262",
                "2.728601606303553182369674997314566823296",
                "2.738352819152779967041632991033763661627",
                "2.748233929478613715059875855477716674194",
                "2.758248009324606673903330940952804905584",
                "2.768398236185929047001222934453752097134",
                "2.778687897786492339218996695448145309028",
                "2.789120397126266974966552188833439926834",
                "2.799699257817193723811708302868302580109",
                "2.810428129727558865690048190725737850924",
                "2.821310794956308726037147745813718493293",
                "2.832351174160534337035636559192806090152",
                "2.843553333261277315476619472629862121989",
                "2.854921490554911240698552387592488431442",
                "2.866460024259658633373538165521393168354",
                "2.878173480529334240491042398963799312088",
                "2.890066581969185607070528972492949352654",
                "2.902144236691759835840867018264014143651",
                "2.914411547954092495936561385524937735472",
                "2.926873824421226344959115864473449691554",
                "2.939536591105163958805038388156469648559",
                "2.952405601032884839512123506423052148924",
                "2.965486847702065408733056617803531962820",
                "2.978786578388687688653502993361787739643",
                "2.992311308376875524718708860758013535004",
                "3.006067836188131118707996608510567575982",
                "3.020063259894745116972868880501954700089",
                "3.034304994610618366401622146707823546610",
                "3.048800791262174580139644216492546458495",
                "3.063558756752588702500486583518998515209",
                "3.078587375644352811973515148116010978269",
                "3.093895533498419080607011713369190491968",
                "3.109492542022992471925503075110404433849",
                "3.125388166201719453069258673581159373350",
                "3.141592653589793238462643383279502884197",
                "3.158116765987672634484588810957320398650",
                "3.174971813726040889569283066809595156396",
                "3.192169692822721169290747731394975129469",
                "3.209722925302992672622162011428473211997",
                "3.227644703009673219497021314626179164650",
                "3.245948935269103905180708633449925585403",
                "3.264650300824557563469789083949839727327",
                "3.283764304500501213502136356445820250378",
                "3.303307339120644266995220431403044732381",
                "3.323296753271068512679322232472504614018",
                "3.343750925578472034266985880506857834806",
                "3.364689346264467014828589385971633266595",
                "3.386132706842103698631726898292470064691",
                "3.408102998942933202033368759287962972689",
                "3.430623623405081256522575981598915868684",
                "3.453719510918742140223065947190538656273",
                "3.477417255719775135273372385121686776703",
                "3.501745264050243019698793239522836668184",
                "3.526733919373553035012511398021764356800",
                "3.552415766649663661816470462572816342998",
                "3.578825718352854486859773690817808622948",
                "3.606001285363505466222716217203569250053",
                "3.633982836401965728100287969682271473560",
                "3.662813890316611300718105224598576344725",
                "3.692541446314330953343932249974253264227",
                "3.723216358161159703688391362828932722297",
                "3.754893759523223058856396763868388438922",
                "3.787633549014139671105518232990512244807",
                "3.821500945229511012816289105511760523080",
                "3.856567124166056980124539655998436866623",
                "3.892909954051574448872939609151425668051",
                "3.930614845895350913875751766062302351104",
                "3.969775742195951715233063460430946580908",
                "4.010496271465918964865639645597226495667",
                "4.052891102888370590641085968416792490803",
                "4.097087543965707836739217492660174163824",
                "4.143227435080151055441728722329421173936",
                "4.191469409321823850224484589617981745764",
                "4.241991604955771493203345921977413890561",
                "4.294994943193040359614488154675194640390",
                "4.350707117929968843837333107853266190799",
                "4.409387490339156228567125949366475701138",
                "4.471333144798777352444464107304924278278",
                "4.536886451337544602722067458256819621439",
                "4.606444605238025926945572797329331083935",
                "4.680471794739557404098730545469708933328",
                "4.759514911379342146068550498371502728946",
                "4.844224110273838099214251598195914705977",
                "4.935380125293062643123447893401974747617",
                "5.033931175033695836255194969544187016013",
                "5.141043784182555315082498534844279943610",
                "5.258174297007593616076759492674163108337",
                "5.387172037487060787561066292693906862897",
                "5.530432470024246646571468883670993471624",
                "5.691132425460332561445085413733009466640",
                "5.873606252091230580774851191703220955123",
                "6.083977570987410547335711217665777582332",
                "6.331287061746980144368960560637955608074",
                "6.629669289392392127048364623313737750964",
                "7.003015211663010115900904184048593023070",
                "7.496538831993589013284337648603819157035",
                "8.212797131164662505497922794808371830220",
                "9.482884976178598685801026347821389702232"
            };

            const double n = 0.75;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNp0p50Test() {
            ddouble[] expecteds = {
                "1.800473988685746308971971577274643085483",
                "1.804898426013661011343256740050006410364",
                "1.809365720667221539643262472670601089498",
                "1.813876618949480656073798836361705683087",
                "1.818431886106051807309534569512399612605",
                "1.823032306960389888455925318813649597462",
                "1.827678686575665256441728813006553523929",
                "1.832371850944569811371956706404279191532",
                "1.837112647708472935048280017706444033474",
                "1.841901946907429399445983329572091165593",
                "1.846740641762631445198501545449878775060",
                "1.851629649492993527129021789278833039885",
                "1.856569912167661215253118103391272050301",
                "1.861562397596345952455367952009039072962",
                "1.866608100259505377640778437131205511351",
                "1.871708042280515349961962301131989004289",
                "1.876863274442115336087267417308940800377",
                "1.882074877249554190307345403262286647320",
                "1.887343962043019376195174725982138565044",
                "1.892671672162100232719980936889812242028",
                "1.898059184165215943531602550647468234878",
                "1.903507709107132482591656028313036052732",
                "1.909018493877901139525117765445068217627",
                "1.914592822606775541685055707371911330448",
                "1.920232018134905776963527465703572702016",
                "1.925937443560868807249439421220293846288",
                "1.931710503863375522577035132144441361833",
                "1.937552647605798362290600743065332244376",
                "1.943465368727491448594488842032705438418",
                "1.949450208427229871611656784661368804547",
                "1.955508757144478593902739201020368508070",
                "1.961642656644617121028052017030570638061",
                "1.967853602214696611449820735115032303059",
                "1.974143344976794788594032208054177333807",
                "1.980513694326564538467058392202774011720",
                "1.986966520505148491493242890160987392289",
                "1.993503757313258703578110368397539037582",
                "2.000127404976902771489690173074275239087",
                "2.006839533174980901204267929056314185584",
                "2.013642284239788780547667843741549134338",
                "2.020537876542345479203606285010221476727",
                "2.027528608075431693253454925001446439312",
                "2.034616860248280046070309763679215466195",
                "2.041805101908015441621361675668199834028",
                "2.049095893604210372260907717885096129105",
                "2.056491892114309637925910278645444651425",
                "2.063995855249204632788446506409352905044",
                "2.071610646959914362342418172938500892134",
                "2.079339242768175729371344369072091452266",
                "2.087184735545778593471200160517083691782",
                "2.095150341669723354187801998226449115896",
                "2.103239407582754839145030486748807591509",
                "2.111455416791563828654013424545758572624",
                "2.119801997337978049029414120752232224837",
                "2.128282929781823598414231447822850647399",
                "2.136902155737866099541439902484756240385",
                "2.145663787013384605764275086628720872093",
                "2.154572115397543127971171864979844526095",
                "2.163631623158864835677573848153343410761",
                "2.172846994312851475788390574120908567660",
                "2.182223126728204441686122648971420520767",
                "2.191765145147285103109261264553715981200",
                "2.201478415204505120850077504843453566126",
                "2.211368558535383247562617006535848840104",
                "2.221441469079183123507940495030346849307",
                "2.231703330689518500580313543719463678675",
                "2.242160636180265890872850342806649687879",
                "2.252820207948778275550337719514293069032",
                "2.263689220335001996037386258202690828189",
                "2.274775223893960137562171808308428605604",
                "2.286086171780528689613000470458580502273",
                "2.297630448469906695582521163122548824684",
                "2.309416901065151688137349066431409215699",
                "2.321454873475187738880209151988226767180",
                "2.333754243783471579551302913204085862342",
                "2.346325465169825757447960314351498013651",
                "2.359179610796773853956500698661240451062",
                "2.372328423128185548852605110707490221901",
                "2.385784368213530748181187568109065154812",
                "2.399560695547202859969421575730346966036",
                "2.413671504201194640666923520539289936849",
                "2.428131816033310833371372216790840268438",
                "2.442957656895017310356854915556730447526",
                "2.458166146906542963147586509487436920927",
                "2.473775601036364833425443182377642615688",
                "2.489805641423131845902452448605030042071",
                "2.506277323117111366699863963562751911936",
                "2.523213275203690513305869653505644648423",
                "2.540637859613709442085222483552072739318",
                "2.558577350337466814855231084631689244273",
                "2.577060136257537814759546970801072479659",
                "2.596116951420903105594386727310343652300",
                "2.615781137309857184619052473199791294016",
                "2.636088942577818929372620290753535618957",
                "2.657079866834503928577963052489336883382",
                "2.678797056452135204266021735091732095215",
                "2.701287762095351005040349470677451682699",
                "2.724603869850991097776944245385206050925",
                "2.748802520581327204971747895809556496497",
                "2.773946835621603911005954809410012215686",
                "2.800106771428104638172933908972820171837",
                "2.827360131581500623719358947004386708206",
                "2.855793772110422988683197969472847521570",
                "2.885505046047182558698646248543645996640",
                "2.916603546342931845080836525412853177728",
                "2.949213224011889828282488052779490388678",
                "2.983474982464242872931568818398771702413",
                "3.019549882096787224523520375934347354847",
                "3.057623135321011206452538605486303440631",
                "3.097909137354299748638036876829610565496",
                "3.140657871594373122496463824585638275316",
                "3.186163164903645047646893807444600729577",
                "3.234773471249464853158012498200483043296",
                "3.286906170793683540936071283381826634031",
                "3.343066851618606626062947673090788935967",
                "3.403875807878793513889073528093814061192",
                "3.470105249031650587148874590534317834719",
                "3.542732859694054499354613291357503190081",
                "3.623021142666066998133159693830939911148",
                "3.712638994629356155140172280880546984950",
                "3.813855654722725601018092359142685101860",
                "3.929865638331331889629327419438789727660",
                "4.065367295837246049850859614576354955427",
                "4.227676505779574777601391209438225080819",
                "4.429105250459929276011454932665585822315",
                "4.692844330034645603011756639337770859326",
                "5.071221894438481651723831819379051690532",
                "5.732149060091635576281067134097686631742"
            };

            const double n = 0.50;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNm8Test() {
            ddouble[] expecteds = {
                "0.4772507191595812077460399481301857432433",
                "0.4777859516603065096626794459370511224573",
                "0.4783251742277098473505182414980472231723",
                "0.4788684480400609062799383530863344051254",
                "0.4794158357156062938183915793260287924139",
                "0.4799674013584961277070232036794076285195",
                "0.4805232106065650768324344899505903782113",
                "0.4810833306810587077303929704470381125648",
                "0.4816478304384012360650599257482542952273",
                "0.4822167804241063776385916954652735250134",
                "0.4827902529289389647439391362083855931298",
                "0.4833683220474413695637181035907261209702",
                "0.4839510637389455879800471802108294308525",
                "0.4845385558911991184217793835953055173003",
                "0.4851308783867405580092881030974233965212",
                "0.4857281131721691722654553362580041194213",
                "0.4863303443304616185921516178680542489649",
                "0.4869376581564985650053579333699511788472",
                "0.4875501432359741960005110756007226809876",
                "0.4881678905278725933131863736500980352564",
                "0.4887909934507067823648068499589076985086",
                "0.4894195479727289126693152979504390478122",
                "0.4900536527063336660587730909681669639600",
                "0.4906934090068916408568635746411154674241",
                "0.4913389210762652313723370685695482078373",
                "0.4919902960712765070877521781943129107421",
                "0.4926476442174149008863719412172143072074",
                "0.4933110789280922572293996411305476861133",
                "0.4939807169297740975775356860951851357575",
                "0.4946566783933389726051964642421307235087",
                "0.4953390870720426442238283575810066004415",
                "0.4960280704464907463423116206623086913745",
                "0.4967237598770527005727811696648448402559",
                "0.4974262907641812203937821201054110307452",
                "0.4981358027171359552845695410154741563437",
                "0.4988524397316469603250468586442004395039",
                "0.4995763503770940095208671419931176874665",
                "0.5003076879938216162950091356335946422834",
                "0.5010466109012573303837712384113295025047",
                "0.5017932826175528337895589645824403439797",
                "0.5025478720915239900958804602409520091186",
                "0.5033105539477277910521383546447888272171",
                "0.5040815087455816269170130439047844124202",
                "0.5048609232535040800612111886084080130309",
                "0.5056489907391371727560590060281291056269",
                "0.5064459112767984377008453591051841409500",
                "0.5072518920734081618793298347871273376791",
                "0.5080671478142436215984936667513333328856",
                "0.5088919010299891364612578589504618279601",
                "0.5097263824866795126689264560442524909685",
                "0.5105708316002762628058119224262607484500",
                "0.5114254968777723941814917821646295225228",
                "0.5122906363868942624199851419945127923867",
                "0.5131665182566599290031087772404927696465",
                "0.5140534212112648381358803548201026345011",
                "0.5149516351399999351398699495864751597427",
                "0.5158614617061674246058380127125276673732",
                "0.5167832149982484469853985008308201301687",
                "0.5177172222268987303503256185731177430197",
                "0.5186638244717069731744239012606443141244",
                "0.5196233774820511729886889899084882629838",
                "0.5205962525368358888421085657801626652964",
                "0.5215828373683949004581675562946556808553",
                "0.5225835371564062649422743899527183489789",
                "0.5235987755982988730771072305465838140329",
                "0.5246289960633411079458538859978689850043",
                "0.5256746628384045160454323732804039417959",
                "0.5267362624743017738409899903128338987673",
                "0.5278143052426241171053420614052221064246",
                "0.5289093267141668340585001472374044880382",
                "0.5300218894713535219880527287059137807685",
                "0.5311525849685753524825298370203921371531",
                "0.5323020355560797433107559631731915974417",
                "0.5334708966850080016175517574923344575582",
                "0.5346598593134343927900873037629216182556",
                "0.5358696525358480087506843851643376497660",
                "0.5371010464615012524837075558110102553994",
                "0.5383548553704933635184207498476336715099",
                "0.5396319411804463957016860412193155508097",
                "0.5409332172612632231580153194124854431084",
                "0.5422596526408516351282497452930308635925",
                "0.5436122766509995768408377841283393835155",
                "0.5449921840699692619932592416440207968547",
                "0.5464005408270558317439536315953135016209",
                "0.5478385903445910183457780573414555871338",
                "0.5493076606049854989160203492258960208020",
                "0.5508091720447924950215464080679165600313",
                "0.5523446463949324935672054963486642479243",
                "0.5539157166067590971484433480604147463733",
                "0.5555241380283387048212451678962920086947",
                "0.5571718010251314751714687714262387937145",
                "0.5588607452754256401608284928174975800785",
                "0.5605931760149556422474057633041881433362",
                "0.5623714825591308925936894581055088841724",
                "0.5641982594978008390857446831323539413641",
                "0.5660763310398391912942729405746742554034",
                "0.5680087790874332324877616220650648748804",
                "0.5699989757485930550883511213009544918824",
                "0.5720506211587244743301960571270416724230",
                "0.5741677876884130865734174591573922397488",
                "0.5763549718787245814486168161398572652218",
                "0.5786171557862634014982591923926368454441",
                "0.5809598798640149985777342823440732488202",
                "0.5833893300869161495159224856950125597657",
                "0.5859124428042580367185837260766278580557",
                "0.5885370318372869211118056914688050914134",
                "0.5912719437449829868518428194614052871849",
                "0.5941272491082119835384650877045228641010",
                "0.5971144803618001933981066906974956301260",
                "0.6002469304829573538071516164570587486577",
                "0.6035400322582424047523778178403677697086",
                "0.6070118457416954825268464421452381349664",
                "0.6106836932366748439731958786026342988851",
                "0.6145809989108115017135441070047621758552",
                "0.6187344177548641489234606740616594935556",
                "0.6231813825888098726421879325491088899564",
                "0.6279682700411048206224125055837271088383",
                "0.6331535090574421674926271295013071506659",
                "0.6388121719425019550429119336069765334802",
                "0.6450429875939473236710012129407293362150",
                "0.6519794948342567275201967556585576150059",
                "0.6598086690442678633976478218073688023956",
                "0.6688039804299403910322640438164449655846",
                "0.6793888186611709386906191566132769436323",
                "0.6922714910842477126179186721920055236695",
                "0.7087779218945786321211627030743217005419",
                "0.7318804155416557734266990178614049562201",
                "0.7710481350290348289760521087062483185031"
            };

            const double n = -8;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNm16Test() {
            ddouble[] expecteds = {
                "0.3542265752067889697702668268736907654293",
                "0.3545405983452070630660382822951281883013",
                "0.3548568323988125633553853079321740517539",
                "0.3551753106306654611267172207674450100869",
                "0.3554960670801823513483377601521525121810",
                "0.3558191365877848806576244888586372620933",
                "0.3561445548205406762695383753053179292737",
                "0.3564723582988452888080923835291701053444",
                "0.3568025844241964797063993395999673207214",
                "0.3571352715081151685228205504195860554735",
                "0.3574704588022705405632503419532344526708",
                "0.3578081865298702158572080966357582021168",
                "0.3581484959183800133888501209615035290344",
                "0.3584914292336417275441186748968198132209",
                "0.3588370298154614865800218322913744918449",
                "0.3591853421147457068480519125448324188726",
                "0.3595364117322664146936483762990150412527",
                "0.3598902854591428056616227115695284472823",
                "0.3602470113191313753949968801731988649420",
                "0.3606066386128228184584219546383511773192",
                "0.3609692179638501830423786133729923242364",
                "0.3613348013672195269457628070114012434869",
                "0.3617034422398815825802409125231216959082",
                "0.3620751954736707488794769289792498954990",
                "0.3624501174907461329096018374590476529606",
                "0.3628282663016784151672225879010677673595",
                "0.3632097015663360665285305195726336852986",
                "0.3635944846577349636370655431301689407066",
                "0.3639826787290268014021682187898146538149",
                "0.3643743487838139612716881735620628390777",
                "0.3647695617499917446814877478537282035718",
                "0.3651683865573332136592466258944807389268",
                "0.3655708942190473954681866681981610146348",
                "0.3659771579175584164041383955282711161612",
                "0.3663872530947713541005364603101878751149",
                "0.3668012575471103737249491197144109898207",
                "0.3672192515256361916744125331698299636865",
                "0.3676413178415732575887847632991186951580",
                "0.3680675419776024468686876220397043267087",
                "0.3684980122053027172004646918878170365154",
                "0.3689328197091553328312536602791767080912",
                "0.3693720587175571545694683431188841297223",
                "0.3698158266413254161765295152038629544997",
                "0.3702642242202156766047447708018701131739",
                "0.3707173556780176075453481872895491032381",
                "0.3711753288868403445086461041136045930794",
                "0.3716382555412507427419476473262715097244",
                "0.3721062513429845367955495484113476863514",
                "0.3725794361970126665181271828594067054642",
                "0.3730579344198135352488784436681054939785",
                "0.3735418749607774208829727823446150530670",
                "0.3740313916377524719679497836630630101029",
                "0.3745266233878335985931257381054338816548",
                "0.3750277145345971412666110770076414703825",
                "0.3755348150730966377960737453166148039377",
                "0.3760480809740596344046027902305262345968",
                "0.3765676745088638113599517227635581686075",
                "0.3770937645970244341541682204013337210186",
                "0.3776265271780962608314401129687848307028",
                "0.3781661456100837781418820326865433939020",
                "0.3787128110966665742769208595476161043524",
                "0.3792667231457847344052633178983819958284",
                "0.3798280900623957600943408142443421947070",
                "0.3803971294785135748121039177075702617302",
                "0.3809740689239761997006901461043671775548",
                "0.3815591464417668907178524619400741281698",
                "0.3821526112521399780799848642554061661191",
                "0.3827547244702843826512496074072172448878",
                "0.3833657598828030037610245643135419807150",
                "0.3839860047889044567981512522975613989416",
                "0.3846157609129061986114768256994019193147",
                "0.3852553453954480719715219872038563468616",
                "0.3859050918717282090409625350917361618973",
                "0.3865653516461173240088668093077092705911",
                "0.3872364949737043080094072356652714676856",
                "0.3879189124607013583813788229265331950017",
                "0.3886130165972211479705943848405993683399",
                "0.3893192434377682026983165255855680368265",
                "0.3900380544469053433327152337780575428720",
                "0.3907699385300161971044076787086160057152",
                "0.3915154142719496271618903097782840238564",
                "0.3922750324096779838656856817382917608122",
                "0.3930493785690213030169172091349491966154",
                "0.3938390763000973117156533003404067811126",
                "0.3946447904515911364923365957823835485248",
                "0.3954672309303695836271565558945027150937",
                "0.3963071569006035175714046122169159729773",
                "0.3971653814856696533524427568708101634963",
                "0.3980427770470059309880775660130147379204",
                "0.3989402811272008964759613881262167395288",
                "0.3998589031604214582230472084699479958930",
                "0.4007997320724762961288237168568051580418",
                "0.4017639449162035978418420024315845178791",
                "0.4027528167165246519219673481123416548364",
                "0.4037677317347899407303255875229953089795",
                "0.4048101964057414031317396965574558510931",
                "0.4058818542548503098793628735228311314932",
                "0.4069845031720297231233541714046555467042",
                "0.4081201155038331329241255261540242582064",
                "0.4092908615356846552480979300884779733770",
                "0.4104991370758000335398829027811157886897",
                "0.4117475960332856301864411731467689698273",
                "0.4130391891182642859931068951102394998640",
                "0.4143772101010110022358111765828723717951",
                "0.4157653514770792555618789758836778020214",
                "0.4172077719348819699027446593653257122505",
                "0.4187091787669518886827344961344373247640",
                "0.4202749293878987401932667042550678728281",
                "0.4219111575425661682604285984097352815613",
                "0.4236249317911750911896962596576775691421",
                "0.4254244567280522669859618692534941080165",
                "0.4273193315729648293826662244217834324986",
                "0.4293208869859941945970382551385692394797",
                "0.4314426303785956501380136714427118970961",
                "0.4337008446212792085113113518040517307787",
                "0.4361154083614884626541260897253483182115",
                "0.4387109444361190735263640266458923491067",
                "0.4415184678411846928620674127368619246033",
                "0.4445778194028066896469266837200943513342",
                "0.4479413830330300434124801870458620092113",
                "0.4516799967467888860720217171915305933230",
                "0.4558928233024906628095343015701186790801",
                "0.4607248665793401762284536394916731973392",
                "0.4664005743574717014168908602266501961169",
                "0.4732953534235920596121060773239388864953",
                "0.4821117968935886669491754498757764257117",
                "0.4944245469887573911787111012159280014050",
                "0.5152489276895301866838960698192101526192"
            };

            const double n = -16;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPikp0p50Test() {
            ddouble[] expecteds = {
                "0.4058818542548503098793628735228311314932",
                "0.4066687095640588297182390431892578074014",
                "0.4074600529689684693240346941368419784841",
                "0.4082559269336364341040520885228171447060",
                "0.4090563744841747785372096083242180054068",
                "0.4098614392183242299020506719665154077020",
                "0.4106711653152276920908898996048140523276",
                "0.4114855975454083630542020647058129403608",
                "0.4123047812809575404478133585619570009737",
                "0.4131287625059373356663077813145731954278",
                "0.4139575878270036668062467852649473163863",
                "0.4147913044842550563859936525642050318719",
                "0.4156299603623129200358541459882390589126",
                "0.4164736040016391980509668616642116169936",
                "0.4173222846100973528656611408350325727442",
                "0.4181760520747629323656387921778654989266",
                "0.4190349569739900817155124483701042630995",
                "0.4198990505897405752649049902578689579773",
                "0.4207683849201821353366092459774118530832",
                "0.4216430126925630065349428812665400911514",
                "0.4225229873763699628911566509928131436753",
                "0.4234083631967771409458015679267447199964",
                "0.4242991951483933150265428957925955577078",
                "0.4251955390093154617967199240509478650196",
                "0.4260974513554966999197012431724802969330",
                "0.4270049895754369377140655042702356848915",
                "0.4279182118852048172853061165977855238068",
                "0.4288371773437998081453629490168628664086",
                "0.4297619458688635771205142424090638496020",
                "0.4306925782527500447648343059217465657205",
                "0.4316291361789638319202025717494088988781",
                "0.4325716822389771038910102827747766979400",
                "0.4335202799494351343459317863331110816380",
                "0.4344749937697612369523341327291800708557",
                "0.4354358891201720503421489482833043038764",
                "0.4364030324001145117724449577582993866400",
                "0.4373764910071362172716827984974464286633",
                "0.4383563333562012416679481849613752642540",
                "0.4393426288994638812157536841471144848767",
                "0.4403354481465131851349957199074872265781",
                "0.4413348626851015608365974354959187129083",
                "0.4423409452023711715483033726746794858085",
                "0.4433537695065922951132049481416751989470",
                "0.4443734105494282795846136735977120038228",
                "0.4453999444487422155866662476517925232355",
                "0.4464334485119609479859821294824075494598",
                "0.4474740012600125709955422538157000892213",
                "0.4485216824518540922135208476730034127321",
                "0.4495765731096065131308036585526789666072",
                "0.4506387555443151572049693553225303679339",
                "0.4517083133823536826211546845007203125071",
                "0.4527853315924908463111711929529406517007",
                "0.4538698965136397396976551623382512738481",
                "0.4549620958833098960349841451305173291157",
                "0.4560620188667833752497512809328910689380",
                "0.4571697560870366660115556566554070050176",
                "0.4582853996554310076176789460373331513876",
                "0.4594090432031945274410095162201468177318",
                "0.4605407819137204145209235052976040042129",
                "0.4616807125557062077901975572799641160181",
                "0.4628289335171601699163906354405478225313",
                "0.4639855448403016463568508290245716110982",
                "0.4651506482573832756243996017681228698839",
                "0.4663243472274639226604385276500466664416",
                "0.4675067469741622544257187301489442024221",
                "0.4686979545244219672505768652935350733963",
                "0.4698980787483208111377661110535401924921",
                "0.4711072303999567391866987374061497262574",
                "0.4723255221594457428213010975829089581370",
                "0.4735530686760672178830047783265786719649",
                "0.4747899866125940453453745936549017674780",
                "0.4760363946908459659956659039630858053364",
                "0.4772924137385062836252260259263727005404",
                "0.4785581667372434489328539188787283275274",
                "0.4798337788721806594828613655786921364125",
                "0.4811193775827582628435035047499627111093",
                "0.4824150926150354738030237069037337721301",
                "0.4837210560754797158417217788324661327044",
                "0.4850374024862937755424554739947609340782",
                "0.4863642688423329202648248883850497601995",
                "0.4877017946696661783209028832731151324620",
                "0.4890501220858381214316129989255024053596",
                "0.4904093958618897260133237712155195149590",
                "0.4917797634861992277010386827485413948833",
                "0.4931613752302063275870768871762373495975",
                "0.4945543842160856643607675633073069098973",
                "0.4959589464864381396007962586785379170360",
                "0.4973752210760714799489313176283187266517",
                "0.4988033700859443461799638921591987222586",
                "0.5002435587593513620442572417178279691706",
                "0.5016959555604296423545098890836190838867",
                "0.5031607322550707576920970395563798424038",
                "0.5046380639943255903389883457342496816238",
                "0.5061281294003932210890627365889902634892",
                "0.5076311106552888484505455722820034569388",
                "0.5091471935922897899475017454703736715634",
                "0.5106765677902628598614646286588675958472",
                "0.5122194266709808695310068738085381911816",
                "0.5137759675995406666023180752681817913504",
                "0.5153463919880000304441333067945588599245",
                "0.5169309054023558850900486828211218846385",
                "0.5185297176729916921224349057612803951311",
                "0.5201430430087275582780022739295364413766",
                "0.5217711001146125515472829412473118392783",
                "0.5234141123136049814307806577012334020006",
                "0.5250723076722929811017088678993502115411",
                "0.5267459191308146499053379431401013416489",
                "0.5284351846371442934688066707135835868643",
                "0.5301403472859189565307852951538626771465",
                "0.5318616554619875026016743324028202971252",
                "0.5335993629888729783480805257548343592732",
                "0.5353537292823479343213352853496744569730",
                "0.5371250195093317841366002436606610631498",
                "0.5389135047523292000511565725091092966690",
                "0.5407194621796389945887204302917563516437",
                "0.5425431752215739579584141243780859440922",
                "0.5443849337529437442673949370366612869570",
                "0.5462450342820651630313369435566434105743",
                "0.5481237801465771758912012125126501268080",
                "0.5500214817163515641215067042321348375539",
                "0.5519384566038046657744228227483403912371",
                "0.5538750298819308306157621859092213750088",
                "0.5558315343103943582471426777104438321510",
                "0.5578083105700337255138324646865793379168",
                "0.5598057075061499329632126547026148989700",
                "0.5618240823809698705000208467619021291737",
                "0.5638638011356957878363222960482934880750",
                "0.5659252386625733291760447441426252502711",
                "0.5680087790874332324877616220650648748804",
                "0.5701148160631857861816912354080653020566",
                "0.5722437530747725707591480731026090393809",
                "0.5743960037561069875638133076442068836039",
                "0.5765719922195636959884668572911564890603",
                "0.5787721533986074571762998614632117797881",
                "0.5809969334041841378080230313632537833171",
                "0.5832467898955308927217395131292798425334",
                "0.5855221924660989607315700492164122932521",
                "0.5878236230453212259398223113774081371308",
                "0.5901515763169978808546363339156547892633",
                "0.5925065601551173544752186970536589153446",
                "0.5948890960779763290330951289969947355806",
                "0.5972997197215123694622309173390638801336",
                "0.5997389813328156527942084204483078079582",
                "0.6022074462848427516085851973138813500536",
                "0.6047056956134156573135919825773154810595",
                "0.6072343265776535079172936249692070042132",
                "0.6097939532450531172097010720296337020074",
                "0.6123852071025077198307167703784073076494",
                "0.6150087376946317096453015880454311880639",
                "0.6176652132908429481036492148537969790014",
                "0.6203553215827438794791449192612690889985",
                "0.6230797704134386726425633541207911334961",
                "0.6258392885405264164304703839662489690330",
                "0.6286346264346205741942539726634888396373",
                "0.6314665571153630480176472452622941496940",
                "0.6343358770270279631589826590100896671007",
                "0.6372434069559463661727988544320094755243",
                "0.6401899929921292083242249004532181560551",
                "0.6431765075376231030724946752780039274133",
                "0.6462038503643023248951193825725093097391",
                "0.6492729497239823655480260842555684646102",
                "0.6523847635139361876694031881908953663016",
                "0.6555402805011053247789177721803968830750",
                "0.6587405216085254983946649423939343349518",
                "0.6619865412677319136995742381941565203698",
                "0.6652794288411744546877330960385167136607",
                "0.6686203101189593865647589296532475145893",
                "0.6720103488945438221468851089799785625765",
                "0.6754507486243442506270970658445523307937",
                "0.6789427541765832095135965976849245570442",
                "0.6824876536750912941652468124164414616081",
                "0.6860867804442080043487404402896185801784",
                "0.6897415150613875847268476840459600451415",
                "0.6934532875246185231699432074327212674886",
                "0.6972235795423115996615238700859843994570",
                "0.7010539269539056216895273720346602769260",
                "0.7049459222900870020495182554214498356665",
                "0.7089012174822244219359559025195837263809",
                "0.7129215267313888579948910792660842744686",
                "0.7170086295481687838009108122144527502715",
                "0.7211643739754076796139686924816777351803",
                "0.7253906800069942380404740376289752184612",
                "0.7296895432169339271596996612159737188512",
                "0.7340630386141340306097753576092447018638",
                "0.7385133247396543044250182648237854307809",
                "0.7430426480246247266873577748158964312830",
                "0.7476533474286247812235523867507075840337",
                "0.7523478593800713940441283925721111425616",
                "0.7571287230420931274452684323892548057988",
                "0.7619985859294969203626083632168812931613",
                "0.7669602099047835472901063566841956638890",
                "0.7720164775837650397868090473873949274812",
                "0.7771703991842109769617646945056137173676",
                "0.7824251198541341191614212752078123955265",
                "0.7877839275198571364501567985265189892188",
                "0.7932502612979241345181509680628514256942",
                "0.7988277205192822107628369057502729855376",
                "0.8045200744190151404754678623254785933001",
                "0.8103312725503271732547989820803078435470",
                "0.8162654559875226545432174748507230569809",
                "0.8223269693894902480707211632521803493812",
                "0.8285203740027747455541390593647319611103",
                "0.8348504616918150153123829759513665363148",
                "0.8413222700934705451825283592958663243869",
                "0.8479410990036978770246232070042964684225",
                "0.8547125281163415927543279239294386069047",
                "0.8616424362476689646161243281361111859783",
                "0.8687370221957312550550288704796015690115",
                "0.8760028274011437394987170225907397078042",
                "0.8834467605957509262665755003242802284527",
                "0.8910761246482457752895676665437490320340",
                "0.8988986458415669964025493596242638060722",
                "0.9069225058463061302248960816577734481581",
                "0.9151563766880043235137759295271005995223",
                "0.9236094590448022054142107123933821832707",
                "0.9322915242562476655382470245440927423035",
                "0.9412129604751424024025439871370204022143",
                "0.9503848234532819832361853085094628399257",
                "0.9598188925202049666041957634586285432775",
                "0.9695277323932784996480001206655673122135",
                "0.9795247615496105343991092818831192041570",
                "0.9898243279978035356900791357709262981004",
                "1.000441793413368152941756527033506744149",
                "1.011393626749238928468684993789606028385",
                "1.022697508606592391221063288120449366337",
                "1.034372447856337969887704858499332640129",
                "1.046438912244713768320209374673436550873",
                "1.058918975005361337965951165833496893636",
                "1.071836479844967911002454323917700914734",
                "1.085217227082353316727564371826152303444",
                "1.099089184217112910592072587687824833450",
                "1.113482724802905315629874905404769389758",
                "1.128430900226545474095768290156159386997",
                "1.143969749878118494957106781565959834073",
                "1.160138656278767535467893437701610528224",
                "1.176980753062175375169215266321949101649",
                "1.194543395348294463375433483739580451119",
                "1.212878704088327727420994333768208611382",
                "1.232044198509139693960347705033204123751",
                "1.252103533989122927708637371858315293903",
                "1.273127366749682458457242076742137073923",
                "1.295194371905845737977491679541386245137",
                "1.318392448035165743335469926777351472368",
                "1.342820149970936946892889132297376058227",
                "1.368588402655798261557765235426432137764",
                "1.395822563509194836214967562275190260786",
                "1.424664920134002376744608274248921002541",
                "1.455277736109770624940153404969791583960",
                "1.487846992668798385273647399274200838436",
                "1.522587021970573511530486711405225924954",
                "1.559746293997188377767884976746364571245",
                "1.599614712040483317589343581441262757638",
                "1.642532903889501906603379213134398489871",
                "1.688904186573328262746388750580468825330",
                "1.739210162503567690434322364044336403835",
                "1.794031323445906952213675586602684741410",
                "1.854074677301371918433850347195260046218",
                "1.920211408820190510760734917078775722850",
                "1.993529178569172786463995681929176692142",
                "2.075406284800636499869837852859249294836",
                "2.167619360766555959906157571538397474939",
                "2.272504106750153651892019032827114255050",
                "2.393202910648986418866807734689289821143",
                "2.534060838288938875273316576944921354912",
                "2.701287762095351005040349470677451682699",
                "2.904127190453591811829134902120060406245",
                "3.157063680838831730355125798734162388831",
                "3.484369010741340448548683595079273163403",
                "3.930614845895350913875751766062302351104",
                "4.589324472266679104452228820118524097738",
                "5.703926819342179010742891747919890544549",
                "8.247440865028414790022890733102253908200",
                ddouble.PositiveInfinity
            };

            const double m = 0.5;

            for ((int i, double n) = (0, -16); i < expecteds.Length; i++, n += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(n);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPikm0p50Test() {
            ddouble[] expecteds = {
                "0.3655708942190473954681866681981610146348",
                "0.3662225986904733923237483378090249156531",
                "0.3668778563626574863010558433949986980621",
                "0.3675366998296205270693437836983731784731",
                "0.3681991621068067597929965879126950425252",
                "0.3688652766381288994844649424291503495058",
                "0.3695350773031578791246043955115343169538",
                "0.3702085984244607991872382621324264110662",
                "0.3708858747750907058995467885436408535552",
                "0.3715669415862319284717261384630479097003",
                "0.3722518345550048117540380725636261196087",
                "0.3729405898524337904473184786756848083644",
                "0.3736332441315828642295092764255324504940",
                "0.3743298345358626500961619554739591362702",
                "0.3750303987075133089827542815674253082585",
                "0.3757349747962677684822061621959599508097",
                "0.3764436014681997923390844746692958956322",
                "0.3771563179147615805455836484237746809156",
                "0.3778731638620157214426902738376570510008",
                "0.3785941795800664594088000051571906857182",
                "0.3793194058926953886701495901455795742577",
                "0.3800488841872068356726482580835604395485",
                "0.3807826564244883495004592389459770542279",
                "0.3815207651492918822082845587894636240969",
                "0.3822632535007414088552712638804718547475",
                "0.3830101652230729107009298692077594878721",
                "0.3837615446766128246686007322885104245345",
                "0.3845174368490012480304273157641858480171",
                "0.3852778873666663795599878665963023121576",
                "0.3860429425065568773855408108773766667384",
                "0.3868126492081390197199371137982715595589",
                "0.3875870550856657678156844652227126533129",
                "0.3883662084407250511803516091187721744075",
                "0.3891501582750748235858837905053246308617",
                "0.3899389543037726750259389802776279594622",
                "0.3907326469686080298422274471813388587663",
                "0.3915312874518452150925891545181423230444",
                "0.3923349276902859462237862244145213771216",
                "0.3931436203896600496101380594908961539585",
                "0.3939574190393535239111834665010312631839",
                "0.3947763779274833348909171849159669742015",
                "0.3956005521563286417494816865356139914278",
                "0.3964299976581284675863371716673229522375",
                "0.3972647712112561528028550086541149170531",
                "0.3981049304567812685440993881033151770533",
                "0.3989505339154300181786082376066823283745",
                "0.3998016410049555188489257804123185688508",
                "0.4006583120579297328466711159606131378633",
                "0.4015206083399692105520273359507030078631",
                "0.4023885920684072135337880389091720033644",
                "0.4032623264314252087660923601729669855833",
                "0.4041418756076571634452889943837065097998",
                "0.4050273047862805252801124420921866687767",
                "0.4059186801876082461088446376721105916915",
                "0.4068160690841966980316261895465647723519",
                "0.4077195398224848417346127324634628714692",
                "0.4086291618449805371640187382575610916767",
                "0.4095450057130104380618295989271724566325",
                "0.4104671431300504850236540754631092097717",
                "0.4113956469656546076506918845102789980907",
                "0.4123305912799998660577093677736676765925",
                "0.4132720513490669065331921040339648254474",
                "0.4142201036904752766455038185089144584783",
                "0.4151748260899938427249475782916704382172",
                "0.4161362976287472786601987323391393224364",
                "0.4171045987111403506251092239869057683556",
                "0.4180798110935225090606365731391586012351",
                "0.4190620179136161184083902164384970168931",
                "0.4200513037207325082321737553595384150624",
                "0.4210477545068009180546358789743267897288",
                "0.4220514577382363341423663916606019455306",
                "0.4230625023886731813457378179105717660333",
                "0.4240809789725928387823197820407224586669",
                "0.4251069795798739965844485531978826662456",
                "0.4261405979112959641546308470329733018530",
                "0.4271819293150261805374175959011159955542",
                "0.4282310708241243668884604882179226075011",
                "0.4292881211950970019874058741413516862795",
                "0.4303531809475370968164894829388565953854",
                "0.4314263524048855960628691980563486273425",
                "0.4325077397363521457959982883812648351852",
                "0.4335974490000344404709162330834639128088",
                "0.4346955881872769019257599659781085897952",
                "0.4358022672683110514607791799154072446816",
                "0.4369175982392216168730338802491312293805",
                "0.4380416951702841731359641602487830894005",
                "0.4391746742557219521221394439820709326186",
                "0.4403166538649313774552339701965972116621",
                "0.4414677545952278895602888015556030782153",
                "0.4426280993261657278229273903731407749330",
                "0.4437978132754875362939056413799594882496",
                "0.4449770240567619616895027493001886154912",
                "0.4461658617387698229416345116118991076994",
                "0.4473644589067019559605481371314469737687",
                "0.4485729507252344816397085579297095308287",
                "0.4497914750035500158667384234000122703220",
                "0.4510201722623762441965846027081871765175",
                "0.4522591858031163280897707329723693215309",
                "0.4535086617791488018484511168807840522067",
                "0.4547687492693779676859129743823687143285",
                "0.4560396003541193093229147683360767246052",
                "0.4573213701934081312233066449428708315049",
                "0.4586142171078235007284024115206522271615",
                "0.4599183026619236341893168123398548037051",
                "0.4612337917503931366325960128332604732372",
                "0.4625608526870069891133212201485990358015",
                "0.4638996572965208910276570038883387955126",
                "0.4652503810096025193702534410589556530589",
                "0.4666132029609234771627245381982381909837",
                "0.4679883060905371838730525853064544998723",
                "0.4693758772486737273745519485717043001545",
                "0.4707761073040887666642988827961612123138",
                "0.4721891912561099650804034923697410371665",
                "0.4736153283505311642083810147305245088137",
                "0.4750547221995115993952656743799270741604",
                "0.4765075809056449304971163907462409655790",
                "0.4779741171903707393268250188294488834211",
                "0.4794545485269094529623041435203226913576",
                "0.4809490972779104160160532752496318043631",
                "0.4824579908380120833554752729774419009316",
                "0.4839814617815230677386183686279298419230",
                "0.4855197480154430866186666731365065582556",
                "0.4870730929380537434452081918549030073826",
                "0.4886417456033205880427776130227532043462",
                "0.4902259608913600675753120209458499554839",
                "0.4918259996852378465161679141416634392115",
                "0.4934421290543785862741113476826682514187",
                "0.4950746224448816812821108619841535157997",
                "0.4967237598770527005727811696648448402559",
                "0.4983898281504764380886072376433754124165",
                "0.5000731210569745912724646676219780752354",
                "0.5017739396018092303740788444275578898051",
                "0.5034925922335124597287421380160332687286",
                "0.5052293950827430815688435630532942318939",
                "0.5069846722105927329176147607757553448804",
                "0.5087587558667869631092575239869900992177",
                "0.5105519867582511464372589100895620661111",
                "0.5123647143285370815088292343371492977555",
                "0.5141972970486337240475528711079222658353",
                "0.5160501027197148495948795875003697473370",
                "0.5179235087884076724935527259000069781010",
                "0.5198179026751996934015703157856146508112",
                "0.5217336821166364560060579334356724757348",
                "0.5236712555220006230867887275165245954649",
                "0.5256310423452030040684853044112785321391",
                "0.5276134734726590662614987711302682181148",
                "0.5296189916279702410792821358639581325850",
                "0.5316480517942782124013434339154273425954",
                "0.5337011216552125830430831556315971301941",
                "0.5357786820554081131872682220748687882667",
                "0.5378812274816273897649127674030100816597",
                "0.5400092665655886203134506716336179135094",
                "0.5421633226096665772761786473750550167136",
                "0.5443439341367079063823449188666746696316",
                "0.5465516554652804446599620481696227236427",
                "0.5487870573117602935343375153302061733595",
                "0.5510507274207506222889862627164055758710",
                "0.5533432712254230408323485598582102158938",
                "0.5556653125394764283470780949074022134092",
                "0.5580174942825199370072537488886306063409",
                "0.5604004792408071646289763636143330635344",
                "0.5628149508653779258412328988530544622936",
                "0.5652616141098034354106810527612215666231",
                "0.5677411963098809125007175105809071616416",
                "0.5702544481077855671604754259562762117521",
                "0.5728021444233626789205490234594618878845",
                "0.5753850854754311631290998958000326739440",
                "0.5780040978561738982844247535692882389352",
                "0.5806600356619105378820956724227120541627",
                "0.5833537816837870740699199230591290043940",
                "0.5860862486621747343907998516092984605601",
                "0.5888583806088507272794581028356246387990",
                "0.5916711542013369503023235296806910008558",
                "0.5945255802541022966395626174934494285658",
                "0.5974227052716921401630060996936009289527",
                "0.6003636130892377171647692681303436526148",
                "0.6033494266062215243013240569067550690660",
                "0.6063813096198359263875211267632183426814",
                "0.6094604687647747019802304289382811864892",
                "0.6125881555668454624738124053872219330191",
                "0.6157656686183894534486799716037946035079",
                "0.6189943558841494157384105090614156019725",
                "0.6222756171469417858037479271083838339085",
                "0.6256109066032730735373164869342043765759",
                "0.6290017356198990680442742828388423220457",
                "0.6324496756632677620729780926763828475076",
                "0.6359563614148217204070028512110199361791",
                "0.6395234940862733401610571454303300125849",
                "0.6431528449502186352291962059960915721971",
                "0.6468462591028348535138369991814830075230",
                "0.6506056594769290944452202205225472642325",
                "0.6544330511252857206744444895426947819058",
                "0.6583305257961185022572312076227644865503",
                "0.6623002668244903239776523976944977549767",
                "0.6663445543658429995235097575674374028762",
                "0.6704657710003096083356707152548851572205",
                "0.6746664077392928975615335415921562649925",
                "0.6789490704689210984194656328487311630432",
                "0.6833164868684774190637730260145786125798",
                "0.6877715138457877038610422962051229000259",
                "0.6923171455358952034817597790648306065610",
                "0.6969565219142127755080084744324641342556",
                "0.7016929380807908798790381889136640881629",
                "0.7065298542784547514915785379489219452597",
                "0.7114709067144387589037448068928027920301",
                "0.7165199192628872651045202666728918322730",
                "0.7216809161343233038627258511339492696556",
                "0.7269581356080530023946272582673220074051",
                "0.7323560449346423257412916651387576173333",
                "0.7378793565282685388684821572730866637803",
                "0.7435330455831397853008651666807212733148",
                "0.7493223692645593896940915420678878505225",
                "0.7552528876439003831700732914828497725207",
                "0.7613304865681192577003895188072929219784",
                "0.7675614026789114008809156715330929399387",
                "0.7739522508247090710973182010043930802288",
                "0.7805100541410571472770489755220178038632",
                "0.7872422771121991533189649265415546548108",
                "0.7941568619698336043066964454600336004519",
                "0.8012622688349966948710312272190521597353",
                "0.8085675200671381812469705487325273644759",
                "0.8160822493521843899314635484543452372502",
                "0.8238167561405402413836354864566524563836",
                "0.8317820661387719067543510193292719962126",
                "0.8399899986678123413358251682688170245483",
                "0.8484532418292170492531612865217688243869",
                "0.8571854365732827141337583875457245505393",
                "0.8662012709436729269158699486362381355022",
                "0.8755165859886912881260756635340195483646",
                "0.8851484950871040374071419927404806106093",
                "0.8951155187459299518522045597573184008295",
                "0.9054377373007842879671591986996544887822",
                "0.9161369644011859410006444048174976232846",
                "0.9272369447127202365553993149049613144442",
                "0.9387635799393125201516485188174252523966",
                "0.9507451880931470339101474890781705871340",
                "0.9632128019569778973801224582681438941011",
                "0.9762005139456468330192306456341944873472",
                "0.9897458761483681981640976619512694506023",
                "1.003890366309983159200366599033508186874",
                "1.018679933006156206673666921948332671513",
                "1.034165636442310997560557406703997171325",
                "1.050404405371665445969962294375484231518",
                "1.067459935872995747175247877857406645986",
                "1.085403764550017059523667424014996718234",
                "1.104316557660372407360532879884443725054",
                "1.124289669521413018252678053984863984915",
                "1.145427039359732012349036379261188289733",
                "1.167847517129878574684334559323008027609",
                "1.191687737986230995280175540942983481716",
                "1.217105705378768709093384540830677508148",
                "1.244285299130520995334386949303841940309",
                "1.273442004891368949163519445837629156313",
                "1.304830276716713842317472202537926299540",
                "1.338753113570048027480913380698348512742",
                "1.375574682864915459752475703197893747361",
                "1.415737208425956198892165965423613532473",
                "1.459783938678718417913112898465160565544",
                "1.508390966318892902982634129425416295098",
                "1.562412239322241076670658968084044747811",
                "1.622944760954741603710555258247964135990",
                "1.691425644502004606860765492404867798806",
                "1.769781233475969665870651165674537083809",
                "1.860664911836072739043218447248966496025",
                "1.967853602214696611449820735115032303059",
                "2.096945603784697201241948157208851752056",
                "2.256674414710741256710499684941067386284",
                "2.461605753491579880711829077171714192593",
                "2.738352819152779967041632991033763661627",
                "3.142453622443274381631419018198184552488",
                "3.817599906505218640221138189610972753222",
                "5.334144700788700541592419802683252100729",
                ddouble.PositiveInfinity
            };

            const double m = -0.5;

            for ((int i, double n) = (0, -16); i < expecteds.Length; i++, n += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(n);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void IncompEllipticFTest() {
            HPAssert.AreEqual("0.2506474362662866035530540133777640230902", ddouble.EllipticF(0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2513040086544925794134591303987751449373", ddouble.EllipticF(0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5050887275786480788831082896236055222278", ddouble.EllipticF(0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.5104671356280047563361040911115799362540", ddouble.EllipticF(0.5, 0.5), 1e-30);
        }

        [TestMethod]
        public void IncompEllipticETest() {
            HPAssert.AreEqual("0.2493555587876163503851462800891098248369", ddouble.EllipticE(0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2487081058046058223763081867139695534492", ddouble.EllipticE(0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.4950017030164151928870375499599796260010", ddouble.EllipticE(0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.4899109597925171552108607317418823427392", ddouble.EllipticE(0.5, 0.5), 1e-30);
        }

        [TestMethod]
        public void IncompEllipticPiTest() {
            HPAssert.AreEqual("0.2512963700347440990856202815164922658139", ddouble.EllipticPi(0.125, 0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2519559961634921785098113692037503925298", ddouble.EllipticPi(0.125, 0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5102226593583425038841480467872258270987", ddouble.EllipticPi(0.125, 0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.5156986389890165328218962101195858179987", ddouble.EllipticPi(0.125, 0.5, 0.5), 1e-30);
            HPAssert.AreEqual("0.2519513603223101654980384692723856596327", ddouble.EllipticPi(0.25, 0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2526140741318178608951800063127917558966", ddouble.EllipticPi(0.25, 0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5155452979192924731104300897370205260060", ddouble.EllipticPi(0.25, 0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.5211231226642416591338219890234919559207", ddouble.EllipticPi(0.25, 0.5, 0.5), 1e-30);
            HPAssert.AreEqual("0.2532799189809456359052213341202224845743", ddouble.EllipticPi(0.5, 0.25, 0.25), 1e-30);
            HPAssert.AreEqual("0.2539489124677518319918153736199858971238", ddouble.EllipticPi(0.5, 0.25, 0.5), 1e-30);
            HPAssert.AreEqual("0.5268086118981364167278162005049954648917", ddouble.EllipticPi(0.5, 0.5, 0.25), 1e-30);
            HPAssert.AreEqual("0.5326042322277693780755771455389210311823", ddouble.EllipticPi(0.5, 0.5, 0.5), 1e-30);
        }

        [TestMethod]
        public void EllipticTheta1Test() {
            ddouble[] q0p25_expecteds = {
                "1.022538372271939697728117113333138510227",
                "0.9496984022249584205164784744142765440034",
                "0.8750581662231584721838383572800309659675",
                "0.7992424879966870335186982729110521387358",
                "0.7228012113428665813095967416962052829969",
                "0.6461987330116399286389553581494857443519",
                "0.5698069902635615583224200975155597836369",
                "0.4939020530596588057079799146194938489952",
                "0.4186643449941672143557123638400412836791",
                "0.3441823963417839779374617182479042584791",
                "0.2704599204356651856833303644258306978387",
                "0.1974259037079573987821651993068181604034",
                "0.1249473120374456609824306673713713777413",
                "0.05284394281290403962048994017925209400072",
                "-0.01909510595055617477324175708778978346620",
                "-0.09109392068491590997700368106509172682452",
                "-0.1633718097717045823864963352850183867793",
                "-0.2361255031362056031890452391367644736231",
                "-0.3095121194680329031446794992241970532424",
                "-0.3836334869140959464545817976822373509409",
                "-0.4585223678166141316416472533594170064929",
                "-0.5341310872405078174566800317779794551288",
                "-0.6103229988497102981984285331164772172164",
                "-0.6868671406631068542599257355494208675557",
                "-0.7634363383301312942927003935869704654076",
                "-0.8396089064103345398491498484852889347668",
                "-0.9148739810431909981400816745044916698539",
                "-0.9886403934605483980443406013883369624845",
                "-1.060248866903733436791334806690766776711",
                "-1.128987194223193524121918255187889140658",
                "-1.194107934837950517531911522972435366063",
                "-1.254848063164486003473640877945805960954",
                "-1.310449911410402785507427238278344295203",
                "-1.360182682720133006374777728106745747236",
                "-1.403363770293654845022723017410089477840",
                "-1.439379107461587095124543384752160894059",
                "-1.467701794645843170105070934031917561839",
                "-1.487908301977540995026047836116524772545",
                "-1.499691629741930464462358553305119794164",
                "-1.502870919775250655382656485327554525950",
                "-1.497397144907384728542935166110035833304",
                "-1.483354654662189928518840678310341215361",
                "-1.460958516828403746956381532535716998903",
                "-1.430547758725345280624117424787713339555",
                "-1.392574771369936600671017577493365172216",
                "-1.347591286951601526014226643953934909202",
                "-1.296231468403258082799886637079166756401",
                "-1.239192753878409373973402445243684233722",
                "-1.177215174455703996593101609580943996580",
                "-1.111059907828578528239156955971680375401",
                "-1.041487843201766038739317889862814229546",
                "-0.9692389138463596776219818856389983483883",
                "-0.8950129059930309805998480403800201011907",
                "-0.8194523794643851606664199015210689840012",
                "-0.7431282411218675829949260746451720640136",
                "-0.6665284019146774800862330244477252171473",
                "-0.5900498274278386753540843704877258262030",
                "-0.5139941656383632862405102990199477110236",
                "-0.4385670090638149632392278433269471924979",
                "-0.3638807260211158618680543491249481922272",
                "-0.2899606809846627430406222664817014074801",
                "-0.2167545599381755773894003544384484739055",
                "-0.1441444252760237891233970081160972365470",
                "-0.07196104764808517131101745529255549493884",
                "0",
                "0.07196104764808517131101745529255549493884",
                "0.1441444252760237891233970081160972365470",
                "0.2167545599381755773894003544384484739055",
                "0.2899606809846627430406222664817014074801",
                "0.3638807260211158618680543491249481922272",
                "0.4385670090638149632392278433269471924979",
                "0.5139941656383632862405102990199477110236",
                "0.5900498274278386753540843704877258262030",
                "0.6665284019146774800862330244477252171473",
                "0.7431282411218675829949260746451720640136",
                "0.8194523794643851606664199015210689840012",
                "0.8950129059930309805998480403800201011907",
                "0.9692389138463596776219818856389983483883",
                "1.041487843201766038739317889862814229546",
                "1.111059907828578528239156955971680375401",
                "1.177215174455703996593101609580943996580",
                "1.239192753878409373973402445243684233722",
                "1.296231468403258082799886637079166756401",
                "1.347591286951601526014226643953934909202",
                "1.392574771369936600671017577493365172216",
                "1.430547758725345280624117424787713339555",
                "1.460958516828403746956381532535716998903",
                "1.483354654662189928518840678310341215361",
                "1.497397144907384728542935166110035833304",
                "1.502870919775250655382656485327554525950",
                "1.499691629741930464462358553305119794164",
                "1.487908301977540995026047836116524772545",
                "1.467701794645843170105070934031917561839",
                "1.439379107461587095124543384752160894059",
                "1.403363770293654845022723017410089477840",
                "1.360182682720133006374777728106745747236",
                "1.310449911410402785507427238278344295203",
                "1.254848063164486003473640877945805960954",
                "1.194107934837950517531911522972435366063",
                "1.128987194223193524121918255187889140658",
                "1.060248866903733436791334806690766776711",
                "0.9886403934605483980443406013883369624845",
                "0.9148739810431909981400816745044916698539",
                "0.8396089064103345398491498484852889347668",
                "0.7634363383301312942927003935869704654076",
                "0.6868671406631068542599257355494208675557",
                "0.6103229988497102981984285331164772172164",
                "0.5341310872405078174566800317779794551288",
                "0.4585223678166141316416472533594170064929",
                "0.3836334869140959464545817976822373509409",
                "0.3095121194680329031446794992241970532424",
                "0.2361255031362056031890452391367644736231",
                "0.1633718097717045823864963352850183867793",
                "0.09109392068491590997700368106509172682452",
                "0.01909510595055617477324175708778978346620",
                "-0.05284394281290403962048994017925209400072",
                "-0.1249473120374456609824306673713713777413",
                "-0.1974259037079573987821651993068181604034",
                "-0.2704599204356651856833303644258306978387",
                "-0.3441823963417839779374617182479042584791",
                "-0.4186643449941672143557123638400412836791",
                "-0.4939020530596588057079799146194938489952",
                "-0.5698069902635615583224200975155597836369",
                "-0.6461987330116399286389553581494857443519",
                "-0.7228012113428665813095967416962052829969",
                "-0.7992424879966870335186982729110521387358",
                "-0.8750581662231584721838383572800309659675",
                "-0.9496984022249584205164784744142765440034",
                "-1.022538372271939697728117113333138510227"
            };
            ddouble[] q0p50_expecteds = {
                "1.023306324941662720259034544927086879794",
                "0.8945942252267372056419921209898340012426",
                "0.7731185063713244241312073991609252319934",
                "0.6603663929002753747796634229089207399108",
                "0.5573143270233383926263150128335555148536",
                "0.4644501288757494062405537042147574175211",
                "0.3818137787012145821123404455120433553510",
                "0.3090508613237445368276210367279908776532",
                "0.2454727832990233332721715178366204700887",
                "0.1901184772869498698580646944272761311997",
                "0.1418133220427198384696757956690483093672",
                "0.09922228433185862616442783349197238170069",
                "0.06089568087197479384670512166400736941882",
                "0.02530732298774776604757055709859028981706",
                "-0.009113978470734661058015201906928759751371",
                "-0.04395760361330960797045826051120321580314",
                "-0.08080641825189469129987168321046629852437",
                "-0.1212113000490767808567929579052675231238",
                "-0.1666621255743393510127288116615544271725",
                "-0.2185529273421967451218258472070342663751",
                "-0.2781397539246299895648140079686264998406",
                "-0.3464908753934609175041858269178500036273",
                "-0.4244302845776372222677647423177396942124",
                "-0.5124768402642943180458017672673856456673",
                "-0.6107827482166255482406759616131085432045",
                "-0.7190762323596110039351605518811329134775",
                "-0.8366140620056224036031202960977281978631",
                "-0.9621499349629244484358554989131284665461",
                "-1.093924465040756156941043468284216665179",
                "-1.229681628746465865729790758364226871010",
                "-1.366714996484516665139513000665608202187",
                "-1.501944987926516201385905879335627168145",
                "-1.632025902952598833772353216268208997235",
                "-1.753478807052927497608049664324943464060",
                "-1.862843757339473376300554085681987017407",
                "-1.956842624080185774718315056856849998813",
                "-2.032542158879105265581365982894486117253",
                "-2.087506199792233178724699584164825724886",
                "-2.119926120057565705034541788938352610153",
                "-2.128719851711914474574610636747878609885",
                "-2.113591966423461380669048579161817901843",
                "-2.075050184183996221530950766778208002319",
                "-2.014377029289416295742558565969251141425",
                "-1.933558830006602858854311633937716769354",
                "-1.835177515646568687105190938264982798566",
                "-1.722273381221100701435736782874922764374",
                "-1.598188909226213990975513362068994724343",
                "-1.466404698334242743884148701397233297392",
                "-1.330378498179274650272750199052730280059",
                "-1.193397347884310563390937552052832773417",
                "-1.058451021927110111368769922709421482653",
                "-0.9281326325255856852959286727538660626850",
                "-0.8045695964998140259050663441936519666884",
                "-0.6893855266678345794253368049814091243963",
                "-0.5836912075658624627422646776605528973223",
                "-0.4881008652858785951096468310049160826741",
                "-0.4027685758548143148263943214106828287860",
                "-0.3274389356018469228312709161865238072092",
                "-0.2615060288874875676824117769984320915452",
                "-0.2040752017574485617775856931948785789519",
                "-0.1540230688155610552510349122197994458164",
                "-0.1100524031447811903190739297770689166798",
                "-0.07073993500130358937586457111411682796926",
                "-0.03457646965399545587152399749729098597071",
                "0",
                "0.03457646965399545587152399749729098597071",
                "0.07073993500130358937586457111411682796926",
                "0.1100524031447811903190739297770689166798",
                "0.1540230688155610552510349122197994458164",
                "0.2040752017574485617775856931948785789519",
                "0.2615060288874875676824117769984320915452",
                "0.3274389356018469228312709161865238072092",
                "0.4027685758548143148263943214106828287860",
                "0.4881008652858785951096468310049160826741",
                "0.5836912075658624627422646776605528973223",
                "0.6893855266678345794253368049814091243963",
                "0.8045695964998140259050663441936519666884",
                "0.9281326325255856852959286727538660626850",
                "1.058451021927110111368769922709421482653",
                "1.193397347884310563390937552052832773417",
                "1.330378498179274650272750199052730280059",
                "1.466404698334242743884148701397233297392",
                "1.598188909226213990975513362068994724343",
                "1.722273381221100701435736782874922764374",
                "1.835177515646568687105190938264982798566",
                "1.933558830006602858854311633937716769354",
                "2.014377029289416295742558565969251141425",
                "2.075050184183996221530950766778208002319",
                "2.113591966423461380669048579161817901843",
                "2.128719851711914474574610636747878609885",
                "2.119926120057565705034541788938352610153",
                "2.087506199792233178724699584164825724886",
                "2.032542158879105265581365982894486117253",
                "1.956842624080185774718315056856849998813",
                "1.862843757339473376300554085681987017407",
                "1.753478807052927497608049664324943464060",
                "1.632025902952598833772353216268208997235",
                "1.501944987926516201385905879335627168145",
                "1.366714996484516665139513000665608202187",
                "1.229681628746465865729790758364226871010",
                "1.093924465040756156941043468284216665179",
                "0.9621499349629244484358554989131284665461",
                "0.8366140620056224036031202960977281978631",
                "0.7190762323596110039351605518811329134775",
                "0.6107827482166255482406759616131085432045",
                "0.5124768402642943180458017672673856456673",
                "0.4244302845776372222677647423177396942124",
                "0.3464908753934609175041858269178500036273",
                "0.2781397539246299895648140079686264998406",
                "0.2185529273421967451218258472070342663751",
                "0.1666621255743393510127288116615544271725",
                "0.1212113000490767808567929579052675231238",
                "0.08080641825189469129987168321046629852437",
                "0.04395760361330960797045826051120321580314",
                "0.009113978470734661058015201906928759751371",
                "-0.02530732298774776604757055709859028981706",
                "-0.06089568087197479384670512166400736941882",
                "-0.09922228433185862616442783349197238170069",
                "-0.1418133220427198384696757956690483093672",
                "-0.1901184772869498698580646944272761311997",
                "-0.2454727832990233332721715178366204700887",
                "-0.3090508613237445368276210367279908776532",
                "-0.3818137787012145821123404455120433553510",
                "-0.4644501288757494062405537042147574175211",
                "-0.5573143270233383926263150128335555148536",
                "-0.6603663929002753747796634229089207399108",
                "-0.7731185063713244241312073991609252319934",
                "-0.8945942252267372056419921209898340012426",
                "-1.023306324941662720259034544927086879794"
            };
            ddouble[] q0p75_expecteds = {
                "0.5662164511754189922388852814743050138445",
                "0.4098780757125622411410272790180461753252",
                "0.2887572225146096785832418698875415154543",
                "0.1979779884738560827728432372238272014143",
                "0.1321011320825183463382825062313874984632",
                "0.08578286803290374824172734780198351041628",
                "0.05421186097521619030280146165788859513194",
                "0.03334030378345337289242642272484315346392",
                "0.01995054636982471571534251807526825781958",
                "0.01160833185552693162048499261043386656083",
                "0.006551071268280818370044191076996169455884",
                "0.003549673756990963858260101444897382752090",
                "0.001769774751291093937744434820155721919708",
                "0.0006460358612481955565585131614165758637486",
                "-0.0002266670962978726837493977539990287694785",
                "-0.001188290034709889129428702545011562467885",
                "-0.002602152560692884583694464317495455236060",
                "-0.004945870335847074166865093707488866945159",
                "-0.008913008023969248590572257952666184356545",
                "-0.01553084132871981716649802872246116689902",
                "-0.02629403362970546008006708717498969665900",
                "-0.04330552464482167531042109469803957884929",
                "-0.06940470199032228500524280065929463799138",
                "-0.1082501734961049787730911184798490487013",
                "-0.1643127505482027016535591512170253868054",
                "-0.2427275904998194720778396583754738850871",
                "-0.3489577233144051290317978000889762041284",
                "-0.4882389499905715871473116507901987764610",
                "-0.6648107093445602407608747397726561520144",
                "-0.8809871543205385897550316991038165495297",
                "-1.136179981082939783627426500389310348669",
                "-1.426036620498350323991820245851286014994",
                "-1.741887939517839737567584952776671532667",
                "-2.070693092159118131767668829556534424680",
                "-2.395616224900909964911399700239081213894",
                "-2.697272008893434795771111299469247994520",
                "-2.955549475658348401289224707420456253677",
                "-3.151793174749836132445419774343665414725",
                "-3.271019824523237509600798527152772266166",
                "-3.303806706083896109422868466893129838888",
                "-3.247521785216330616393466701586104336663",
                "-3.106672724341828014929339798396819814322",
                "-2.892310567983280116706095574258828679910",
                "-2.620597563987362654486098628222799654247",
                "-2.310796654708658631246201608221057909940",
                "-1.983029230647091366553396102503727577059",
                "-1.656160759125435027871348354084055808032",
                "-1.346114037816902487903359100866968037694",
                "-1.064797946140906687892934891435058382484",
                "-0.8197068126599626412020512053568064124581",
                "-0.6141237197194452467065982059863224247380",
                "-0.4477743197940752213758783599334851885272",
                "-0.3177374925769133427225779296763821427229",
                "-0.2194237642735937835525451569272612225906",
                "-0.1474702997649607708721663912286008303712",
                "-0.09645624283637873684085767703507268615165",
                "-0.06139849881115177755089303557191453029647",
                "-0.03803418348230937493185109539251986381975",
                "-0.02292607089810340699591881010473459547159",
                "-0.01344093273555739281600467769024295048220",
                "-0.007650813868552959210706365912526297712290",
                "-0.004198830319083788887817263009423386282450",
                "-0.002158755328435923010991796349182672475676",
                "-0.0009051221071509225863101553743396697696955",
                "0",
                "0.0009051221071509225863101553743396697696955",
                "0.002158755328435923010991796349182672475676",
                "0.004198830319083788887817263009423386282450",
                "0.007650813868552959210706365912526297712290",
                "0.01344093273555739281600467769024295048220",
                "0.02292607089810340699591881010473459547159",
                "0.03803418348230937493185109539251986381975",
                "0.06139849881115177755089303557191453029647",
                "0.09645624283637873684085767703507268615165",
                "0.1474702997649607708721663912286008303712",
                "0.2194237642735937835525451569272612225906",
                "0.3177374925769133427225779296763821427229",
                "0.4477743197940752213758783599334851885272",
                "0.6141237197194452467065982059863224247380",
                "0.8197068126599626412020512053568064124581",
                "1.064797946140906687892934891435058382484",
                "1.346114037816902487903359100866968037694",
                "1.656160759125435027871348354084055808032",
                "1.983029230647091366553396102503727577059",
                "2.310796654708658631246201608221057909940",
                "2.620597563987362654486098628222799654247",
                "2.892310567983280116706095574258828679910",
                "3.106672724341828014929339798396819814322",
                "3.247521785216330616393466701586104336663",
                "3.303806706083896109422868466893129838888",
                "3.271019824523237509600798527152772266166",
                "3.151793174749836132445419774343665414725",
                "2.955549475658348401289224707420456253677",
                "2.697272008893434795771111299469247994520",
                "2.395616224900909964911399700239081213894",
                "2.070693092159118131767668829556534424680",
                "1.741887939517839737567584952776671532667",
                "1.426036620498350323991820245851286014994",
                "1.136179981082939783627426500389310348669",
                "0.8809871543205385897550316991038165495297",
                "0.6648107093445602407608747397726561520144",
                "0.4882389499905715871473116507901987764610",
                "0.3489577233144051290317978000889762041284",
                "0.2427275904998194720778396583754738850871",
                "0.1643127505482027016535591512170253868054",
                "0.1082501734961049787730911184798490487013",
                "0.06940470199032228500524280065929463799138",
                "0.04330552464482167531042109469803957884929",
                "0.02629403362970546008006708717498969665900",
                "0.01553084132871981716649802872246116689902",
                "0.008913008023969248590572257952666184356545",
                "0.004945870335847074166865093707488866945159",
                "0.002602152560692884583694464317495455236060",
                "0.001188290034709889129428702545011562467885",
                "0.0002266670962978726837493977539990287694785",
                "-0.0006460358612481955565585131614165758637486",
                "-0.001769774751291093937744434820155721919708",
                "-0.003549673756990963858260101444897382752090",
                "-0.006551071268280818370044191076996169455884",
                "-0.01160833185552693162048499261043386656083",
                "-0.01995054636982471571534251807526825781958",
                "-0.03334030378345337289242642272484315346392",
                "-0.05421186097521619030280146165788859513194",
                "-0.08578286803290374824172734780198351041628",
                "-0.1321011320825183463382825062313874984632",
                "-0.1979779884738560827728432372238272014143",
                "-0.2887572225146096785832418698875415154543",
                "-0.4098780757125622411410272790180461753252",
                "-0.5662164511754189922388852814743050138445"
            };
            ddouble[] q0p875_expecteds = {
                "0.1084446258266400260222321820303820496531",
                "0.05406095446856841420980375314389109400808",
                "0.02541851561945057812659646941793499837828",
                "0.01127216826262619543010707708005664947598",
                "0.004714716055579502144741827669365483570605",
                "0.001859920681056521325439553286661858860008",
                "0.0006920287003301163590898915019492841895855",
                "0.0002428536245340931370662656748360119692878",
                "0.00008038145370506224850772011218886600628068",
                "0.00002509328820824362508953576778469154230793",
                "7.388282181710725508537387826021661717577e-6",
                "2.051137654624715474429489292244349965568e-6",
                "5.341408692384046836016984621269452507740e-7",
                "1.174532521400707766619309224232244495855e-7",
                "-3.659785860170662262015545195174467950295e-8",
                "-2.741712012811355926650468708851045524268e-7",
                "-1.101150236312132368813168262997130517352e-6",
                "-4.080437547753729330930415712035149552064e-6",
                "-0.00001424490046716817520932520963817895300588",
                "-0.00004690040612870026364178335399371051037266",
                "-0.0001456408484639994667865320539789027290232",
                "-0.0004265603907138697320046056686315232242844",
                "-0.001178334649469487011693526316382559109602",
                "-0.003070065016803419308093844068024644193592",
                "-0.007544271322325030032473313075247509520492",
                "-0.01748549078756327103965766650388623784768",
                "-0.03822338599230938058052453063093975514544",
                "-0.07880817803003923341225863320441219158997",
                "-0.1532513185663892578711809520825561431343",
                "-0.2810787116360424538502788454889858697174",
                "-0.4862308277004486479873402395721105116208",
                "-0.7933189491475125213569591303588402380006",
                "-1.220798444576450361567218299926659210038",
                "-1.771866137296500538288480418605068442542",
                "-2.425541172275218836416193817175875538325",
                "-3.131678676850640587134067382816376060218",
                "-3.813612314079662929445295800300961708854",
                "-4.380126858940672641271380230901550973251",
                "-4.744906273487094120418072805624507880708",
                "-4.847964033141879636529505548807964616093",
                "-4.671775252490502125769866971060291799518",
                "-4.246149648208629849742487947852007164025",
                "-3.639983810084690711194936527843063225708",
                "-2.943028105696588075982741153280557578672",
                "-2.244296172788122328297393363573580225138",
                "-1.614197720857999511284600648477137155348",
                "-1.095025145974740596107861522283319108785",
                "-0.7006195579783828540501464653362885556209",
                "-0.4227963432873455809986066355744156152125",
                "-0.2406417571157572381588954553930398425375",
                "-0.1291818677071416669035837312598876048905",
                "-0.06540680424198296459392021471335407157969",
                "-0.03123453916072837356686347911207872099591",
                "-0.01406818519817088354211822142518378498449",
                "-0.005976292604049241596036306699278486919781",
                "-0.002394508760297531817693851017262097257827",
                "-0.0009048817085586345254567220933224060197127",
                "-0.0003225209941082004880416342979842223049352",
                "-0.0001084213881355640136947361628918452859154",
                "-0.00003437657289354783305778894778988554616762",
                "-0.00001028011474829274134758148871303518235766",
                "-2.899123573560170336673193029094650911412e-6",
                "-7.691970100818290159462811739771005137609e-7",
                "-1.833135858938972052786057818716301201469e-7",
                "0",
                "1.833135858938972052786057818716301201469e-7",
                "7.691970100818290159462811739771005137609e-7",
                "2.899123573560170336673193029094650911412e-6",
                "0.00001028011474829274134758148871303518235766",
                "0.00003437657289354783305778894778988554616762",
                "0.0001084213881355640136947361628918452859154",
                "0.0003225209941082004880416342979842223049352",
                "0.0009048817085586345254567220933224060197127",
                "0.002394508760297531817693851017262097257827",
                "0.005976292604049241596036306699278486919781",
                "0.01406818519817088354211822142518378498449",
                "0.03123453916072837356686347911207872099591",
                "0.06540680424198296459392021471335407157969",
                "0.1291818677071416669035837312598876048905",
                "0.2406417571157572381588954553930398425375",
                "0.4227963432873455809986066355744156152125",
                "0.7006195579783828540501464653362885556209",
                "1.095025145974740596107861522283319108785",
                "1.614197720857999511284600648477137155348",
                "2.244296172788122328297393363573580225138",
                "2.943028105696588075982741153280557578672",
                "3.639983810084690711194936527843063225708",
                "4.246149648208629849742487947852007164025",
                "4.671775252490502125769866971060291799518",
                "4.847964033141879636529505548807964616093",
                "4.744906273487094120418072805624507880708",
                "4.380126858940672641271380230901550973251",
                "3.813612314079662929445295800300961708854",
                "3.131678676850640587134067382816376060218",
                "2.425541172275218836416193817175875538325",
                "1.771866137296500538288480418605068442542",
                "1.220798444576450361567218299926659210038",
                "0.7933189491475125213569591303588402380006",
                "0.4862308277004486479873402395721105116208",
                "0.2810787116360424538502788454889858697174",
                "0.1532513185663892578711809520825561431343",
                "0.07880817803003923341225863320441219158997",
                "0.03822338599230938058052453063093975514544",
                "0.01748549078756327103965766650388623784768",
                "0.007544271322325030032473313075247509520492",
                "0.003070065016803419308093844068024644193592",
                "0.001178334649469487011693526316382559109602",
                "0.0004265603907138697320046056686315232242844",
                "0.0001456408484639994667865320539789027290232",
                "0.00004690040612870026364178335399371051037266",
                "0.00001424490046716817520932520963817895300588",
                "4.080437547753729330930415712035149552064e-6",
                "1.101150236312132368813168262997130517352e-6",
                "2.741712012811355926650468708851045524268e-7",
                "3.659785860170662262015545195174467950295e-8",
                "-1.174532521400707766619309224232244495855e-7",
                "-5.341408692384046836016984621269452507740e-7",
                "-2.051137654624715474429489292244349965568e-6",
                "-7.388282181710725508537387826021661717577e-6",
                "-0.00002509328820824362508953576778469154230793",
                "-0.00008038145370506224850772011218886600628068",
                "-0.0002428536245340931370662656748360119692878",
                "-0.0006920287003301163590898915019492841895855",
                "-0.001859920681056521325439553286661858860008",
                "-0.004714716055579502144741827669365483570605",
                "-0.01127216826262619543010707708005664947598",
                "-0.02541851561945057812659646941793499837828",
                "-0.05406095446856841420980375314389109400808",
                "-0.1084446258266400260222321820303820496531"
            };

            foreach ((ddouble q, ddouble[] expecteds) in new[] {
                (0.25, q0p25_expecteds),
                (0.5, q0p50_expecteds),
                (0.75, q0p75_expecteds),
                (0.875, q0p875_expecteds)
            }) {
                for ((int i, double x) = (0, -4); i < expecteds.Length; i++, x += 1d / 16) {
                    ddouble expected = expecteds[i];

                    ddouble y = ddouble.EllipticTheta1(x, q);

                    Console.WriteLine($"{x},{q}");
                    Console.WriteLine(y);

                    HPAssert.AreEqual(expected, y, ddouble.Abs(expected) * 1e-29);
                }
            }
        }

        [TestMethod]
        public void EllipticTheta2Test() {
            ddouble[] q0p25_expecteds = {
                "-0.8496640003945926433664380997241535525637",
                "-0.9247657864387064697864545275223831896679",
                "-0.9982850160054855607924648640448634952712",
                "-1.069554452734423158275029888884502433256",
                "-1.137856145300124351524089333439300018900",
                "-1.202439418237799848898295997165486055895",
                "-1.262540731711598354507281772621741569053",
                "-1.317404742854875113447491403059279553031",
                "-1.366305837702380577024553871222265191806",
                "-1.408569366157176508087889288127295112561",
                "-1.443591805914912957267850883646962350366",
                "-1.470859106465151442404469070620956694587",
                "-1.489962521301601159556020351080462299088",
                "-1.500611323736968790552807948780044023554",
                "-1.502641916021110165779448874170935203175",
                "-1.496022978069477897839028387534687304663",
                "-1.480856455004511757041549286720359571930",
                "-1.457374344925027949157287155877554252830",
                "-1.425931412327046985453977025988364582718",
                "-1.386994110776591483578173789819495346874",
                "-1.341126143498760726168340820909227184070",
                "-1.288971215986831570121829217375183224644",
                "-1.231233635178360326024847612757804854312",
                "-1.168657481243383967556067941361901664572",
                "-1.102005118237324472232878833599373664257",
                "-1.032035818112489965039871865111006233663",
                "-0.9594852498035732593915740752235805421031",
                "-0.8850465337192685037219982598455460502008",
                "-0.8093534856258851374280273584695740875568",
                "-0.7329665771622223182567746642948447119058",
                "-0.6563620282191041125701095351060371055859",
                "-0.5799243245228704997931410144328074020088",
                "-0.5039423272540217307923050749232259893980",
                "-0.4286090153076993100748532104262969215911",
                "-0.3540247791682140889835369638747170220393",
                "-0.2802040719031533809430200670608601324177",
                "-0.2070851202752952203542921289608298038533",
                "-0.1345423094459348052986947293706105251851",
                "-0.06240077953765452487758525970244846765998",
                "0.009547287785309066505128075170543383866379",
                "0.08152525920628325275825797710332999715910",
                "0.1537541116676976726071349469962847713497",
                "0.2264345753466775737998642110845725672661",
                "0.2997299646724211673432078275509511008577",
                "0.3737502867415500859684495062864928986467",
                "0.4485381832834583548073188175429637151620",
                "0.5240572135577564657145508172437352103641",
                "0.6001829213984656348227165377301797947567",
                "0.6766970505164353276225886411832708544607",
                "0.7532851790435820624311401555204056001988",
                "0.8295379386578445493030624807405074630521",
                "0.9049558676878930463378281733974064069008",
                "0.9789578243631101676223291527859309701086",
                "1.050892759627263939799059114019513738212",
                "1.120054523153711930484621144730960024770",
                "1.185699256407351724548251423129561236342",
                "1.247064818123407297291168463026530614292",
                "1.303391595758721633769155195959569911651",
                "1.353943986339306439424869109596428893107",
                "1.398031786029028620051815644096245041049",
                "1.435030713022287745517709318392251564096",
                "1.464401305063797505685415584144242523370",
                "1.485705481547806223423243622114351743901",
                "1.498620139628391390383226702275825386208",
                "1.502947261299397976017045248185406443524",
                "1.498620139628391390383226702275825386208",
                "1.485705481547806223423243622114351743901",
                "1.464401305063797505685415584144242523370",
                "1.435030713022287745517709318392251564096",
                "1.398031786029028620051815644096245041049",
                "1.353943986339306439424869109596428893107",
                "1.303391595758721633769155195959569911651",
                "1.247064818123407297291168463026530614292",
                "1.185699256407351724548251423129561236342",
                "1.120054523153711930484621144730960024770",
                "1.050892759627263939799059114019513738212",
                "0.9789578243631101676223291527859309701086",
                "0.9049558676878930463378281733974064069008",
                "0.8295379386578445493030624807405074630521",
                "0.7532851790435820624311401555204056001988",
                "0.6766970505164353276225886411832708544607",
                "0.6001829213984656348227165377301797947567",
                "0.5240572135577564657145508172437352103641",
                "0.4485381832834583548073188175429637151620",
                "0.3737502867415500859684495062864928986467",
                "0.2997299646724211673432078275509511008577",
                "0.2264345753466775737998642110845725672661",
                "0.1537541116676976726071349469962847713497",
                "0.08152525920628325275825797710332999715910",
                "0.009547287785309066505128075170543383866379",
                "-0.06240077953765452487758525970244846765998",
                "-0.1345423094459348052986947293706105251851",
                "-0.2070851202752952203542921289608298038533",
                "-0.2802040719031533809430200670608601324177",
                "-0.3540247791682140889835369638747170220393",
                "-0.4286090153076993100748532104262969215911",
                "-0.5039423272540217307923050749232259893980",
                "-0.5799243245228704997931410144328074020088",
                "-0.6563620282191041125701095351060371055859",
                "-0.7329665771622223182567746642948447119058",
                "-0.8093534856258851374280273584695740875568",
                "-0.8850465337192685037219982598455460502008",
                "-0.9594852498035732593915740752235805421031",
                "-1.032035818112489965039871865111006233663",
                "-1.102005118237324472232878833599373664257",
                "-1.168657481243383967556067941361901664572",
                "-1.231233635178360326024847612757804854312",
                "-1.288971215986831570121829217375183224644",
                "-1.341126143498760726168340820909227184070",
                "-1.386994110776591483578173789819495346874",
                "-1.425931412327046985453977025988364582718",
                "-1.457374344925027949157287155877554252830",
                "-1.480856455004511757041549286720359571930",
                "-1.496022978069477897839028387534687304663",
                "-1.502641916021110165779448874170935203175",
                "-1.500611323736968790552807948780044023554",
                "-1.489962521301601159556020351080462299088",
                "-1.470859106465151442404469070620956694587",
                "-1.443591805914912957267850883646962350366",
                "-1.408569366157176508087889288127295112561",
                "-1.366305837702380577024553871222265191806",
                "-1.317404742854875113447491403059279553031",
                "-1.262540731711598354507281772621741569053",
                "-1.202439418237799848898295997165486055895",
                "-1.137856145300124351524089333439300018900",
                "-1.069554452734423158275029888884502433256",
                "-0.9982850160054855607924648640448634952712",
                "-0.9247657864387064697864545275223831896679",
                "-0.8496640003945926433664380997241535525637"
            };
            ddouble[] q0p50_expecteds = {
                "-0.7341681289319075389224533297427010511288",
                "-0.8528505216922431138189163625548363472010",
                "-0.9793268771658964763940953510995290060127",
                "-1.111770316660280076048762405055440394960",
                "-1.247861696327461572469993107773804185305",
                "-1.384839936012524207737296078252680699728",
                "-1.519583356224518176690080075723712950905",
                "-1.648720425102827844850497632014665687894",
                "-1.768765639432339931117504436074817338247",
                "-1.876273702779873695357506645861468023252",
                "-1.968003001317266184597290655203044538407",
                "-2.041077875079726918004823046257443245057",
                "-2.093138545632506828485366397190550804661",
                "-2.122467911969942576167862834799284447661",
                "-2.128085781204598695357110062659798566166",
                "-2.109803362580877669043594034150109945433",
                "-2.068233820294162704708682701558899553884",
                "-2.004758066288332388556853315830859408380",
                "-1.921448441884324329846664971278476399282",
                "-1.820956140055839314317574714813303770815",
                "-1.706370843766202106764715274446043996585",
                "-1.581062854860772814577923694360414916608",
                "-1.448518814566663875343688742020681937742",
                "-1.312181934045907098109843763708385853252",
                "-1.175306535697163462036226171192370016533",
                "-1.040834822854081855690377804089428145328",
                "-0.9113013867995167758519585155461114863340",
                "-0.7887683020337654390521344285873373916956",
                "-0.6747910319647778451765549688376762697436",
                "-0.5704130163865926470449487894435981634001",
                "-0.4761849335867863987806064382457488672882",
                "-0.3922033482732834315408521072662111549928",
                "-0.3181628216546235664110126719656872159114",
                "-0.2534155516972132185959642497222813941964",
                "-0.1970331513257084099859817748374309985589",
                "-0.1478661399059747547878755476072513162524",
                "-0.1045979749069927111003652718671796575402",
                "-0.06579183575139078762624508766544002388598",
                "-0.02992974758862643715103318960197180754030",
                "0.004555126315712105430191079929230517980652",
                "0.03925119044531605412410907372859520438428",
                "0.07574359556186982339397067223800748831964",
                "0.1155890324833975456316282869717677595944",
                "0.1602873349043965449152087367555415867361",
                "0.2112475158677827127883979543904400386561",
                "0.2697466436255199100615742544333586086338",
                "0.3368810383135708403328660669762807888253",
                "0.4135105585683167154800904803585113845042",
                "0.5001981385144562006186435586661642465206",
                "0.5971480996696044127469585873954732078623",
                "0.7041479531514130124906685335410443593619",
                "0.8205192749394658014421584165547056166348",
                "0.9450836415145918641119339523464150673739",
                "1.076149444076991719578347014125395722940",
                "1.211524592226485743658046463839445493541",
                "1.348558669948949340349700524771768697575",
                "1.484216087659583107499509464625356597655",
                "1.615179327916912327593578766460924034164",
                "1.737978719910626414766662507463024536754",
                "1.849142558343352612342822612821468609008",
                "1.945359087094512287818938605108992884434",
                "2.023640167136703636224613882397545215429",
                "2.081475565681532316327484820983232475819",
                "2.116966886017956843372731513000028200801",
                "2.128931250513027558591613402575350180854",
                "2.116966886017956843372731513000028200801",
                "2.081475565681532316327484820983232475819",
                "2.023640167136703636224613882397545215429",
                "1.945359087094512287818938605108992884434",
                "1.849142558343352612342822612821468609008",
                "1.737978719910626414766662507463024536754",
                "1.615179327916912327593578766460924034164",
                "1.484216087659583107499509464625356597655",
                "1.348558669948949340349700524771768697575",
                "1.211524592226485743658046463839445493541",
                "1.076149444076991719578347014125395722940",
                "0.9450836415145918641119339523464150673739",
                "0.8205192749394658014421584165547056166348",
                "0.7041479531514130124906685335410443593619",
                "0.5971480996696044127469585873954732078623",
                "0.5001981385144562006186435586661642465206",
                "0.4135105585683167154800904803585113845042",
                "0.3368810383135708403328660669762807888253",
                "0.2697466436255199100615742544333586086338",
                "0.2112475158677827127883979543904400386561",
                "0.1602873349043965449152087367555415867361",
                "0.1155890324833975456316282869717677595944",
                "0.07574359556186982339397067223800748831964",
                "0.03925119044531605412410907372859520438428",
                "0.004555126315712105430191079929230517980652",
                "-0.02992974758862643715103318960197180754030",
                "-0.06579183575139078762624508766544002388598",
                "-0.1045979749069927111003652718671796575402",
                "-0.1478661399059747547878755476072513162524",
                "-0.1970331513257084099859817748374309985589",
                "-0.2534155516972132185959642497222813941964",
                "-0.3181628216546235664110126719656872159114",
                "-0.3922033482732834315408521072662111549928",
                "-0.4761849335867863987806064382457488672882",
                "-0.5704130163865926470449487894435981634001",
                "-0.6747910319647778451765549688376762697436",
                "-0.7887683020337654390521344285873373916956",
                "-0.9113013867995167758519585155461114863340",
                "-1.040834822854081855690377804089428145328",
                "-1.175306535697163462036226171192370016533",
                "-1.312181934045907098109843763708385853252",
                "-1.448518814566663875343688742020681937742",
                "-1.581062854860772814577923694360414916608",
                "-1.706370843766202106764715274446043996585",
                "-1.820956140055839314317574714813303770815",
                "-1.921448441884324329846664971278476399282",
                "-2.004758066288332388556853315830859408380",
                "-2.068233820294162704708682701558899553884",
                "-2.109803362580877669043594034150109945433",
                "-2.128085781204598695357110062659798566166",
                "-2.122467911969942576167862834799284447661",
                "-2.093138545632506828485366397190550804661",
                "-2.041077875079726918004823046257443245057",
                "-1.968003001317266184597290655203044538407",
                "-1.876273702779873695357506645861468023252",
                "-1.768765639432339931117504436074817338247",
                "-1.648720425102827844850497632014665687894",
                "-1.519583356224518176690080075723712950905",
                "-1.384839936012524207737296078252680699728",
                "-1.247861696327461572469993107773804185305",
                "-1.111770316660280076048762405055440394960",
                "-0.9793268771658964763940953510995290060127",
                "-0.8528505216922431138189163625548363472010",
                "-0.7341681289319075389224533297427010511288"
            };
            ddouble[] q0p75_expecteds = {
                "-0.2551086367022416274990472479489148951630",
                "-0.3654376329017196397523256898013595170572",
                "-0.5094567524465951712650697542902225979397",
                "-0.6912057692968263329970088530900375976958",
                "-0.9126691522598420175841750551023561141969",
                "-1.172803834392808145887303268204048902836",
                "-1.466707021142751337886596021635349304354",
                "-1.785119743335677337999239530203329267097",
                "-2.114449534035182208313440488168322574844",
                "-2.437436351017510199376622421472667639753",
                "-2.734483026025575141316178526879966014140",
                "-2.985541886616069606995354445309527151615",
                "-3.172320765087842567879086888932037753384",
                "-3.280477081271587922606404033117285219423",
                "-3.301436211664695734985690679613277500937",
                "-3.233514417399510205508851023272444394919",
                "-3.082142268842621257779818446868486102758",
                "-2.859147428901289062192511784827169685969",
                "-2.581228234034675162007234009785161667690",
                "-2.267891391301070152865740239247117812346",
                "-1.939206627226242434331310087329783843821",
                "-1.613733852071441702578189032329572455064",
                "-1.306910119947962602301085236852402517041",
                "-1.030067111000506308313534498598235031199",
                "-0.7901168232865903425876338117539373248649",
                "-0.5898248749069987966733027733110857362369",
                "-0.4285098827287407135319068093552607092795",
                "-0.3029734464060186254393647317577129496089",
                "-0.2084751012771999378054481437476923552208",
                "-0.1396077307674218279887172116053035892394",
                "-0.09098491588803340148261593927200968162393",
                "-0.05770721242008613036961598588862026523961",
                "-0.03561855843362326966052139126123507819236",
                "-0.02139185751792894945775265375120430724088",
                "-0.01249432644916022221318560356557830169410",
                "-0.007081914960457034634810315713415384331374",
                "-0.003862877354225256449378664561869527158845",
                "-0.001958047542018576623462177226904716490334",
                "-0.0007729988271232422375410865135745679907918",
                "0.0001129510464694502153571489920439340173249",
                "0.001043258982457396937094209502274988498826",
                "0.002373052924937646325299506018033705326531",
                "0.004559231032083098227821428311562295158863",
                "0.008260292395920389723904767547068822542206",
                "0.01445182157434903700907857171438235139937",
                "0.02455833866494532857996096810891569036964",
                "0.04059411053342768838615028161863715726443",
                "0.06529461083837169384882740590418521193441",
                "0.1022076505694954003060724270208079675775",
                "0.1557011527817943973907142563503806710841",
                "0.2308369414857164578669877111961301471112",
                "0.3330615865312538819530194036640607563291",
                "0.4676809816944129993992187554074566200888",
                "0.6391177010102529049007267076728479157146",
                "0.8499981234374397303023859013302566167283",
                "1.100173235641830656589504135369968880884",
                "1.385830682370077279510297392956171283161",
                "1.698889991637687773848635438212356917515",
                "2.026872040682229946750112325678575389458",
                "2.353387241069025409661493086967215342088",
                "2.659294564296309159492271697413980445851",
                "2.924458654277308318153695884782856237194",
                "3.129900375529122432027257297863498600949",
                "3.260029509622238640520867855609022306995",
                "3.304597249065604318446236263667367078051",
                "3.260029509622238640520867855609022306995",
                "3.129900375529122432027257297863498600949",
                "2.924458654277308318153695884782856237194",
                "2.659294564296309159492271697413980445851",
                "2.353387241069025409661493086967215342088",
                "2.026872040682229946750112325678575389458",
                "1.698889991637687773848635438212356917515",
                "1.385830682370077279510297392956171283161",
                "1.100173235641830656589504135369968880884",
                "0.8499981234374397303023859013302566167283",
                "0.6391177010102529049007267076728479157146",
                "0.4676809816944129993992187554074566200888",
                "0.3330615865312538819530194036640607563291",
                "0.2308369414857164578669877111961301471112",
                "0.1557011527817943973907142563503806710841",
                "0.1022076505694954003060724270208079675775",
                "0.06529461083837169384882740590418521193441",
                "0.04059411053342768838615028161863715726443",
                "0.02455833866494532857996096810891569036964",
                "0.01445182157434903700907857171438235139937",
                "0.008260292395920389723904767547068822542206",
                "0.004559231032083098227821428311562295158863",
                "0.002373052924937646325299506018033705326531",
                "0.001043258982457396937094209502274988498826",
                "0.0001129510464694502153571489920439340173249",
                "-0.0007729988271232422375410865135745679907918",
                "-0.001958047542018576623462177226904716490334",
                "-0.003862877354225256449378664561869527158845",
                "-0.007081914960457034634810315713415384331374",
                "-0.01249432644916022221318560356557830169410",
                "-0.02139185751792894945775265375120430724088",
                "-0.03561855843362326966052139126123507819236",
                "-0.05770721242008613036961598588862026523961",
                "-0.09098491588803340148261593927200968162393",
                "-0.1396077307674218279887172116053035892394",
                "-0.2084751012771999378054481437476923552208",
                "-0.3029734464060186254393647317577129496089",
                "-0.4285098827287407135319068093552607092795",
                "-0.5898248749069987966733027733110857362369",
                "-0.7901168232865903425876338117539373248649",
                "-1.030067111000506308313534498598235031199",
                "-1.306910119947962602301085236852402517041",
                "-1.613733852071441702578189032329572455064",
                "-1.939206627226242434331310087329783843821",
                "-2.267891391301070152865740239247117812346",
                "-2.581228234034675162007234009785161667690",
                "-2.859147428901289062192511784827169685969",
                "-3.082142268842621257779818446868486102758",
                "-3.233514417399510205508851023272444394919",
                "-3.301436211664695734985690679613277500937",
                "-3.280477081271587922606404033117285219423",
                "-3.172320765087842567879086888932037753384",
                "-2.985541886616069606995354445309527151615",
                "-2.734483026025575141316178526879966014140",
                "-2.437436351017510199376622421472667639753",
                "-2.114449534035182208313440488168322574844",
                "-1.785119743335677337999239530203329267097",
                "-1.466707021142751337886596021635349304354",
                "-1.172803834392808145887303268204048902836",
                "-0.9126691522598420175841750551023561141969",
                "-0.6912057692968263329970088530900375976958",
                "-0.5094567524465951712650697542902225979397",
                "-0.3654376329017196397523256898013595170572",
                "-0.2551086367022416274990472479489148951630"
            };
            ddouble[] q0p875_expecteds = {
                "-0.01946373251681418205859499460405231254444",
                "-0.04221867593259219771439211860687257855809",
                "-0.08637218208163894693190608525435608758711",
                "-0.1666609972256968661308498362897161961685",
                "-0.3033086962577459828283803387085167183285",
                "-0.5206268357568438887328415317834000325925",
                "-0.8428669785339488298107033324811149558079",
                "-1.287011213083670201435766154555479060628",
                "-1.853516359311481262092794200850897247156",
                "-2.517684568215619549225131329681211103095",
                "-3.225499761201370703972524208137646683358",
                "-3.897476559051141614107589650437184004975",
                "-4.441818527582360437945654733933769705522",
                "-4.774511155345668675429996283740962090854",
                "-4.840473146531621106578877517566963458155",
                "-4.628470707705085865750773818645297156705",
                "-4.174245864912591479336068174923055519437",
                "-3.550662008991855315790211399890688476336",
                "-2.848599821522830725303514578415148631910",
                "-2.155481768192879404135569255809300787503",
                "-1.538324888396594001435871186892639208061",
                "-1.035482064401746130985359710823988520352",
                "-0.6573972710095813052535997236582458506265",
                "-0.3936443429523963197174814540013238887348",
                "-0.2223161096013900017779572286624524263886",
                "-0.1184209811344049554033000493812665766036",
                "-0.05949454912707108144963977144787146539424",
                "-0.02819139079819129708709906038025017073397",
                "-0.01259930612011921758949949026198355212867",
                "-0.005310893047974775603665275067196871434378",
                "-0.002111442626008322679477340456935077485801",
                "-0.0007917385945292476368302059951212229468202",
                "-0.0002800110355697152789062898759730629900496",
                "-0.00009340266520876399025326274525270034052448",
                "-0.00002938555887873309023402050137596342748903",
                "-8.719567855536551587553804408155160803020e-6",
                "-2.439843250952218137145638576952954451201e-6",
                "-6.415195529859945236361199719835615042853e-7",
                "-1.478607113708411659742853499224032803368e-7",
                "1.798358751978471278472303727319563272496e-8",
                "2.249699416565521518780778603582492477280e-7",
                "9.209360432432765457072809207065541963927e-7",
                "3.441231839455937067409405997242248288874e-6",
                "0.00001210745114419694549250401670892260552050",
                "0.00004017385042165584842132104083284704011935",
                "0.0001257253751950395846992061327542814922189",
                "0.0003711018468378037093146905581490594197570",
                "0.001033127892790126574028649097048092073508",
                "0.002712725560912369744947791470439272188935",
                "0.006718130470426463044553162921323464308174",
                "0.01569212683688305971924659998869235241291",
                "0.03457052599175492753007505765780165631538",
                "0.07183249753962998433818185974730112741308",
                "0.1407753927218829955313427793379303912400",
                "0.2602096090171641224065921700628812555129",
                "0.4536393446605941535193758766072305700474",
                "0.7459142435522683296843754935846738011873",
                "1.156798955519422219994768910848243859252",
                "1.692067473121266586469233658219244944566",
                "2.334362338526365925387805630484305515276",
                "3.037453656272422561526742318801170690586",
                "3.727707733145020662537929891975580958976",
                "4.314841533508412198855773262880240517315",
                "4.710626251459122284253889837496522094028",
                "4.850463570580107745475266242741610794778",
                "4.710626251459122284253889837496522094028",
                "4.314841533508412198855773262880240517315",
                "3.727707733145020662537929891975580958976",
                "3.037453656272422561526742318801170690586",
                "2.334362338526365925387805630484305515276",
                "1.692067473121266586469233658219244944566",
                "1.156798955519422219994768910848243859252",
                "0.7459142435522683296843754935846738011873",
                "0.4536393446605941535193758766072305700474",
                "0.2602096090171641224065921700628812555129",
                "0.1407753927218829955313427793379303912400",
                "0.07183249753962998433818185974730112741308",
                "0.03457052599175492753007505765780165631538",
                "0.01569212683688305971924659998869235241291",
                "0.006718130470426463044553162921323464308174",
                "0.002712725560912369744947791470439272188935",
                "0.001033127892790126574028649097048092073508",
                "0.0003711018468378037093146905581490594197570",
                "0.0001257253751950395846992061327542814922189",
                "0.00004017385042165584842132104083284704011935",
                "0.00001210745114419694549250401670892260552050",
                "3.441231839455937067409405997242248288874e-6",
                "9.209360432432765457072809207065541963927e-7",
                "2.249699416565521518780778603582492477280e-7",
                "1.798358751978471278472303727319563272496e-8",
                "-1.478607113708411659742853499224032803368e-7",
                "-6.415195529859945236361199719835615042853e-7",
                "-2.439843250952218137145638576952954451201e-6",
                "-8.719567855536551587553804408155160803020e-6",
                "-0.00002938555887873309023402050137596342748903",
                "-0.00009340266520876399025326274525270034052448",
                "-0.0002800110355697152789062898759730629900496",
                "-0.0007917385945292476368302059951212229468202",
                "-0.002111442626008322679477340456935077485801",
                "-0.005310893047974775603665275067196871434378",
                "-0.01259930612011921758949949026198355212867",
                "-0.02819139079819129708709906038025017073397",
                "-0.05949454912707108144963977144787146539424",
                "-0.1184209811344049554033000493812665766036",
                "-0.2223161096013900017779572286624524263886",
                "-0.3936443429523963197174814540013238887348",
                "-0.6573972710095813052535997236582458506265",
                "-1.035482064401746130985359710823988520352",
                "-1.538324888396594001435871186892639208061",
                "-2.155481768192879404135569255809300787503",
                "-2.848599821522830725303514578415148631910",
                "-3.550662008991855315790211399890688476336",
                "-4.174245864912591479336068174923055519437",
                "-4.628470707705085865750773818645297156705",
                "-4.840473146531621106578877517566963458155",
                "-4.774511155345668675429996283740962090854",
                "-4.441818527582360437945654733933769705522",
                "-3.897476559051141614107589650437184004975",
                "-3.225499761201370703972524208137646683358",
                "-2.517684568215619549225131329681211103095",
                "-1.853516359311481262092794200850897247156",
                "-1.287011213083670201435766154555479060628",
                "-0.8428669785339488298107033324811149558079",
                "-0.5206268357568438887328415317834000325925",
                "-0.3033086962577459828283803387085167183285",
                "-0.1666609972256968661308498362897161961685",
                "-0.08637218208163894693190608525435608758711",
                "-0.04221867593259219771439211860687257855809",
                "-0.01946373251681418205859499460405231254444"
            };

            foreach ((ddouble q, ddouble[] expecteds) in new[] {
                (0.25, q0p25_expecteds),
                (0.5, q0p50_expecteds),
                (0.75, q0p75_expecteds),
                (0.875, q0p875_expecteds)
            }) {
                for ((int i, double x) = (0, -4); i < expecteds.Length; i++, x += 1d / 16) {
                    ddouble expected = expecteds[i];

                    ddouble y = ddouble.EllipticTheta2(x, q);

                    Console.WriteLine($"{x},{q}");
                    Console.WriteLine(y);

                    HPAssert.AreEqual(expected, y, ddouble.Abs(expected) * 1e-29);
                }
            }
        }

        [TestMethod]
        public void EllipticTheta3Test() {
            ddouble[] q0p25_expecteds = {
                "0.9197715050231299817244838441702476254399",
                "0.9816864736308543826395098605647492157590",
                "1.044250669817903747165994282690791847342",
                "1.106480630546515036343001947209673140888",
                "1.167375934384488789550998022638572161913",
                "1.225936613528611528657532663328815832386",
                "1.281181831828946014083343506104401955470",
                "1.332169348636994973966915911179621460783",
                "1.378015207398028566226470264818362473948",
                "1.417913031596535466585274278348956854278",
                "1.451152283298117942040982667691202035285",
                "1.477134843809361190407083368866718077319",
                "1.495389312731716108530759546951215441119",
                "1.505582489791998500406243635405518018320",
                "1.507527600246728091386243758988544388049",
                "1.501188944581605044708701639964711278490",
                "1.486682790391987391838311009260402011781",
                "1.464274471381221476398616470689851251447",
                "1.434371807372348216003410772137340196044",
                "1.397515101995587094202296515885547798363",
                "1.354364103581248053912364270084850280893",
                "1.305682422924186553508492214370586961792",
                "1.252319983461273620258622940946027154861",
                "1.195194131122484925311413871114887329966",
                "1.135270050641925304593647144317329485025",
                "1.073541122365735950675903181216527142519",
                "1.011009810411640094616352726711651553117",
                "0.9486696030304009692439850716773546616036",
                "0.8874884343055736692418006742644281685924",
                "0.8283939091645981040080610632315777844947",
                "0.7722605380501758898446935630373516826290",
                "0.7198990707811816062665325661977272221908",
                "0.6720479082028979553377038151558442158087",
                "0.6293664716628576542523091789176368968927",
                "0.5924303296366901236327077930972812345797",
                "0.5617278221555681081346635399591069891506",
                "0.5376578897214946574426634021956417243726",
                "0.5205288051638547426899422149225713556026",
                "0.5105575237481139959383712954509381784618",
                "0.5078694065594170073171780215159386563203",
                "0.5124981310849447478113572730889830090920",
                "0.5243856761580259025626850637545402209422",
                "0.5433823502742758046687233106416466354285",
                "0.5692469164909218665479853234293662873929",
                "0.6016469472773414704983679531675936244676",
                "0.6401596126460129201701638776623992705989",
                "0.6842731591290223879209826787878417073290",
                "0.7333893711120164523411324261188437911725",
                "0.7868273163886106539287647521575864020294",
                "0.8438286627284999020308476501894158104674",
                "0.9035648115589959170669703984423238011320",
                "0.9651460300102596704347484747921584468642",
                "1.027632676656955834710491219072289618708",
                "1.090048513860886327138135286768806024973",
                "1.151395986462192734439795510133393066299",
                "1.210673229358196654595818494775228814195",
                "1.266892452425829740783090276650556078639",
                "1.319099247522493534510326711762719042722",
                "1.366392275779534857776361451253046468694",
                "1.407942730076464595222121640837443741545",
                "1.443012932198015864368351809594572136944",
                "1.470973419892932182727005622428196996514",
                "1.491317907214744118755335332933648254964",
                "1.503675561527698509252886467793607788858",
                "1.507820129860194313665002174542902715228",
                "1.503675561527698509252886467793607788858",
                "1.491317907214744118755335332933648254964",
                "1.470973419892932182727005622428196996514",
                "1.443012932198015864368351809594572136944",
                "1.407942730076464595222121640837443741545",
                "1.366392275779534857776361451253046468694",
                "1.319099247522493534510326711762719042722",
                "1.266892452425829740783090276650556078639",
                "1.210673229358196654595818494775228814195",
                "1.151395986462192734439795510133393066299",
                "1.090048513860886327138135286768806024973",
                "1.027632676656955834710491219072289618708",
                "0.9651460300102596704347484747921584468642",
                "0.9035648115589959170669703984423238011320",
                "0.8438286627284999020308476501894158104674",
                "0.7868273163886106539287647521575864020294",
                "0.7333893711120164523411324261188437911725",
                "0.6842731591290223879209826787878417073290",
                "0.6401596126460129201701638776623992705989",
                "0.6016469472773414704983679531675936244676",
                "0.5692469164909218665479853234293662873929",
                "0.5433823502742758046687233106416466354285",
                "0.5243856761580259025626850637545402209422",
                "0.5124981310849447478113572730889830090920",
                "0.5078694065594170073171780215159386563203",
                "0.5105575237481139959383712954509381784618",
                "0.5205288051638547426899422149225713556026",
                "0.5376578897214946574426634021956417243726",
                "0.5617278221555681081346635399591069891506",
                "0.5924303296366901236327077930972812345797",
                "0.6293664716628576542523091789176368968927",
                "0.6720479082028979553377038151558442158087",
                "0.7198990707811816062665325661977272221908",
                "0.7722605380501758898446935630373516826290",
                "0.8283939091645981040080610632315777844947",
                "0.8874884343055736692418006742644281685924",
                "0.9486696030304009692439850716773546616036",
                "1.011009810411640094616352726711651553117",
                "1.073541122365735950675903181216527142519",
                "1.135270050641925304593647144317329485025",
                "1.195194131122484925311413871114887329966",
                "1.252319983461273620258622940946027154861",
                "1.305682422924186553508492214370586961792",
                "1.354364103581248053912364270084850280893",
                "1.397515101995587094202296515885547798363",
                "1.434371807372348216003410772137340196044",
                "1.464274471381221476398616470689851251447",
                "1.486682790391987391838311009260402011781",
                "1.501188944581605044708701639964711278490",
                "1.507527600246728091386243758988544388049",
                "1.505582489791998500406243635405518018320",
                "1.495389312731716108530759546951215441119",
                "1.477134843809361190407083368866718077319",
                "1.451152283298117942040982667691202035285",
                "1.417913031596535466585274278348956854278",
                "1.378015207398028566226470264818362473948",
                "1.332169348636994973966915911179621460783",
                "1.281181831828946014083343506104401955470",
                "1.225936613528611528657532663328815832386",
                "1.167375934384488789550998022638572161913",
                "1.106480630546515036343001947209673140888",
                "1.044250669817903747165994282690791847342",
                "0.9816864736308543826395098605647492157590",
                "0.9197715050231299817244838441702476254399"
            };
            ddouble[] q0p50_expecteds = {
                "0.7364748991037176227926048369481586456550",
                "0.8543701574552920722374693997438538953377",
                "0.9803167514977213865275148613158659335752",
                "1.112407884944230476923890258687258683124",
                "1.248267748300281787736777004278940783837",
                "1.385095648321268219939568471343511404050",
                "1.519742598316860783561497374403578547581",
                "1.648818501834807193483141645371348852282",
                "1.768825408920911073777191413766303263301",
                "1.876309796227767814698479043781809221196",
                "1.968024695647317764874803971300111988002",
                "2.041091028312935946741729829716565699677",
                "2.093146895932844189052024980544490946230",
                "2.122473960119149777761133713610375045758",
                "2.128091418862170844335689571379688800215",
                "2.109810371465231919044156124894883447657",
                "2.068244347739878585454676914862391483193",
                "2.004775178967602058327621489287885567440",
                "1.921476871534481957466434380572216926633",
                "1.821003363783163542486552283119870470441",
                "1.706448689040287175785049747528595953131",
                "1.581189888844328559718662445122971102462",
                "1.448723872849803835927784487070393001797",
                "1.312509269331020550746067371229133969328",
                "1.175823226180045337506371982382955449969",
                "1.041641275087351629664020792285478171361",
                "0.9125459978460216537385448254510439112066",
                "0.7906676050913306103361666914900434701322",
                "0.6776569258799093460490114688730725141859",
                "0.5746889510010552117873488037352227249581",
                "0.4824931569541654171352811620306114796457",
                "0.4014054730802341894675455432957914976804",
                "0.3314359783245304238564458702083559893992",
                "0.2723461947040133052781685106102998017181",
                "0.2237300955342705317703351744247310683580",
                "0.1850935467215383034651508732514404052391",
                "0.1559277143295745510170367630840701978625",
                "0.1357728732678777411002903697668029308139",
                "0.1242699355664737109360981600425026478860",
                "0.1211978117551680956694801912605714477242",
                "0.1264953937627625987018884333521003806385",
                "0.1402675083626205597898285869698980850210",
                "0.1627746728191374984204796337445587278321",
                "0.1944069445212161869763324341156573878749",
                "0.2356426548666245233231991215937629371317",
                "0.2869934061531038739150986277593840618361",
                "0.3489374179125891430248558821688316483797",
                "0.4218441323947733251825602025383543428487",
                "0.5058938857304846079194744526778520659788",
                "0.6009973413276636954334160006866258019678",
                "0.7067201530497136775577036937987391884740",
                "0.8222188462021015399616519334391087924402",
                "0.9461940412074128170327402170596592688529",
                "1.076866784163703962640719891829803702446",
                "1.211982816727113459818182557483837673477",
                "1.348848100246499868859052208383081724317",
                "1.484396862425166928164115914328477415076",
                "1.615290990673736992943183660519639260483",
                "1.738046954779882725457862815194186308462",
                "1.849183853462874163640273950680068431497",
                "1.945383919743612326705943032930976804538",
                "2.023655154646491347107117843420483321294",
                "2.081484909105545675625041466313684764494",
                "2.116973345394114146138861773831315572522",
                "2.128936827211877158669458548544951324613",
                "2.116973345394114146138861773831315572522",
                "2.081484909105545675625041466313684764494",
                "2.023655154646491347107117843420483321294",
                "1.945383919743612326705943032930976804538",
                "1.849183853462874163640273950680068431497",
                "1.738046954779882725457862815194186308462",
                "1.615290990673736992943183660519639260483",
                "1.484396862425166928164115914328477415076",
                "1.348848100246499868859052208383081724317",
                "1.211982816727113459818182557483837673477",
                "1.076866784163703962640719891829803702446",
                "0.9461940412074128170327402170596592688529",
                "0.8222188462021015399616519334391087924402",
                "0.7067201530497136775577036937987391884740",
                "0.6009973413276636954334160006866258019678",
                "0.5058938857304846079194744526778520659788",
                "0.4218441323947733251825602025383543428487",
                "0.3489374179125891430248558821688316483797",
                "0.2869934061531038739150986277593840618361",
                "0.2356426548666245233231991215937629371317",
                "0.1944069445212161869763324341156573878749",
                "0.1627746728191374984204796337445587278321",
                "0.1402675083626205597898285869698980850210",
                "0.1264953937627625987018884333521003806385",
                "0.1211978117551680956694801912605714477242",
                "0.1242699355664737109360981600425026478860",
                "0.1357728732678777411002903697668029308139",
                "0.1559277143295745510170367630840701978625",
                "0.1850935467215383034651508732514404052391",
                "0.2237300955342705317703351744247310683580",
                "0.2723461947040133052781685106102998017181",
                "0.3314359783245304238564458702083559893992",
                "0.4014054730802341894675455432957914976804",
                "0.4824931569541654171352811620306114796457",
                "0.5746889510010552117873488037352227249581",
                "0.6776569258799093460490114688730725141859",
                "0.7906676050913306103361666914900434701322",
                "0.9125459978460216537385448254510439112066",
                "1.041641275087351629664020792285478171361",
                "1.175823226180045337506371982382955449969",
                "1.312509269331020550746067371229133969328",
                "1.448723872849803835927784487070393001797",
                "1.581189888844328559718662445122971102462",
                "1.706448689040287175785049747528595953131",
                "1.821003363783163542486552283119870470441",
                "1.921476871534481957466434380572216926633",
                "2.004775178967602058327621489287885567440",
                "2.068244347739878585454676914862391483193",
                "2.109810371465231919044156124894883447657",
                "2.128091418862170844335689571379688800215",
                "2.122473960119149777761133713610375045758",
                "2.093146895932844189052024980544490946230",
                "2.041091028312935946741729829716565699677",
                "1.968024695647317764874803971300111988002",
                "1.876309796227767814698479043781809221196",
                "1.768825408920911073777191413766303263301",
                "1.648818501834807193483141645371348852282",
                "1.519742598316860783561497374403578547581",
                "1.385095648321268219939568471343511404050",
                "1.248267748300281787736777004278940783837",
                "1.112407884944230476923890258687258683124",
                "0.9803167514977213865275148613158659335752",
                "0.8543701574552920722374693997438538953377",
                "0.7364748991037176227926048369481586456550"
            };
            ddouble[] q0p75_expecteds = {
                "0.2551087259355960968993869639392626230043",
                "0.3654376655442335053040397720800445847705",
                "0.5094567640676610666976942551466238449134",
                "0.6912057733232022424406494362597471567537",
                "0.9126691536174946395459742444697353583709",
                "1.172803834838329982335086973139478673418",
                "1.466707021285035092294398787982406752732",
                "1.785119743379900279871469833417801711217",
                "2.114449534048558816079303839105446760531",
                "2.437436351021447977736121727840501458912",
                "2.734483026026703316909657616966336440741",
                "2.985541886616384327701161464438725409144",
                "3.172320765087928666271930293854325389806",
                "3.280477081271613495370064130121130064529",
                "3.301436211664713484756875270467064816641",
                "3.233514417399557514688225439353149696451",
                "3.082142268842792788220546278330274542830",
                "2.859147428901910963247128491116074571862",
                "2.581228234036873468712410828701971336199",
                "2.267891391308633468868926717101620346850",
                "1.939206627251567204988565839225671818049",
                "1.613733852153966601580159018554122435750",
                "1.306910120209678729242464946630525911479",
                "1.030067111808265590650226385943763687810",
                "0.7901168257128619651703751029095220557269",
                "0.5898248819995563527584683079273643852184",
                "0.4285099029064707591493588743742377942866",
                "0.3029735022720388942426148033053674982623",
                "0.2084752518093103760253663454619751268976",
                "0.1396081255123464610572941549693789757016",
                "0.09098592330659372466871187281841264564529",
                "0.05770971454697208308000488640646076458764",
                "0.03562460647424961521547238574099244489703",
                "0.02140608493486143261370048347816382137435",
                "0.01252689837265919528159796974323204460985",
                "0.007154486567812276518036603285976977722495",
                "0.004020237977423425454154915722956970710486",
                "0.002290118870916624422297234191905772682462",
                "0.001454980465726576272217129788807083843223",
                "0.001250124644098975839066751883601492719848",
                "0.001608128805693807838543786615003274856123",
                "0.002646124169210004718384659197445445525240",
                "0.004687703347933491394574885204995894103624",
                "0.008319115660722708539406041916506645739138",
                "0.01447803324399716736879306231085678763443",
                "0.02456970567476598985057891448790677559194",
                "0.04059890790959427239040619917798171043045",
                "0.06529658129690463403298446779726093937270",
                "0.1022084382259115637844028743801943918630",
                "0.1557014591984152655134994337422260921737",
                "0.2308370574952849379405855582546142541264",
                "0.3330616292758573323680719588919023806825",
                "0.4676809970220343108782258068789241996754",
                "0.6391177063592728877380193694831956642466",
                "0.8499981252541248845955643617831977120690",
                "1.100173236242300363673545151066387174881",
                "1.385830682563233423502450109419910904725",
                "1.698889991698156656208105128791201153791",
                "2.026872040700652990107623353734321771020",
                "2.353387241074487982524979034990078639775",
                "2.659294564297885485219983730337858183977",
                "2.924458654277751116414253362569676235678",
                "3.129900375529243933593510080091448408494",
                "3.260029509622272920045119083065442148290",
                "3.304597249065620979156236952249668617679",
                "3.260029509622272920045119083065442148290",
                "3.129900375529243933593510080091448408494",
                "2.924458654277751116414253362569676235678",
                "2.659294564297885485219983730337858183977",
                "2.353387241074487982524979034990078639775",
                "2.026872040700652990107623353734321771020",
                "1.698889991698156656208105128791201153791",
                "1.385830682563233423502450109419910904725",
                "1.100173236242300363673545151066387174881",
                "0.8499981252541248845955643617831977120690",
                "0.6391177063592728877380193694831956642466",
                "0.4676809970220343108782258068789241996754",
                "0.3330616292758573323680719588919023806825",
                "0.2308370574952849379405855582546142541264",
                "0.1557014591984152655134994337422260921737",
                "0.1022084382259115637844028743801943918630",
                "0.06529658129690463403298446779726093937270",
                "0.04059890790959427239040619917798171043045",
                "0.02456970567476598985057891448790677559194",
                "0.01447803324399716736879306231085678763443",
                "0.008319115660722708539406041916506645739138",
                "0.004687703347933491394574885204995894103624",
                "0.002646124169210004718384659197445445525240",
                "0.001608128805693807838543786615003274856123",
                "0.001250124644098975839066751883601492719848",
                "0.001454980465726576272217129788807083843223",
                "0.002290118870916624422297234191905772682462",
                "0.004020237977423425454154915722956970710486",
                "0.007154486567812276518036603285976977722495",
                "0.01252689837265919528159796974323204460985",
                "0.02140608493486143261370048347816382137435",
                "0.03562460647424961521547238574099244489703",
                "0.05770971454697208308000488640646076458764",
                "0.09098592330659372466871187281841264564529",
                "0.1396081255123464610572941549693789757016",
                "0.2084752518093103760253663454619751268976",
                "0.3029735022720388942426148033053674982623",
                "0.4285099029064707591493588743742377942866",
                "0.5898248819995563527584683079273643852184",
                "0.7901168257128619651703751029095220557269",
                "1.030067111808265590650226385943763687810",
                "1.306910120209678729242464946630525911479",
                "1.613733852153966601580159018554122435750",
                "1.939206627251567204988565839225671818049",
                "2.267891391308633468868926717101620346850",
                "2.581228234036873468712410828701971336199",
                "2.859147428901910963247128491116074571862",
                "3.082142268842792788220546278330274542830",
                "3.233514417399557514688225439353149696451",
                "3.301436211664713484756875270467064816641",
                "3.280477081271613495370064130121130064529",
                "3.172320765087928666271930293854325389806",
                "2.985541886616384327701161464438725409144",
                "2.734483026026703316909657616966336440741",
                "2.437436351021447977736121727840501458912",
                "2.114449534048558816079303839105446760531",
                "1.785119743379900279871469833417801711217",
                "1.466707021285035092294398787982406752732",
                "1.172803834838329982335086973139478673418",
                "0.9126691536174946395459742444697353583709",
                "0.6912057733232022424406494362597471567537",
                "0.5094567640676610666976942551466238449134",
                "0.3654376655442335053040397720800445847705",
                "0.2551087259355960968993869639392626230043"
            };
            ddouble[] q0p875_expecteds = {
                "0.01946373251681428979955677819356248317459",
                "0.04221867593259221005832966691744685936501",
                "0.08637218208163894826578800296322133845864",
                "0.1666609972256968662667975337293316110815",
                "0.3033086962577459828414485795288063922351",
                "0.5206268357568438887340263540391450422318",
                "0.8428669785339488298108046489579841479654",
                "1.287011213083670201435774325979691930137",
                "1.853516359311481262092794822444071041368",
                "2.517684568215619549225131374278198001051",
                "3.225499761201370703972524211155482442529",
                "3.897476559051141614107589650629792984139",
                "4.441818527582360437945654733945364532728",
                "4.774511155345668675429996283741629123727",
                "4.840473146531621106578877517567166710882",
                "4.628470707705085865750773818648340316711",
                "4.174245864912591479336068174974985416763",
                "3.550662008991855315790211400726972264481",
                "2.848599821522830725303514591117420351238",
                "2.155481768192879404135569437779354448825",
                "1.538324888396594001435873645613632060379",
                "1.035482064401746130985391044357765192803",
                "0.6573972710095813052539763409938209514367",
                "0.3936443429523963197217510033508066545694",
                "0.2223161096013900018236086780488686806768",
                "0.1184209811344049558636815932116113257779",
                "0.05949454912707108582861048895947373953793",
                "0.02819139079819133637121452052294241809040",
                "0.01259930612011954998314929303327555258328",
                "0.005310893047977428249437987628412784211090",
                "0.002111442626028288933955018689397839505239",
                "0.0007917385946709916571073543823614200163170",
                "0.0002800110365187971822136423674829074904572",
                "0.00009340267120244244209948152289856135541627",
                "0.00002938559457920769044696860768767342038990",
                "8.719768416007470329341956027394263848907e-6",
                "2.440905943153314622546354599799682299308e-6",
                "6.468303591144776903057127958599739508538e-7",
                "1.728932101562686025149871675305217723644e-7",
                "9.330195861511434535286558035961226149468e-8",
                "2.416508872125978618068574479127648680084e-7",
                "9.244204689766664193652753665987729411885e-7",
                "3.441918326842036947185795982168989563673e-6",
                "0.00001210757870719348583456596841325309947519",
                "0.00004017387277835409586410340393306064930570",
                "0.0001257253788906094687719004301097237776196",
                "0.0003711018474139675183370838058691252136981",
                "0.001033127892874849575423989674820089599295",
                "0.002712725560924120005365444104812887740010",
                "0.006718130470428000082015408507695470447709",
                "0.01569212683688324935150410266824270959790",
                "0.03457052599175494959643913194569280345741",
                "0.07183249753962998675999228937578658234729",
                "0.1407753927218829957820346855533946557677",
                "0.2602096090171641224310676536738997604031",
                "0.4536393446605941535216296645572232250637",
                "0.7459142435522683296845712363074433844514",
                "1.156798955519422219994784945111109818529",
                "1.692067473121266586469234897024887774124",
                "2.334362338526365925387805720755284493772",
                "3.037453656272422561526742325005344149200",
                "3.727707733145020662537929892377751746570",
                "4.314841533508412198855773262904828974239",
                "4.710626251459122284253889837497943918649",
                "4.850463570580107745475266242741765023429",
                "4.710626251459122284253889837497943918649",
                "4.314841533508412198855773262904828974239",
                "3.727707733145020662537929892377751746570",
                "3.037453656272422561526742325005344149200",
                "2.334362338526365925387805720755284493772",
                "1.692067473121266586469234897024887774124",
                "1.156798955519422219994784945111109818529",
                "0.7459142435522683296845712363074433844514",
                "0.4536393446605941535216296645572232250637",
                "0.2602096090171641224310676536738997604031",
                "0.1407753927218829957820346855533946557677",
                "0.07183249753962998675999228937578658234729",
                "0.03457052599175494959643913194569280345741",
                "0.01569212683688324935150410266824270959790",
                "0.006718130470428000082015408507695470447709",
                "0.002712725560924120005365444104812887740010",
                "0.001033127892874849575423989674820089599295",
                "0.0003711018474139675183370838058691252136981",
                "0.0001257253788906094687719004301097237776196",
                "0.00004017387277835409586410340393306064930570",
                "0.00001210757870719348583456596841325309947519",
                "3.441918326842036947185795982168989563673e-6",
                "9.244204689766664193652753665987729411885e-7",
                "2.416508872125978618068574479127648680084e-7",
                "9.330195861511434535286558035961226149468e-8",
                "1.728932101562686025149871675305217723644e-7",
                "6.468303591144776903057127958599739508538e-7",
                "2.440905943153314622546354599799682299308e-6",
                "8.719768416007470329341956027394263848907e-6",
                "0.00002938559457920769044696860768767342038990",
                "0.00009340267120244244209948152289856135541627",
                "0.0002800110365187971822136423674829074904572",
                "0.0007917385946709916571073543823614200163170",
                "0.002111442626028288933955018689397839505239",
                "0.005310893047977428249437987628412784211090",
                "0.01259930612011954998314929303327555258328",
                "0.02819139079819133637121452052294241809040",
                "0.05949454912707108582861048895947373953793",
                "0.1184209811344049558636815932116113257779",
                "0.2223161096013900018236086780488686806768",
                "0.3936443429523963197217510033508066545694",
                "0.6573972710095813052539763409938209514367",
                "1.035482064401746130985391044357765192803",
                "1.538324888396594001435873645613632060379",
                "2.155481768192879404135569437779354448825",
                "2.848599821522830725303514591117420351238",
                "3.550662008991855315790211400726972264481",
                "4.174245864912591479336068174974985416763",
                "4.628470707705085865750773818648340316711",
                "4.840473146531621106578877517567166710882",
                "4.774511155345668675429996283741629123727",
                "4.441818527582360437945654733945364532728",
                "3.897476559051141614107589650629792984139",
                "3.225499761201370703972524211155482442529",
                "2.517684568215619549225131374278198001051",
                "1.853516359311481262092794822444071041368",
                "1.287011213083670201435774325979691930137",
                "0.8428669785339488298108046489579841479654",
                "0.5206268357568438887340263540391450422318",
                "0.3033086962577459828414485795288063922351",
                "0.1666609972256968662667975337293316110815",
                "0.08637218208163894826578800296322133845864",
                "0.04221867593259221005832966691744685936501",
                "0.01946373251681428979955677819356248317459"
            };

            foreach ((ddouble q, ddouble[] expecteds) in new[] {
                (0.25, q0p25_expecteds),
                (0.5, q0p50_expecteds),
                (0.75, q0p75_expecteds),
                (0.875, q0p875_expecteds)
            }) {
                for ((int i, double x) = (0, -4); i < expecteds.Length; i++, x += 1d / 16) {
                    ddouble expected = expecteds[i];

                    ddouble y = ddouble.EllipticTheta3(x, q);

                    Console.WriteLine($"{x},{q}");
                    Console.WriteLine(y);

                    HPAssert.AreEqual(expected, y, ddouble.Abs(expected) * 1e-29);
                }
            }
        }

        [TestMethod]
        public void EllipticTheta4Test() {
            ddouble[] q0p25_expecteds = {
                "1.065265066373748181156591746824501115339",
                "1.002702330630307830524058631452841455743",
                "0.9404609956774713947181797749147602791386",
                "0.8795044506191142798889711794596313304468",
                "0.8207539421207499854930448970035688866392",
                "0.7650760850768916098693534648814816510308",
                "0.7132724758057976061987602636275150917888",
                "0.6660713724453921991916885872103919823616",
                "0.6241213107399722599282164795366168235203",
                "0.5879864454110693691581760100525365172488",
                "0.5581433517940236533048378805471906821369",
                "0.5349789918496619340932955977598356290751",
                "0.5187895438309337761505244717164185076495",
                "0.5097798149373375535095455721925463287650",
                "0.5080629987885667861972936390206912656692",
                "0.5136606006548547200687134361288139615110",
                "0.5265024281082552825077286275892404241816",
                "0.5464266272858677468169696795430813383240",
                "0.5731798289869280806729315634339796175932",
                "0.6064175479734557427979996410663996584521",
                "0.6457050470185291482624675378163459175625",
                "0.6905189290270648109085480041343606770432",
                "0.7402497515286763715503644701512512475060",
                "0.7942059648897618956233977035177922423305",
                "0.8516194570963111623023798363467154551056",
                "0.9116529439382683522559483929461449768178",
                "0.9734093755685944222877129128892107485624",
                "1.035943442009172842098049660276425327129",
                "1.098275155967446109598191757842072639891",
                "1.159405377233431457500637727169847440766",
                "1.218333025714107912732275307920389422706",
                "1.274073617041969191874873271721750766882",
                "1.325678652876952565501259059338107355770",
                "1.372255314257437375285824947815485848999",
                "1.412985846496967651755047324916439105702",
                "1.447145992721518767181968688747809241031",
                "1.474121833129965935634906934404468496359",
                "1.493424419525975124114478268841160935659",
                "1.504701658749012044074752619387277180150",
                "1.507746991529612858264829418971380543026",
                "1.502504530429867462706436160339521195860",
                "1.489070455810235492900931882502919063199",
                "1.467690614953146885275812192920980965696",
                "1.438754418648103618019452327813291330991",
                "1.402785273589075183137251763349972164347",
                "1.360427920064172773653491094196493563395",
                "1.312433155656315497865063645011053755787",
                "1.259640511297413260015168819223299595226",
                "1.202959501899887943812435899971930929404",
                "1.143350097635898758337775344465713246963",
                "1.081803053404211578679505076384638239282",
                "1.019320694710499896817385484357850109714",
                "0.9568986914778904684513696017304894772931",
                "0.8955092621329815887301339771728481103854",
                "0.8360861448090674231528898681157678816060",
                "0.7795115575904416604966644306646641221519",
                "0.7266052526443680995572032588355574427634",
                "0.6781156569858398985543312106830804336910",
                "0.6347129920745206394096557390880550792237",
                "0.5969841810898383430068776998281639441214",
                "0.5654292909436068754840279111914151823332",
                "0.5404592187491004213993441691049146728949",
                "0.5223943208179886895058371309409059310491",
                "0.5114636958788427664773820370072722153122",
                "0.5078048710711282609513233740293515851230",
                "0.5114636958788427664773820370072722153122",
                "0.5223943208179886895058371309409059310491",
                "0.5404592187491004213993441691049146728949",
                "0.5654292909436068754840279111914151823332",
                "0.5969841810898383430068776998281639441214",
                "0.6347129920745206394096557390880550792237",
                "0.6781156569858398985543312106830804336910",
                "0.7266052526443680995572032588355574427634",
                "0.7795115575904416604966644306646641221519",
                "0.8360861448090674231528898681157678816060",
                "0.8955092621329815887301339771728481103854",
                "0.9568986914778904684513696017304894772931",
                "1.019320694710499896817385484357850109714",
                "1.081803053404211578679505076384638239282",
                "1.143350097635898758337775344465713246963",
                "1.202959501899887943812435899971930929404",
                "1.259640511297413260015168819223299595226",
                "1.312433155656315497865063645011053755787",
                "1.360427920064172773653491094196493563395",
                "1.402785273589075183137251763349972164347",
                "1.438754418648103618019452327813291330991",
                "1.467690614953146885275812192920980965696",
                "1.489070455810235492900931882502919063199",
                "1.502504530429867462706436160339521195860",
                "1.507746991529612858264829418971380543026",
                "1.504701658749012044074752619387277180150",
                "1.493424419525975124114478268841160935659",
                "1.474121833129965935634906934404468496359",
                "1.447145992721518767181968688747809241031",
                "1.412985846496967651755047324916439105702",
                "1.372255314257437375285824947815485848999",
                "1.325678652876952565501259059338107355770",
                "1.274073617041969191874873271721750766882",
                "1.218333025714107912732275307920389422706",
                "1.159405377233431457500637727169847440766",
                "1.098275155967446109598191757842072639891",
                "1.035943442009172842098049660276425327129",
                "0.9734093755685944222877129128892107485624",
                "0.9116529439382683522559483929461449768178",
                "0.8516194570963111623023798363467154551056",
                "0.7942059648897618956233977035177922423305",
                "0.7402497515286763715503644701512512475060",
                "0.6905189290270648109085480041343606770432",
                "0.6457050470185291482624675378163459175625",
                "0.6064175479734557427979996410663996584521",
                "0.5731798289869280806729315634339796175932",
                "0.5464266272858677468169696795430813383240",
                "0.5265024281082552825077286275892404241816",
                "0.5136606006548547200687134361288139615110",
                "0.5080629987885667861972936390206912656692",
                "0.5097798149373375535095455721925463287650",
                "0.5187895438309337761505244717164185076495",
                "0.5349789918496619340932955977598356290751",
                "0.5581433517940236533048378805471906821369",
                "0.5879864454110693691581760100525365172488",
                "0.6241213107399722599282164795366168235203",
                "0.6660713724453921991916885872103919823616",
                "0.7132724758057976061987602636275150917888",
                "0.7650760850768916098693534648814816510308",
                "0.8207539421207499854930448970035688866392",
                "0.8795044506191142798889711794596313304468",
                "0.9404609956774713947181797749147602791386",
                "1.002702330630307830524058631452841455743",
                "1.065265066373748181156591746824501115339"
            };
            ddouble[] q0p50_expecteds = {
                "1.024161147731330827103564503229671566751",
                "0.8959115153914648702146888365939440039944",
                "0.7751257141930526049791546099512549205284",
                "0.6633905784454764071915020216198779598646",
                "0.5618196882769363355276260989945228012793",
                "0.4710868850983614655085078492311634951150",
                "0.3914806772293224342129225990852651671410",
                "0.3229735623993711261495365028451420061364",
                "0.2653001428083075002357986662576198136219",
                "0.2180382132553151682133793987801156679021",
                "0.1806876393874556269166450479418386735337",
                "0.1527426765411586507235049639649491076012",
                "0.1337542842671449984447514730485862630505",
                "0.1233798667260398803508738349067016802863",
                "0.1214186492080294795381189977703035802318",
                "0.1278315596650493285467638791835680208015",
                "0.1427450317677867570217666689724300583627",
                "0.1664386221841942547177622872890272988385",
                "0.1993167965490069076390705023708673921675",
                "0.2418657464093745492474560101372889103156",
                "0.2945967026906698366672766183942460205247",
                "0.3579779352586511458257556163249823857939",
                "0.4323584644682196110456260346968450243079",
                "0.5178874119215287589041710277376813779882",
                "0.6144337989122257679129719025692676723774",
                "0.7215123465765465748225595006903492341484",
                "0.8382213087890080264751100781324094418167",
                "0.9631984455401412683836350434224946719602",
                "1.094600811165378853207500076764573620181",
                "1.230113021675453194759607974276221211077",
                "1.366987072791622517623329727661732826952",
                "1.502114671696552147285598014182775194799",
                "1.632130562351990831100773069064726698266",
                "1.753542674522948905535000939344474600484",
                "1.862882366203190326100656414720169463462",
                "1.956865833686031664819064746565725181601",
                "2.032556195001848074726411158297506552739",
                "2.087515023989900815258806744341682629048",
                "2.119932357067949064416055431161549229348",
                "2.128725443632751842572732116648116773517",
                "2.113598682696487816283031652408424919401",
                "2.075060094507552711870730285585333557620",
                "2.014393040835960827610149590301596549892",
                "1.933585400260384863798597314612004782810",
                "1.835221678593080278756584002685913824634",
                "1.722346269503974848309797954295474061618",
                "1.598308021286446636184098490515951697725",
                "1.466597251293462788495011259887183765885",
                "1.330686328485433289294314954726283002076",
                "1.193883976292882218774976226436599431767",
                "1.059211689641798416630389655515133116264",
                "0.9293083409009336279077802055660154610875",
                "0.8063664387329133698797499025988219546195",
                "0.6921008749261301854818975927850992546674",
                "0.5877485927721419068263511186403105705207",
                "0.4940956281702400679198535684337867255492",
                "0.4115265332534055152063236808928258574456",
                "0.3400903386634671312989694239922755953604",
                "0.2795769212780567360748341056488395704176",
                "0.2295978391624265649232329794793519309512",
                "0.1896662570786058569074775935623122867768",
                "0.1592713799915558330376376524912626136330",
                "0.1379437088068258475619810776662829089043",
                "0.1253083234649242017821112524450664485381",
                "0.1211242080025805024608492931818675058099",
                "0.1253083234649242017821112524450664485381",
                "0.1379437088068258475619810776662829089043",
                "0.1592713799915558330376376524912626136330",
                "0.1896662570786058569074775935623122867768",
                "0.2295978391624265649232329794793519309512",
                "0.2795769212780567360748341056488395704176",
                "0.3400903386634671312989694239922755953604",
                "0.4115265332534055152063236808928258574456",
                "0.4940956281702400679198535684337867255492",
                "0.5877485927721419068263511186403105705207",
                "0.6921008749261301854818975927850992546674",
                "0.8063664387329133698797499025988219546195",
                "0.9293083409009336279077802055660154610875",
                "1.059211689641798416630389655515133116264",
                "1.193883976292882218774976226436599431767",
                "1.330686328485433289294314954726283002076",
                "1.466597251293462788495011259887183765885",
                "1.598308021286446636184098490515951697725",
                "1.722346269503974848309797954295474061618",
                "1.835221678593080278756584002685913824634",
                "1.933585400260384863798597314612004782810",
                "2.014393040835960827610149590301596549892",
                "2.075060094507552711870730285585333557620",
                "2.113598682696487816283031652408424919401",
                "2.128725443632751842572732116648116773517",
                "2.119932357067949064416055431161549229348",
                "2.087515023989900815258806744341682629048",
                "2.032556195001848074726411158297506552739",
                "1.956865833686031664819064746565725181601",
                "1.862882366203190326100656414720169463462",
                "1.753542674522948905535000939344474600484",
                "1.632130562351990831100773069064726698266",
                "1.502114671696552147285598014182775194799",
                "1.366987072791622517623329727661732826952",
                "1.230113021675453194759607974276221211077",
                "1.094600811165378853207500076764573620181",
                "0.9631984455401412683836350434224946719602",
                "0.8382213087890080264751100781324094418167",
                "0.7215123465765465748225595006903492341484",
                "0.6144337989122257679129719025692676723774",
                "0.5178874119215287589041710277376813779882",
                "0.4323584644682196110456260346968450243079",
                "0.3579779352586511458257556163249823857939",
                "0.2945967026906698366672766183942460205247",
                "0.2418657464093745492474560101372889103156",
                "0.1993167965490069076390705023708673921675",
                "0.1664386221841942547177622872890272988385",
                "0.1427450317677867570217666689724300583627",
                "0.1278315596650493285467638791835680208015",
                "0.1214186492080294795381189977703035802318",
                "0.1233798667260398803508738349067016802863",
                "0.1337542842671449984447514730485862630505",
                "0.1527426765411586507235049639649491076012",
                "0.1806876393874556269166450479418386735337",
                "0.2180382132553151682133793987801156679021",
                "0.2653001428083075002357986662576198136219",
                "0.3229735623993711261495365028451420061364",
                "0.3914806772293224342129225990852651671410",
                "0.4710868850983614655085078492311634951150",
                "0.5618196882769363355276260989945228012793",
                "0.6633905784454764071915020216198779598646",
                "0.7751257141930526049791546099512549205284",
                "0.8959115153914648702146888365939440039944",
                "1.024161147731330827103564503229671566751"
            };
            ddouble[] q0p75_expecteds = {
                "0.5662164593366462828269602601834551789403",
                "0.4098780988470218922669753048228001587587",
                "0.2887572863364371842754953085618100470564",
                "0.1979781598242472099989054039976067659222",
                "0.1321015798029903716703405854354477408882",
                "0.08578400653751622265960801966361101047924",
                "0.05421467850570641917591785323194498474891",
                "0.03334708969888781770733379369962644748165",
                "0.01996645212342797239120141200052302422495",
                "0.01164461509426510253619170906308121897672",
                "0.006631620950408410082428121928038013194595",
                "0.003723705153036000963479541018441394322481",
                "0.002135704203683899668764835887173320168301",
                "0.001394848413962418939137775876167861562709",
                "0.001264598006512426323016534247225794092447",
                "0.001702007700435871378718679227855865997680",
                "0.002849602039786467671030567268712139206963",
                "0.005061869424160363570445612861936435168420",
                "0.008965929091537885495203275939542277386795",
                "0.01555433812252617072442849783455250858230",
                "0.02630418663478911252938273173520480832146",
                "0.04330979423892587692639256905178957843846",
                "0.06940644935907484572154547503041027978118",
                "0.1082508694629146575477461573085314242127",
                "0.1643130203212024308764958804061873397134",
                "0.2427276922685651940440723195886523973774",
                "0.3489577606769415546959090073743937995471",
                "0.4882389633400491439489878328774966714680",
                "0.6648107139864858501083596993422105584270",
                "0.8809871558914007255947366052156626374351",
                "1.136179981600289190474687121917234846776",
                "1.426036620664169910641061999218373210892",
                "1.741887939569563926844175667910175774172",
                "2.070693092174820226272385921801653161450",
                "2.395616224905549004868300701860992698217",
                "2.697272008894768668794817380338831087059",
                "2.955549475658721787296732438885027574145",
                "3.151793174749938395415474341813824084308",
                "3.271019824523266971681374580390373058323",
                "3.303806706083913040338318388675164652690",
                "3.247521785216370786208579526253918881446",
                "3.106672724341972386149069668726768696234",
                "2.892310567983804999024741388194084426469",
                "2.620597563989224615862351526307168366573",
                "2.310796654715087856285453622794417193223",
                "1.983029230668696519877685664078566518517",
                "1.656160759196093196698140759631090750946",
                "1.346114038041794180155701685924110076122",
                "1.064797946837517862187047538328339407746",
                "0.8197068147599343777363394586727361112895",
                "0.6141237258803210104108209494241090948635",
                "0.4477743373845451327663034392375850366161",
                "0.3177375414554752952037115178816848560430",
                "0.2194238964534842067891960308899366808064",
                "0.1474706476360551838314039800831505547578",
                "0.09645713383552539387675049601740886059012",
                "0.06140071977874308462951775102303057471800",
                "0.03803957130311619344643864757173740254600",
                "0.02293879098427830935865208668853085332874",
                "0.01347015897597887097151289000721981694891",
                "0.007716166313543335912735227814550826415964",
                "0.004341049022998462965756194454610130462673",
                "0.002459957141198681756991059350885990385435",
                "0.001525940299274519205358229460889358995629",
                "0.001245309430198100883360550765546521830049",
                "0.001525940299274519205358229460889358995629",
                "0.002459957141198681756991059350885990385435",
                "0.004341049022998462965756194454610130462673",
                "0.007716166313543335912735227814550826415964",
                "0.01347015897597887097151289000721981694891",
                "0.02293879098427830935865208668853085332874",
                "0.03803957130311619344643864757173740254600",
                "0.06140071977874308462951775102303057471800",
                "0.09645713383552539387675049601740886059012",
                "0.1474706476360551838314039800831505547578",
                "0.2194238964534842067891960308899366808064",
                "0.3177375414554752952037115178816848560430",
                "0.4477743373845451327663034392375850366161",
                "0.6141237258803210104108209494241090948635",
                "0.8197068147599343777363394586727361112895",
                "1.064797946837517862187047538328339407746",
                "1.346114038041794180155701685924110076122",
                "1.656160759196093196698140759631090750946",
                "1.983029230668696519877685664078566518517",
                "2.310796654715087856285453622794417193223",
                "2.620597563989224615862351526307168366573",
                "2.892310567983804999024741388194084426469",
                "3.106672724341972386149069668726768696234",
                "3.247521785216370786208579526253918881446",
                "3.303806706083913040338318388675164652690",
                "3.271019824523266971681374580390373058323",
                "3.151793174749938395415474341813824084308",
                "2.955549475658721787296732438885027574145",
                "2.697272008894768668794817380338831087059",
                "2.395616224905549004868300701860992698217",
                "2.070693092174820226272385921801653161450",
                "1.741887939569563926844175667910175774172",
                "1.426036620664169910641061999218373210892",
                "1.136179981600289190474687121917234846776",
                "0.8809871558914007255947366052156626374351",
                "0.6648107139864858501083596993422105584270",
                "0.4882389633400491439489878328774966714680",
                "0.3489577606769415546959090073743937995471",
                "0.2427276922685651940440723195886523973774",
                "0.1643130203212024308764958804061873397134",
                "0.1082508694629146575477461573085314242127",
                "0.06940644935907484572154547503041027978118",
                "0.04330979423892587692639256905178957843846",
                "0.02630418663478911252938273173520480832146",
                "0.01555433812252617072442849783455250858230",
                "0.008965929091537885495203275939542277386795",
                "0.005061869424160363570445612861936435168420",
                "0.002849602039786467671030567268712139206963",
                "0.001702007700435871378718679227855865997680",
                "0.001264598006512426323016534247225794092447",
                "0.001394848413962418939137775876167861562709",
                "0.002135704203683899668764835887173320168301",
                "0.003723705153036000963479541018441394322481",
                "0.006631620950408410082428121928038013194595",
                "0.01164461509426510253619170906308121897672",
                "0.01996645212342797239120141200052302422495",
                "0.03334708969888781770733379369962644748165",
                "0.05421467850570641917591785323194498474891",
                "0.08578400653751622265960801966361101047924",
                "0.1321015798029903716703405854354477408882",
                "0.1979781598242472099989054039976067659222",
                "0.2887572863364371842754953085618100470564",
                "0.4098780988470218922669753048228001587587",
                "0.5662164593366462828269602601834551789403"
            };
            ddouble[] q0p875_expecteds = {
                "0.1084446258266400266451562729333700825535",
                "0.05406095446856842008897912313305048625604",
                "0.02541851561945063046114770909016250008176",
                "0.01127216826262663482134854248167274075555",
                "0.004714716055582981550586115116113850322506",
                "0.001859920681082507932713659468346748949226",
                "0.0006920287005131727431130528362479193820454",
                "0.0002428536257503098783281663978201335117903",
                "0.00008038146132634153152125245651021873615911",
                "0.00002509333325210133339715770163633251984916",
                "7.388533274407276198927465449817433524620e-6",
                "2.052457804944389002115061255006423177807e-6",
                "5.406872836065700448544552972695844124274e-7",
                "1.480710815617681140151066381618564765041e-7",
                "9.846505328494562753486179431792835570803e-8",
                "2.877670812398052285557248300183400828459e-7",
                "1.103968262474737906006660379941011696984e-6",
                "4.080988448704377143510551185092151534917e-6",
                "0.00001424500204356996974800565012388623019073",
                "0.00004690042379326451746524448313754355367022",
                "0.0001456408513613686380060809872027239157285",
                "0.0004265603911620941814528785679395800404464",
                "0.001178334649534887057387917705439724677201",
                "0.003070065016812419491564858590895312462440",
                "0.007544271322326198227829133704498452243393",
                "0.01748549078756341405096924709891440574054",
                "0.03822338599230939709314905049782300607141",
                "0.07880817803003923521051920937120479497889",
                "0.1532513185663892580558865009078044584483",
                "0.2810787116360424538681724594425755434413",
                "0.4862308277004486479889751990227348841820",
                "0.7933189491475125213571000289693380616427",
                "1.220798444576450361567229752345852812620",
                "1.771866137296500538288481296572818971994",
                "2.425541172275218836416193880657889015046",
                "3.131678676850640587134067387145635612639",
                "3.813612314079662929445295800579424631458",
                "4.380126858940672641271380230918444459016",
                "4.744906273487094120418072805625480368917",
                "4.847964033141879636529505548808130660808",
                "4.671775252490502125769866971062372127766",
                "4.246149648208629849742487947887758949116",
                "3.639983810084690711194936528423300943594",
                "2.943028105696588075982741162162470746677",
                "2.244296172788122328297393491806017179446",
                "1.614197720857999511284602394621193951656",
                "1.095025145974740596107883948346746945730",
                "0.7006195579783828540504181197863899459945",
                "0.4227963432873455810017102760224216084675",
                "0.2406417571157572381923393452248385347991",
                "0.1291818677071416672434851417655477149518",
                "0.06540680424198296785213680808931309412345",
                "0.03123453916072840302448901181739055970067",
                "0.01406818519817113473441951259280606169674",
                "0.005976292604051261848820773754465894963990",
                "0.002394508760312856656142475532834890275588",
                "0.0009048817086682765124792882557649779590978",
                "0.0003225209948480590292875130333418510117395",
                "0.0001084213928443753226710885296236874994074",
                "0.00003437660115956936021614160341668713906279",
                "0.00001028027478104879072158915999405878548527",
                "2.899978136167202231558909106582349448692e-6",
                "7.735009845672740820308718845362815932762e-7",
                "2.037585471711665223483233622481303303791e-7",
                "9.159962553050060627076014464728130448771e-8",
                "2.037585471711665223483233622481303303791e-7",
                "7.735009845672740820308718845362815932762e-7",
                "2.899978136167202231558909106582349448692e-6",
                "0.00001028027478104879072158915999405878548527",
                "0.00003437660115956936021614160341668713906279",
                "0.0001084213928443753226710885296236874994074",
                "0.0003225209948480590292875130333418510117395",
                "0.0009048817086682765124792882557649779590978",
                "0.002394508760312856656142475532834890275588",
                "0.005976292604051261848820773754465894963990",
                "0.01406818519817113473441951259280606169674",
                "0.03123453916072840302448901181739055970067",
                "0.06540680424198296785213680808931309412345",
                "0.1291818677071416672434851417655477149518",
                "0.2406417571157572381923393452248385347991",
                "0.4227963432873455810017102760224216084675",
                "0.7006195579783828540504181197863899459945",
                "1.095025145974740596107883948346746945730",
                "1.614197720857999511284602394621193951656",
                "2.244296172788122328297393491806017179446",
                "2.943028105696588075982741162162470746677",
                "3.639983810084690711194936528423300943594",
                "4.246149648208629849742487947887758949116",
                "4.671775252490502125769866971062372127766",
                "4.847964033141879636529505548808130660808",
                "4.744906273487094120418072805625480368917",
                "4.380126858940672641271380230918444459016",
                "3.813612314079662929445295800579424631458",
                "3.131678676850640587134067387145635612639",
                "2.425541172275218836416193880657889015046",
                "1.771866137296500538288481296572818971994",
                "1.220798444576450361567229752345852812620",
                "0.7933189491475125213571000289693380616427",
                "0.4862308277004486479889751990227348841820",
                "0.2810787116360424538681724594425755434413",
                "0.1532513185663892580558865009078044584483",
                "0.07880817803003923521051920937120479497889",
                "0.03822338599230939709314905049782300607141",
                "0.01748549078756341405096924709891440574054",
                "0.007544271322326198227829133704498452243393",
                "0.003070065016812419491564858590895312462440",
                "0.001178334649534887057387917705439724677201",
                "0.0004265603911620941814528785679395800404464",
                "0.0001456408513613686380060809872027239157285",
                "0.00004690042379326451746524448313754355367022",
                "0.00001424500204356996974800565012388623019073",
                "4.080988448704377143510551185092151534917e-6",
                "1.103968262474737906006660379941011696984e-6",
                "2.877670812398052285557248300183400828459e-7",
                "9.846505328494562753486179431792835570803e-8",
                "1.480710815617681140151066381618564765041e-7",
                "5.406872836065700448544552972695844124274e-7",
                "2.052457804944389002115061255006423177807e-6",
                "7.388533274407276198927465449817433524620e-6",
                "0.00002509333325210133339715770163633251984916",
                "0.00008038146132634153152125245651021873615911",
                "0.0002428536257503098783281663978201335117903",
                "0.0006920287005131727431130528362479193820454",
                "0.001859920681082507932713659468346748949226",
                "0.004714716055582981550586115116113850322506",
                "0.01127216826262663482134854248167274075555",
                "0.02541851561945063046114770909016250008176",
                "0.05406095446856842008897912313305048625604",
                "0.1084446258266400266451562729333700825535"
            };

            foreach ((ddouble q, ddouble[] expecteds) in new[] {
                (0.25, q0p25_expecteds),
                (0.5, q0p50_expecteds),
                (0.75, q0p75_expecteds),
                (0.875, q0p875_expecteds)
            }) {
                for ((int i, double x) = (0, -4); i < expecteds.Length; i++, x += 1d / 16) {
                    ddouble expected = expecteds[i];

                    ddouble y = ddouble.EllipticTheta4(x, q);

                    Console.WriteLine($"{x},{q}");
                    Console.WriteLine(y);

                    HPAssert.AreEqual(expected, y, ddouble.Abs(expected) * 1e-29);
                }
            }
        }
    }
}
