using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class EllipticFunctionTests {
        [TestMethod]
        public void EllipticKTest() {
            ddouble[] expecteds = {
                "1.311028777146059905232419794945559706841",
                "1.313822521602589932785737602386333742705",
                "1.316641860447711171700198953321625573022",
                "1.319487225274569533321064057717161032722",
                "1.322359058397556893387197019618083211351",
                "1.325257813206285230088993846901426835783",
                "1.328183954534201614989195685134639646133",
                "1.331137959042574144402942806333049787831",
                "1.334120315620621629167376588489276788078",
                "1.337131525802605468712331684470317129129",
                "1.340172104202750840587260500299613905516",
                "1.343242578968916377486557127051506571809",
                "1.346343492255987139270874119806492844022",
                "1.349475400720025198937944412070579649756",
                "1.352638876034275855061587700909744623005",
                "1.355834505428195692077008317847124135695",
                "1.359062892250741796861736238323674147272",
                "1.362324656559239800937708968100614812060",
                "1.365620435735232483833147210176808609048",
                "1.368950885128800915786323708787316455926",
                "1.372316678732947051725405953486726501109",
                "1.375718509889730876056996966488123243126",
                "1.379157092029967255017791487872130220672",
                "1.382633159448408254553030245390195654618",
                "1.386147468116466566020136774629062217040",
                "1.389700796534675660293833222990863326713",
                "1.393293946627233253284408670352225489335",
                "1.396927744681137590715846583551686794604",
                "1.400603042332602023180180836809718604614",
                "1.404320717603623528450070494886909611956",
                "1.408081675991786551937748300292462998034",
                "1.411886851616606217520138233461175561848",
                "1.415737208425956198892165965423613532473",
                "1.419633741466388092343295470085255181151",
                "1.423577478221432938048159068735476541996",
                "1.427569480022283749790175353618877138870",
                "1.431610843535592917031509532700845427527",
                "1.435702702333482784439893945251779468042",
                "1.439846228551264531798477104902532753660",
                "1.444042634638792940616600529524495454375",
                "1.448293175211856382304508764595670235339",
                "1.452599149010516453395878820515528113281",
                "1.456961900971874643489724084176756772154",
                "1.461382824425359310109072962305113826154",
                "1.465863363419300710944125088010808453797",
                "1.470405015188301247349238011584774886866",
                "1.475009332771719513778209490646364721366",
                "1.479677927794478211580972543838506598435",
                "1.484412473422386452907343887925897958167",
                "1.489214707505246565246816816636192644853",
                "1.494086435922205615692548833135316687572",
                "1.499029536145125389037968716045263797715",
                "1.504045961037196047202439394644583143152",
                "1.509137742905624677125251283581216633723",
                "1.514306997829009130628528630964508377000",
                "1.519555930281981259362721420858958347928",
                "1.524886838081896082232208976852428428240",
                "1.530302117684782222175295771115219779171",
                "1.535804269860485675170364492938434548120",
                "1.541395905779969742701215898255655563624",
                "1.547079753551120173209579004972943717930",
                "1.552858665243193773431993887183098410082",
                "1.558735624444295693735157847096045117534",
                "1.564713754401038368379572630580725617048",
                "1.570796326794896619231321691639751442099",
                "1.576986771215813142124403053228808080382",
                "1.583288685400424467834512481846404542297",
                "1.589705846309983478854188856183168840001",
                "1.596242222131783510148969071497949879506",
                "1.602901985297796194899595693857169929056",
                "1.609689526625502369048575814940384280546",
                "1.616609470698736063142211740574470552222",
                "1.623666692621027323464926297218007730743",
                "1.630866336290717176779250478449835999908",
                "1.638213834366378955857038295184925651749",
                "1.645714930113231773852407148469514701781",
                "1.653375701346771208939713955078915548290",
                "1.661202586719363028752815025000156828695",
                "1.669202414629759719643593847915060753000",
                "1.677382435075262495085563772069234376033",
                "1.685750354812596042871203657799076989501",
                "1.694314376247740184839825165621903568713",
                "1.703083240538492139398334147676236628499",
                "1.712066275468270414988459985659563777503",
                "1.721273448737889660359178078725676366211",
                "1.730715427426532021355366325537346985260",
                "1.740403644497371368395497664706511221821",
                "1.750350373371563761220239626820809198348",
                "1.760568811771954495787446718089955385429",
                "1.771073176251581444370173363882960896208",
                "1.781878809080336200262569749752396240989",
                "1.793002299476700193289563657076436273826",
                "1.804461621553968222373600625610670759688",
                "1.816276291819331182734396045846770312043",
                "1.828467549642229195725066223199414850585",
                "1.841058564824889077152012806705465059630",
                "1.854074677301371918433850347195260046218",
                "1.867543675112457692676500068417255056187",
                "1.881496118219621122748647418095262114722",
                "1.895965717522425286122280812067898297925",
                "1.910989780751829196553148218761342559253",
                "1.926609739893582920450191931223535890369",
                "1.942871778680434609327759540683773642856",
                "1.959827583798844600024972758211979273007",
                "1.977535250235611428253516532627795954406",
                "1.996060380284727858764126571705948161026",
                "2.015477428073705161311473896289558325034",
                "2.035871358413585753245350234081539258498",
                "2.057339712356378169733488050058303384784",
                "2.079995205129674679276612360896141580852",
                "2.103969029848747389220371705983744677231",
                "2.129415110036352177279981271719275922987",
                "2.156515647499643235438674998800322028864",
                "2.185488469278223686913080323730158689730",
                "2.216596921627807102342718723262938628408",
                "2.250163448669196475776138067004540472233",
                "2.286588633650667991686729186098045732541",
                "2.326378569035678846420299092711924217737",
                "2.370185344296105705673486664430425773553",
                "2.418868993809016045900274727784415867562",
                "2.473596173751343911975589752733039465815",
                "2.536005227467480679724400685529749852156",
                "2.608499627175084267858481569466979096393",
                "2.694811911971635312977987861752946067877",
                "2.801206084665204046360361673619437209228",
                "2.939446126743500419208180657425821245078",
                "3.135992158076202184437643690967039845094",
                "3.475447457496819511777186630121955422167"
            };

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticK(m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticETest() {
            ddouble[] expecteds = {
                "1.910098894513856008952381041085721645955",
                "1.905411215387931619682406730567280051397",
                "1.900708546529360647988455595862534435963",
                "1.895990732791744916122647243383500390971",
                "1.891257616240004171800827289006995366104",
                "1.886509036078205936830657745092336508654",
                "1.881744828574941557880851952861154896486",
                "1.876964826986144644613995757819138832971",
                "1.872168861475242807751118793763676557427",
                "1.867356759030528023588439554135467122415",
                "1.862528343379625030656241032447173953868",
                "1.857683434900930885555534148206510982617",
                "1.852821850531892143694417239933353356354",
                "1.847943403673979059886394596338448102206",
                "1.843047904094208694658692571350269767037",
                "1.838135157823060833430798275509206284502",
                "1.833204967048622143726142625544452760370",
                "1.828257130006784973793236436534659827415",
                "1.823291440867317594963180848136600327718",
                "1.818307689615612467016288742099841085646",
                "1.813305661929908214458092148401394300685",
                "1.808285139053769391695320480776531564993",
                "1.803245897663595732162445544407056209615",
                "1.798187709730919361304683605593978678287",
                "1.793110342379234341667903876174744136954",
                "1.788013557735087840243820347639470904959",
                "1.782897112773146087552428743157691963357",
                "1.777760759154931051801409722287462656738",
                "1.772604243060905289459741494512323896454",
                "1.767427305015562657108227636935252395034",
                "1.762229679705161370804817528401959611863",
                "1.757011095787713160748895740296879786369",
                "1.751771275694817862026501838984512041414",
                "1.746509935424906565746094720108516012744",
                "1.741226784327428274511982987024013761010",
                "1.735921524877484692562165234621892957972",
                "1.730593852440385148081478928956394016292",
                "1.725243455025558488864628818416027788924",
                "1.719870013029220887895391694788658297840",
                "1.714473198965157595059995877409890955527",
                "1.709052677182932502364253674201120496417",
                "1.703608103572791651723565528804460469968",
                "1.698139125256475174229439333740570793389",
                "1.692645380263096240201078105597438188413",
                "1.687126497189185013417898968827541738792",
                "1.681582094841929889765035087313962879869",
                "1.676011781864576959777254359220197612637",
                "1.670415156342871110431490288264826577286",
                "1.664791805391337855827232677690668000837",
                "1.659141304718113170675208093639100631092",
                "1.653463218166928527144181111344174975895",
                "1.647757097234749147497366527698174171797",
                "1.642022480563444223822209319197881495368",
                "1.636258893403737449171767475943257437587",
                "1.630465847049543448754147551057458440173",
                "1.624642838240639244890810654515476936991",
                "1.618789348531448216682358353347551753736",
                "1.612904843623525414410165919527655914578",
                "1.606988772659125630569180002795579540704",
                "1.601040567473007134634595338912734769051",
                "1.595059641799371980868588815588244729380",
                "1.589045390430565501900464522403149250391",
                "1.582997188323849830716400330773053213831",
                "1.576914389652225438489527846127335433735",
                "1.570796326794896619231321691639751442099",
                "1.564642309262556894432573809162726348812",
                "1.558451622552203074196241225507151658254",
                "1.552223526925666030918786333873743344283",
                "1.545957256105465034950412439920610612017",
                "1.539652015880942614952994349377704121844",
                "1.533306982616908930541600250946435198301",
                "1.526921301656207700637980170791955730154",
                "1.520494085606697204776575183367852127363",
                "1.514024412502105109430704365649183056112",
                "1.507511323825047792128701171147486880523",
                "1.500953822379183498450923308152845466788",
                "1.494350869995970712483570005666964564066",
                "1.487701385059801116221901493214322862662",
                "1.481004239833338144245486253424661157028",
                "1.474258257562679230883104710173186919456",
                "1.467462209339427155459795266990916136025",
                "1.460614810693849625728995877851527717163",
                "1.453714717889962229250741269948828132958",
                "1.446760523889511305428185712162640276480",
                "1.439750753947367844854309876665730819549",
                "1.432683860795659883788094479571374322165",
                "1.425558219367934232788193723237029812651",
                "1.418372121007584864635847035771534998823",
                "1.411123767096514752546251031667024451041",
                "1.403811262030264903115686232825870910848",
                "1.396432605454346217356590247247887913419",
                "1.388985683662871916053531826740146996508",
                "1.381468260044344065330349153992028798642",
                "1.373877964440013265237412598744235715176",
                "1.366212281256870631643524897703955809219",
                "1.358468536149114656320927388032779490797",
                "1.350643881047675502520174735338725841350",
                "1.342735277275552795496778300996727275956",
                "1.334739476435361799343854437390976563942",
                "1.326652998692024300566133381256361066466",
                "1.318472107994620997371842794497930930603",
                "1.310192783682589568876562034128701823610",
                "1.301810687796760389663726021044820319647",
                "1.293321127257150860432173162453826895891",
                "1.284719009866063196619995708659895713811",
                "1.275998792831796528565272550687606072574",
                "1.267154422164207183376791836112837595468",
                "1.258179260838798560780214178796743285989",
                "1.249066003018567637514700647249200107915",
                "1.239806570800815200800950762984528750725",
                "1.230391988828439807058927441530411703448",
                "1.220812230534859095994658627212167640451",
                "1.211056027568459524803562899548978676494",
                "1.201110630736914697794518710797492052304",
                "1.190961506094848633304973210479384947333",
                "1.180591942697681287846662735354380583095",
                "1.169982537577002396340474563375145196732",
                "1.159110506049795300438964492342998827029",
                "1.147948736783822538094599525589385922037",
                "1.136464461974017156198235279940278114495",
                "1.124617325119752213158613719354261980648",
                "1.112356462659774003758220423882152916982",
                "1.099615879389268469753904131999471451112",
                "1.086306657414100891123787901941189062217",
                "1.072302721894604277869651076107464594147",
                "1.057411715024108431749476615851308004636",
                "1.041304202018977361305105434385948585556",
                "1.023279893756109396403927911329924147047",
                "1.000000000000000000000000000000000000000"
            };

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticE(m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNp0p75Test() {
            ddouble[] expecteds = {
                "2.477710158375750016700255445589138128515",
                "2.484542040045383273737267327344449272219",
                "2.491443313913927138869434692904220317022",
                "2.498415224196370770293883547296380915289",
                "2.505459047349383686797028608639823751624",
                "2.512576093169835300361884184104195738039",
                "2.519767705939882878635874247966667349400",
                "2.527035265620996875256728822368846614774",
                "2.534380189099433527474411760736196897691",
                "2.541803931485815208827350051681465165572",
                "2.549307987471639983436778201124110993679",
                "2.556893892745713945589967211443047274835",
                "2.564563225473684121858587629497970915351",
                "2.572317607844046918345523621180368050111",
                "2.580158707684218352715186692252008088023",
                "2.588088240150478752328121742256463354991",
                "2.596107969495847461108143435851480463071",
                "2.604219710920203726108767390122026197940",
                "2.612425332507249801179963133147749823163",
                "2.620726757253213016984293442133247745252",
                "2.629125965192506881429149960936241103992",
                "2.637624995625919115725091420340799298833",
                "2.646225949457269005240398090200201895129",
                "2.654930991644879860053051196911948343098",
                "2.663742353774647270591823679977952449735",
                "2.672662336761952990129593187513720622368",
                "2.681693313690180734349430977757825061284",
                "2.690837732794137320206435388627438365956",
                "2.700098120597274072379357572001743849637",
                "2.709477085212243383265671521225547883263",
                "2.718977319815018218838814697827813286262",
                "2.728601606303553182369674997314566823296",
                "2.738352819152779967041632991033763661627",
                "2.748233929478613715059875855477716674194",
                "2.758248009324606673903330940952804905584",
                "2.768398236185929047001222934453752097134",
                "2.778687897786492339218996695448145309028",
                "2.789120397126266974966552188833439926834",
                "2.799699257817193723811708302868302580109",
                "2.810428129727558865690048190725737850924",
                "2.821310794956308726037147745813718493293",
                "2.832351174160534337035636559192806090152",
                "2.843553333261277315476619472629862121989",
                "2.854921490554911240698552387592488431442",
                "2.866460024259658633373538165521393168354",
                "2.878173480529334240491042398963799312088",
                "2.890066581969185607070528972492949352654",
                "2.902144236691759835840867018264014143651",
                "2.914411547954092495936561385524937735472",
                "2.926873824421226344959115864473449691554",
                "2.939536591105163958805038388156469648559",
                "2.952405601032884839512123506423052148924",
                "2.965486847702065408733056617803531962820",
                "2.978786578388687688653502993361787739643",
                "2.992311308376875524718708860758013535004",
                "3.006067836188131118707996608510567575982",
                "3.020063259894745116972868880501954700089",
                "3.034304994610618366401622146707823546610",
                "3.048800791262174580139644216492546458495",
                "3.063558756752588702500486583518998515209",
                "3.078587375644352811973515148116010978269",
                "3.093895533498419080607011713369190491968",
                "3.109492542022992471925503075110404433849",
                "3.125388166201719453069258673581159373350",
                "3.141592653589793238462643383279502884197",
                "3.158116765987672634484588810957320398650",
                "3.174971813726040889569283066809595156396",
                "3.192169692822721169290747731394975129469",
                "3.209722925302992672622162011428473211997",
                "3.227644703009673219497021314626179164650",
                "3.245948935269103905180708633449925585403",
                "3.264650300824557563469789083949839727327",
                "3.283764304500501213502136356445820250378",
                "3.303307339120644266995220431403044732381",
                "3.323296753271068512679322232472504614018",
                "3.343750925578472034266985880506857834806",
                "3.364689346264467014828589385971633266595",
                "3.386132706842103698631726898292470064691",
                "3.408102998942933202033368759287962972689",
                "3.430623623405081256522575981598915868684",
                "3.453719510918742140223065947190538656273",
                "3.477417255719775135273372385121686776703",
                "3.501745264050243019698793239522836668184",
                "3.526733919373553035012511398021764356800",
                "3.552415766649663661816470462572816342998",
                "3.578825718352854486859773690817808622948",
                "3.606001285363505466222716217203569250053",
                "3.633982836401965728100287969682271473560",
                "3.662813890316611300718105224598576344725",
                "3.692541446314330953343932249974253264227",
                "3.723216358161159703688391362828932722297",
                "3.754893759523223058856396763868388438922",
                "3.787633549014139671105518232990512244807",
                "3.821500945229511012816289105511760523080",
                "3.856567124166056980124539655998436866623",
                "3.892909954051574448872939609151425668051",
                "3.930614845895350913875751766062302351104",
                "3.969775742195951715233063460430946580908",
                "4.010496271465918964865639645597226495667",
                "4.052891102888370590641085968416792490803",
                "4.097087543965707836739217492660174163824",
                "4.143227435080151055441728722329421173936",
                "4.191469409321823850224484589617981745764",
                "4.241991604955771493203345921977413890561",
                "4.294994943193040359614488154675194640390",
                "4.350707117929968843837333107853266190799",
                "4.409387490339156228567125949366475701138",
                "4.471333144798777352444464107304924278278",
                "4.536886451337544602722067458256819621439",
                "4.606444605238025926945572797329331083935",
                "4.680471794739557404098730545469708933328",
                "4.759514911379342146068550498371502728946",
                "4.844224110273838099214251598195914705977",
                "4.935380125293062643123447893401974747617",
                "5.033931175033695836255194969544187016013",
                "5.141043784182555315082498534844279943610",
                "5.258174297007593616076759492674163108337",
                "5.387172037487060787561066292693906862897",
                "5.530432470024246646571468883670993471624",
                "5.691132425460332561445085413733009466640",
                "5.873606252091230580774851191703220955123",
                "6.083977570987410547335711217665777582332",
                "6.331287061746980144368960560637955608074",
                "6.629669289392392127048364623313737750964",
                "7.003015211663010115900904184048593023070",
                "7.496538831993589013284337648603819157035",
                "8.212797131164662505497922794808371830220",
                "9.482884976178598685801026347821389702232"
            };

            const double n = 0.75;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNp0p50Test() {
            ddouble[] expecteds = {
                "1.800473988685746308971971577274643085483",
                "1.804898426013661011343256740050006410364",
                "1.809365720667221539643262472670601089498",
                "1.813876618949480656073798836361705683087",
                "1.818431886106051807309534569512399612605",
                "1.823032306960389888455925318813649597462",
                "1.827678686575665256441728813006553523929",
                "1.832371850944569811371956706404279191532",
                "1.837112647708472935048280017706444033474",
                "1.841901946907429399445983329572091165593",
                "1.846740641762631445198501545449878775060",
                "1.851629649492993527129021789278833039885",
                "1.856569912167661215253118103391272050301",
                "1.861562397596345952455367952009039072962",
                "1.866608100259505377640778437131205511351",
                "1.871708042280515349961962301131989004289",
                "1.876863274442115336087267417308940800377",
                "1.882074877249554190307345403262286647320",
                "1.887343962043019376195174725982138565044",
                "1.892671672162100232719980936889812242028",
                "1.898059184165215943531602550647468234878",
                "1.903507709107132482591656028313036052732",
                "1.909018493877901139525117765445068217627",
                "1.914592822606775541685055707371911330448",
                "1.920232018134905776963527465703572702016",
                "1.925937443560868807249439421220293846288",
                "1.931710503863375522577035132144441361833",
                "1.937552647605798362290600743065332244376",
                "1.943465368727491448594488842032705438418",
                "1.949450208427229871611656784661368804547",
                "1.955508757144478593902739201020368508070",
                "1.961642656644617121028052017030570638061",
                "1.967853602214696611449820735115032303059",
                "1.974143344976794788594032208054177333807",
                "1.980513694326564538467058392202774011720",
                "1.986966520505148491493242890160987392289",
                "1.993503757313258703578110368397539037582",
                "2.000127404976902771489690173074275239087",
                "2.006839533174980901204267929056314185584",
                "2.013642284239788780547667843741549134338",
                "2.020537876542345479203606285010221476727",
                "2.027528608075431693253454925001446439312",
                "2.034616860248280046070309763679215466195",
                "2.041805101908015441621361675668199834028",
                "2.049095893604210372260907717885096129105",
                "2.056491892114309637925910278645444651425",
                "2.063995855249204632788446506409352905044",
                "2.071610646959914362342418172938500892134",
                "2.079339242768175729371344369072091452266",
                "2.087184735545778593471200160517083691782",
                "2.095150341669723354187801998226449115896",
                "2.103239407582754839145030486748807591509",
                "2.111455416791563828654013424545758572624",
                "2.119801997337978049029414120752232224837",
                "2.128282929781823598414231447822850647399",
                "2.136902155737866099541439902484756240385",
                "2.145663787013384605764275086628720872093",
                "2.154572115397543127971171864979844526095",
                "2.163631623158864835677573848153343410761",
                "2.172846994312851475788390574120908567660",
                "2.182223126728204441686122648971420520767",
                "2.191765145147285103109261264553715981200",
                "2.201478415204505120850077504843453566126",
                "2.211368558535383247562617006535848840104",
                "2.221441469079183123507940495030346849307",
                "2.231703330689518500580313543719463678675",
                "2.242160636180265890872850342806649687879",
                "2.252820207948778275550337719514293069032",
                "2.263689220335001996037386258202690828189",
                "2.274775223893960137562171808308428605604",
                "2.286086171780528689613000470458580502273",
                "2.297630448469906695582521163122548824684",
                "2.309416901065151688137349066431409215699",
                "2.321454873475187738880209151988226767180",
                "2.333754243783471579551302913204085862342",
                "2.346325465169825757447960314351498013651",
                "2.359179610796773853956500698661240451062",
                "2.372328423128185548852605110707490221901",
                "2.385784368213530748181187568109065154812",
                "2.399560695547202859969421575730346966036",
                "2.413671504201194640666923520539289936849",
                "2.428131816033310833371372216790840268438",
                "2.442957656895017310356854915556730447526",
                "2.458166146906542963147586509487436920927",
                "2.473775601036364833425443182377642615688",
                "2.489805641423131845902452448605030042071",
                "2.506277323117111366699863963562751911936",
                "2.523213275203690513305869653505644648423",
                "2.540637859613709442085222483552072739318",
                "2.558577350337466814855231084631689244273",
                "2.577060136257537814759546970801072479659",
                "2.596116951420903105594386727310343652300",
                "2.615781137309857184619052473199791294016",
                "2.636088942577818929372620290753535618957",
                "2.657079866834503928577963052489336883382",
                "2.678797056452135204266021735091732095215",
                "2.701287762095351005040349470677451682699",
                "2.724603869850991097776944245385206050925",
                "2.748802520581327204971747895809556496497",
                "2.773946835621603911005954809410012215686",
                "2.800106771428104638172933908972820171837",
                "2.827360131581500623719358947004386708206",
                "2.855793772110422988683197969472847521570",
                "2.885505046047182558698646248543645996640",
                "2.916603546342931845080836525412853177728",
                "2.949213224011889828282488052779490388678",
                "2.983474982464242872931568818398771702413",
                "3.019549882096787224523520375934347354847",
                "3.057623135321011206452538605486303440631",
                "3.097909137354299748638036876829610565496",
                "3.140657871594373122496463824585638275316",
                "3.186163164903645047646893807444600729577",
                "3.234773471249464853158012498200483043296",
                "3.286906170793683540936071283381826634031",
                "3.343066851618606626062947673090788935967",
                "3.403875807878793513889073528093814061192",
                "3.470105249031650587148874590534317834719",
                "3.542732859694054499354613291357503190081",
                "3.623021142666066998133159693830939911148",
                "3.712638994629356155140172280880546984950",
                "3.813855654722725601018092359142685101860",
                "3.929865638331331889629327419438789727660",
                "4.065367295837246049850859614576354955427",
                "4.227676505779574777601391209438225080819",
                "4.429105250459929276011454932665585822315",
                "4.692844330034645603011756639337770859326",
                "5.071221894438481651723831819379051690532",
                "5.732149060091635576281067134097686631742"
            };

            const double n = 0.50;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNm8Test() {
            ddouble[] expecteds = {
                "0.4772507191595812077460399481301857432433",
                "0.4777859516603065096626794459370511224573",
                "0.4783251742277098473505182414980472231723",
                "0.4788684480400609062799383530863344051254",
                "0.4794158357156062938183915793260287924139",
                "0.4799674013584961277070232036794076285195",
                "0.4805232106065650768324344899505903782113",
                "0.4810833306810587077303929704470381125648",
                "0.4816478304384012360650599257482542952273",
                "0.4822167804241063776385916954652735250134",
                "0.4827902529289389647439391362083855931298",
                "0.4833683220474413695637181035907261209702",
                "0.4839510637389455879800471802108294308525",
                "0.4845385558911991184217793835953055173003",
                "0.4851308783867405580092881030974233965212",
                "0.4857281131721691722654553362580041194213",
                "0.4863303443304616185921516178680542489649",
                "0.4869376581564985650053579333699511788472",
                "0.4875501432359741960005110756007226809876",
                "0.4881678905278725933131863736500980352564",
                "0.4887909934507067823648068499589076985086",
                "0.4894195479727289126693152979504390478122",
                "0.4900536527063336660587730909681669639600",
                "0.4906934090068916408568635746411154674241",
                "0.4913389210762652313723370685695482078373",
                "0.4919902960712765070877521781943129107421",
                "0.4926476442174149008863719412172143072074",
                "0.4933110789280922572293996411305476861133",
                "0.4939807169297740975775356860951851357575",
                "0.4946566783933389726051964642421307235087",
                "0.4953390870720426442238283575810066004415",
                "0.4960280704464907463423116206623086913745",
                "0.4967237598770527005727811696648448402559",
                "0.4974262907641812203937821201054110307452",
                "0.4981358027171359552845695410154741563437",
                "0.4988524397316469603250468586442004395039",
                "0.4995763503770940095208671419931176874665",
                "0.5003076879938216162950091356335946422834",
                "0.5010466109012573303837712384113295025047",
                "0.5017932826175528337895589645824403439797",
                "0.5025478720915239900958804602409520091186",
                "0.5033105539477277910521383546447888272171",
                "0.5040815087455816269170130439047844124202",
                "0.5048609232535040800612111886084080130309",
                "0.5056489907391371727560590060281291056269",
                "0.5064459112767984377008453591051841409500",
                "0.5072518920734081618793298347871273376791",
                "0.5080671478142436215984936667513333328856",
                "0.5088919010299891364612578589504618279601",
                "0.5097263824866795126689264560442524909685",
                "0.5105708316002762628058119224262607484500",
                "0.5114254968777723941814917821646295225228",
                "0.5122906363868942624199851419945127923867",
                "0.5131665182566599290031087772404927696465",
                "0.5140534212112648381358803548201026345011",
                "0.5149516351399999351398699495864751597427",
                "0.5158614617061674246058380127125276673732",
                "0.5167832149982484469853985008308201301687",
                "0.5177172222268987303503256185731177430197",
                "0.5186638244717069731744239012606443141244",
                "0.5196233774820511729886889899084882629838",
                "0.5205962525368358888421085657801626652964",
                "0.5215828373683949004581675562946556808553",
                "0.5225835371564062649422743899527183489789",
                "0.5235987755982988730771072305465838140329",
                "0.5246289960633411079458538859978689850043",
                "0.5256746628384045160454323732804039417959",
                "0.5267362624743017738409899903128338987673",
                "0.5278143052426241171053420614052221064246",
                "0.5289093267141668340585001472374044880382",
                "0.5300218894713535219880527287059137807685",
                "0.5311525849685753524825298370203921371531",
                "0.5323020355560797433107559631731915974417",
                "0.5334708966850080016175517574923344575582",
                "0.5346598593134343927900873037629216182556",
                "0.5358696525358480087506843851643376497660",
                "0.5371010464615012524837075558110102553994",
                "0.5383548553704933635184207498476336715099",
                "0.5396319411804463957016860412193155508097",
                "0.5409332172612632231580153194124854431084",
                "0.5422596526408516351282497452930308635925",
                "0.5436122766509995768408377841283393835155",
                "0.5449921840699692619932592416440207968547",
                "0.5464005408270558317439536315953135016209",
                "0.5478385903445910183457780573414555871338",
                "0.5493076606049854989160203492258960208020",
                "0.5508091720447924950215464080679165600313",
                "0.5523446463949324935672054963486642479243",
                "0.5539157166067590971484433480604147463733",
                "0.5555241380283387048212451678962920086947",
                "0.5571718010251314751714687714262387937145",
                "0.5588607452754256401608284928174975800785",
                "0.5605931760149556422474057633041881433362",
                "0.5623714825591308925936894581055088841724",
                "0.5641982594978008390857446831323539413641",
                "0.5660763310398391912942729405746742554034",
                "0.5680087790874332324877616220650648748804",
                "0.5699989757485930550883511213009544918824",
                "0.5720506211587244743301960571270416724230",
                "0.5741677876884130865734174591573922397488",
                "0.5763549718787245814486168161398572652218",
                "0.5786171557862634014982591923926368454441",
                "0.5809598798640149985777342823440732488202",
                "0.5833893300869161495159224856950125597657",
                "0.5859124428042580367185837260766278580557",
                "0.5885370318372869211118056914688050914134",
                "0.5912719437449829868518428194614052871849",
                "0.5941272491082119835384650877045228641010",
                "0.5971144803618001933981066906974956301260",
                "0.6002469304829573538071516164570587486577",
                "0.6035400322582424047523778178403677697086",
                "0.6070118457416954825268464421452381349664",
                "0.6106836932366748439731958786026342988851",
                "0.6145809989108115017135441070047621758552",
                "0.6187344177548641489234606740616594935556",
                "0.6231813825888098726421879325491088899564",
                "0.6279682700411048206224125055837271088383",
                "0.6331535090574421674926271295013071506659",
                "0.6388121719425019550429119336069765334802",
                "0.6450429875939473236710012129407293362150",
                "0.6519794948342567275201967556585576150059",
                "0.6598086690442678633976478218073688023956",
                "0.6688039804299403910322640438164449655846",
                "0.6793888186611709386906191566132769436323",
                "0.6922714910842477126179186721920055236695",
                "0.7087779218945786321211627030743217005419",
                "0.7318804155416557734266990178614049562201",
                "0.7710481350290348289760521087062483185031"
            };

            const double n = -8;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPiNm16Test() {
            ddouble[] expecteds = {
                "0.3542265752067889697702668268736907654293",
                "0.3545405983452070630660382822951281883013",
                "0.3548568323988125633553853079321740517539",
                "0.3551753106306654611267172207674450100869",
                "0.3554960670801823513483377601521525121810",
                "0.3558191365877848806576244888586372620933",
                "0.3561445548205406762695383753053179292737",
                "0.3564723582988452888080923835291701053444",
                "0.3568025844241964797063993395999673207214",
                "0.3571352715081151685228205504195860554735",
                "0.3574704588022705405632503419532344526708",
                "0.3578081865298702158572080966357582021168",
                "0.3581484959183800133888501209615035290344",
                "0.3584914292336417275441186748968198132209",
                "0.3588370298154614865800218322913744918449",
                "0.3591853421147457068480519125448324188726",
                "0.3595364117322664146936483762990150412527",
                "0.3598902854591428056616227115695284472823",
                "0.3602470113191313753949968801731988649420",
                "0.3606066386128228184584219546383511773192",
                "0.3609692179638501830423786133729923242364",
                "0.3613348013672195269457628070114012434869",
                "0.3617034422398815825802409125231216959082",
                "0.3620751954736707488794769289792498954990",
                "0.3624501174907461329096018374590476529606",
                "0.3628282663016784151672225879010677673595",
                "0.3632097015663360665285305195726336852986",
                "0.3635944846577349636370655431301689407066",
                "0.3639826787290268014021682187898146538149",
                "0.3643743487838139612716881735620628390777",
                "0.3647695617499917446814877478537282035718",
                "0.3651683865573332136592466258944807389268",
                "0.3655708942190473954681866681981610146348",
                "0.3659771579175584164041383955282711161612",
                "0.3663872530947713541005364603101878751149",
                "0.3668012575471103737249491197144109898207",
                "0.3672192515256361916744125331698299636865",
                "0.3676413178415732575887847632991186951580",
                "0.3680675419776024468686876220397043267087",
                "0.3684980122053027172004646918878170365154",
                "0.3689328197091553328312536602791767080912",
                "0.3693720587175571545694683431188841297223",
                "0.3698158266413254161765295152038629544997",
                "0.3702642242202156766047447708018701131739",
                "0.3707173556780176075453481872895491032381",
                "0.3711753288868403445086461041136045930794",
                "0.3716382555412507427419476473262715097244",
                "0.3721062513429845367955495484113476863514",
                "0.3725794361970126665181271828594067054642",
                "0.3730579344198135352488784436681054939785",
                "0.3735418749607774208829727823446150530670",
                "0.3740313916377524719679497836630630101029",
                "0.3745266233878335985931257381054338816548",
                "0.3750277145345971412666110770076414703825",
                "0.3755348150730966377960737453166148039377",
                "0.3760480809740596344046027902305262345968",
                "0.3765676745088638113599517227635581686075",
                "0.3770937645970244341541682204013337210186",
                "0.3776265271780962608314401129687848307028",
                "0.3781661456100837781418820326865433939020",
                "0.3787128110966665742769208595476161043524",
                "0.3792667231457847344052633178983819958284",
                "0.3798280900623957600943408142443421947070",
                "0.3803971294785135748121039177075702617302",
                "0.3809740689239761997006901461043671775548",
                "0.3815591464417668907178524619400741281698",
                "0.3821526112521399780799848642554061661191",
                "0.3827547244702843826512496074072172448878",
                "0.3833657598828030037610245643135419807150",
                "0.3839860047889044567981512522975613989416",
                "0.3846157609129061986114768256994019193147",
                "0.3852553453954480719715219872038563468616",
                "0.3859050918717282090409625350917361618973",
                "0.3865653516461173240088668093077092705911",
                "0.3872364949737043080094072356652714676856",
                "0.3879189124607013583813788229265331950017",
                "0.3886130165972211479705943848405993683399",
                "0.3893192434377682026983165255855680368265",
                "0.3900380544469053433327152337780575428720",
                "0.3907699385300161971044076787086160057152",
                "0.3915154142719496271618903097782840238564",
                "0.3922750324096779838656856817382917608122",
                "0.3930493785690213030169172091349491966154",
                "0.3938390763000973117156533003404067811126",
                "0.3946447904515911364923365957823835485248",
                "0.3954672309303695836271565558945027150937",
                "0.3963071569006035175714046122169159729773",
                "0.3971653814856696533524427568708101634963",
                "0.3980427770470059309880775660130147379204",
                "0.3989402811272008964759613881262167395288",
                "0.3998589031604214582230472084699479958930",
                "0.4007997320724762961288237168568051580418",
                "0.4017639449162035978418420024315845178791",
                "0.4027528167165246519219673481123416548364",
                "0.4037677317347899407303255875229953089795",
                "0.4048101964057414031317396965574558510931",
                "0.4058818542548503098793628735228311314932",
                "0.4069845031720297231233541714046555467042",
                "0.4081201155038331329241255261540242582064",
                "0.4092908615356846552480979300884779733770",
                "0.4104991370758000335398829027811157886897",
                "0.4117475960332856301864411731467689698273",
                "0.4130391891182642859931068951102394998640",
                "0.4143772101010110022358111765828723717951",
                "0.4157653514770792555618789758836778020214",
                "0.4172077719348819699027446593653257122505",
                "0.4187091787669518886827344961344373247640",
                "0.4202749293878987401932667042550678728281",
                "0.4219111575425661682604285984097352815613",
                "0.4236249317911750911896962596576775691421",
                "0.4254244567280522669859618692534941080165",
                "0.4273193315729648293826662244217834324986",
                "0.4293208869859941945970382551385692394797",
                "0.4314426303785956501380136714427118970961",
                "0.4337008446212792085113113518040517307787",
                "0.4361154083614884626541260897253483182115",
                "0.4387109444361190735263640266458923491067",
                "0.4415184678411846928620674127368619246033",
                "0.4445778194028066896469266837200943513342",
                "0.4479413830330300434124801870458620092113",
                "0.4516799967467888860720217171915305933230",
                "0.4558928233024906628095343015701186790801",
                "0.4607248665793401762284536394916731973392",
                "0.4664005743574717014168908602266501961169",
                "0.4732953534235920596121060773239388864953",
                "0.4821117968935886669491754498757764257117",
                "0.4944245469887573911787111012159280014050",
                "0.5152489276895301866838960698192101526192"
            };

            const double n = -16;

            for ((int i, double m) = (0, -1); i < expecteds.Length; i++, m += 1d / 64) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPikp0p50Test() {
            ddouble[] expecteds = {
                "1.273127366749682458457242076742137073923",
                "1.295194371905845737977491679541386245137",
                "1.318392448035165743335469926777351472368",
                "1.342820149970936946892889132297376058227",
                "1.368588402655798261557765235426432137764",
                "1.395822563509194836214967562275190260786",
                "1.424664920134002376744608274248921002541",
                "1.455277736109770624940153404969791583960",
                "1.487846992668798385273647399274200838436",
                "1.522587021970573511530486711405225924954",
                "1.559746293997188377767884976746364571245",
                "1.599614712040483317589343581441262757638",
                "1.642532903889501906603379213134398489871",
                "1.688904186573328262746388750580468825330",
                "1.739210162503567690434322364044336403835",
                "1.794031323445906952213675586602684741410",
                "1.854074677301371918433850347195260046218",
                "1.920211408820190510760734917078775722850",
                "1.993529178569172786463995681929176692142",
                "2.075406284800636499869837852859249294836",
                "2.167619360766555959906157571538397474939",
                "2.272504106750153651892019032827114255050",
                "2.393202910648986418866807734689289821143",
                "2.534060838288938875273316576944921354912",
                "2.701287762095351005040349470677451682699",
                "2.904127190453591811829134902120060406245",
                "3.157063680838831730355125798734162388831",
                "3.484369010741340448548683595079273163403",
                "3.930614845895350913875751766062302351104",
                "4.589324472266679104452228820118524097738",
                "5.703926819342179010742891747919890544549",
                "8.247440865028414790022890733102253908200",
                ddouble.PositiveInfinity,
                "-0.7647362249771694174615956562074478803597",
                "-0.6971275269780212398425394580048101873257",
                "-0.6406570814199184054054669633169909241845",
                "-0.5927557565671168484352030695899994231555",
                "-0.5515937067558188051860342200833369100622",
                "-0.5158308825781386631675168213715877416355",
                "-0.4844626019486762473464463135499947944228",
                "-0.4567203134529098970084643370829238800265",
                "-0.4320057611091444213724842748758170216573",
                "-0.4098460916443693863901492105588754859035",
                "-0.3898625007494928311352360892358059804284",
                "-0.3717478692541456521565374422562549650681",
                "-0.3552505110115043328294206926665017485079",
                "-0.3401621637088261307965788659520815978884",
                "-0.3263089809547146809487801461317816759328",
                "-0.3135446834651840414723072243431374287215",
                "-0.3017452873893046888550409502414468784517",
                "-0.2908050007878879349419147446644840617502",
                "-0.2806329963880725578408870472133672181111",
                "-0.2711508493635452124702768516056716479295",
                "-0.2622904852577706735610432800961771835533",
                "-0.2539925231349728636815230255729534381563",
                "-0.2462049277536119341938404622896019959021",
                "-0.2388819054305036044280636753429692720023",
                "-0.2319829936102912594235023944493032164768",
                "-0.2254723055562216865204674835177669719142",
                "-0.2193179001311052878138522072486348622787",
                "-0.2134912531121647706509842199916643155337",
                "-0.2079668114270963566885103906818160472605",
                "-0.2027216155035649014274415831483486139324",
                "-0.1977349778750052913179993653914855038363",
                "-0.1929882084901393291562091485620521822969",
                "-0.1884643789856659064580408405045395871041",
                "-0.1841481196154850330711994540762594285348",
                "-0.1800254436713505786978991776210259706388",
                "-0.1760835951438428476977843962853172728698",
                "-0.1723109161083573884644736462611209430952",
                "-0.1686967309162357531745511140687002546136",
                "-0.1652312447553812491847371991492728250075",
                "-0.1619054545403376169581458683745350949144",
                "-0.1587110704165226071476242257710744969416",
                "-0.1556404464309625462238129936055286105227",
                "-0.1526865191434041762430997880235953270024",
                "-0.1498427531357584983532822707926296252390",
                "-0.1471030925313684976342830715239112930516",
                "-0.1444619177641208089563472447418606706458",
                "-0.1419140069453894693500188705232252082264",
                "-0.1394545012678008680301453347339166459247",
                "-0.1370788739617565813610693034975507853908",
                "-0.1347829023859172495627565895631065714478",
                "-0.1325626428883748504264885897602269225444",
                "-0.1304144081226130732471324792123243779456",
                "-0.1283347465428852412005300568404085041493",
                "-0.1263204238384078460383824818032712248907",
                "-0.1243684060956715229707904210752568598290",
                "-0.1224758445039553717407456493324976525941",
                "-0.1206400614414163636874287900213990843814",
                "-0.1188585377984329690972524675273220491156",
                "-0.1171289014116471395987497492133148886610",
                "-0.1154489164967381902478063520363126605603",
                "-0.1138164739806853365478367815993986784214",
                "-0.1122295826453943019572308542594933019092",
                "-0.1106863610042993573677285857744185191810",
                "-0.1091850298420939298478528916321385902289",
                "-0.1077239053552511555441117341358098049219",
                "-0.1063013928376076204032023325626660760674",
                "-0.1049159808611164302670226336046649769891",
                "-0.1035662359070303753304219377348924911011",
                "-0.1022507974073388577920356266784803223406",
                "-0.1009683731603279891127434814538602868745",
                "-0.09971773508772617991745394273101268629012",
                "-0.09849771530409328506800765277596056291430",
                "-0.09730720247195813972057741315033549809793",
                "-0.09614513841874897780834947327632897479759",
                "-0.09501051499383015396138916833863754109338",
                "-0.09390237114598849547514538583911661103872",
                "-0.09281979020353115696053126470733511464622",
                "-0.09176189734078821822142318141690024190937",
                "-0.09072785721627862735618465835332877200827",
                "-0.08971687176911601213209457120342455996999",
                "-0.08872817816141766987317276927406997835406",
                "-0.08776104685555004324102582673971574014711",
                "-0.08681477981600983246078946407123701701796",
                "-0.08588870882661273160222035110367360722352",
                "-0.08498219391445145633099869258124775500089",
                "-0.08409462187279996640789936726809641417368",
                "-0.08322540487578929728037592583828226500364",
                "-0.08237397917826904887192095785575152704705",
                "-0.08153980389480341827661497683054519376819",
                "-0.08072235985223711571930309618710269334749",
                "-0.07992114851070938655381158733390903623971",
                "-0.07913569094839797056897258846656198742019",
                "-0.07836552690564299661571497859005111206353",
                "-0.07761021388443696107083579210890690919077",
                "-0.07686932629957413763130548131695806821976",
                "-0.07614245467803375838102829657467843726735",
                "-0.07542920490342855331451967903175162794805",
                "-0.07472919750258594688365748713240935910481",
                "-0.07404206697154537090799141047690421052127",
                "-0.07336746113845354909300090990894875242985",
                "-0.07270504056102184733553610579374146755200",
                "-0.07205447795637731517818981293111749803053",
                "-0.07141545766129317467278168636742853391229",
                "-0.07078767512092642424205809528672115235686",
                "-0.07017083640432098414007996846098867686858",
                "-0.06956465774505538238895826292446391200151",
                "-0.06896886510552524000445544414089450381316",
                "-0.06838319376345355443297995561352691871416",
                "-0.06780738791931671934514400386254950011393",
                "-0.06724120032346201001535686668191901222547",
                "-0.06668439192177349961710938663955721978696",
                "-0.06613673151881859232688456988351567663195",
                "-0.06559799545747705515886083066246679932531",
                "-0.06506796731411904921468172547651573885525",
                "-0.06454643760845861027509986461590387585772",
                "-0.06403320352726468039104180829363394512902",
                "-0.06352806866116348600961954978195859796604",
                "-0.06303084275381410455126885730728351864809",
                "-0.06254134146278374402633168707825589016431",
                "-0.06205938613149083892731998658992307922670",
                "-0.06158480357162277805337668684496091783010",
                "-0.06111742585547114402250386081201327811165",
                "-0.06065709011766095982274541258622414986451",
                "-0.06020363836578178820090536240114843051646",
                "-0.05975691729945778334804633649122093171277",
                "-0.05931677813742110591062268507614173749797",
                "-0.05888307645217862406592995850914062958547",
                "-0.05845567201188566610526795493893418710665",
                "-0.05803442862906288413157316963533309250084",
                "-0.05761921401581314506693402235327425832461",
                "-0.05720989964521488646002032982826100345578",
                "-0.05680636061858665491528354183042795213395",
                "-0.05640847553833467138602408027118074381153",
                "-0.05601612638611132046197790407241617551151",
                "-0.05562919840602751440150493995107067575420",
                "-0.05524757999267600565845077268635371242314",
                "-0.05487116258373597753080922184328440075635",
                "-0.05449984055694169007495666183214960050363",
                "-0.05413351113120965199647728072347709774973",
                "-0.05377207427172977925519761217005224451932",
                "-0.05341543259883633433353576761103224441316",
                "-0.05306349130048415984766104351042403606395",
                "-0.05271615804816486663956905312994043268960",
                "-0.05237334291610624700385010377895132181506",
                "-0.05203495830360629294771454258986202391748",
                "-0.05170091886036083957697551863047947781607",
                "-0.05137114141465105480055635816573145970211",
                "-0.05104554490426378641665084450177978236668",
                "-0.05072405031002418221677060181375050464884",
                "-0.05040658059182604216370164795941926253666",
                "-0.05009306062705106645591102607925066075094",
                "-0.04978341715127355034302576193948647015140",
                "-0.04947757870115216544530676913927816858988",
                "-0.04917547555941527628109728895964278705848",
                "-0.04887703970185078672829173729968588616012",
                "-0.04858220474621581011722217526934980299177",
                "-0.04829090590298552340270903896900957480425",
                "-0.04800307992786441424861739904368778754783",
                "-0.04771866507598677283118539473964829945548",
                "-0.04743760105773672983956156489015671312660",
                "-0.04715982899612140985425715320988823613653",
                "-0.04688529138563386562101570101646988605425",
                "-0.04661393205254539363744218848166293179491",
                "-0.04634569611656961423195577778333726597900",
                "-0.04608052995384333865264477931661559131695",
                "-0.04581838116117174976494206869584929544303",
                "-0.04555919852148779944045700702091241235792",
                "-0.04530293197047798178915324297381909063728",
                "-0.04504953256432878378519179276808549955035",
                "-0.04479895244855014989206223093988808315472",
                "-0.04455114482783423094849639913798132784147",
                "-0.04430606393690952541646893089405215388599",
                "-0.04406366501235226836334593837678586922243",
                "-0.04382390426531858518458222887520112735660",
                "-0.04358673885516250770998777604448351616435",
                "-0.04335212686390645433925645411785564573774",
                "-0.04312002727153220732769833024086654950806",
                "-0.04289039993206178315667536745766044619475",
                "-0.04266320555039888971537581753339524289226",
                "-0.04243840565990290022034519380300977252854",
                "-0.04221596260066845163779336639568539549626",
                "-0.04199583949848489789678683612297356235968",
                "-0.04177800024445091826073703365573954572741",
                "-0.04156240947522060156867193051478805116452",
                "-0.04134903255385830022209162789375294006000",
                "-0.04113783555128047618951424177859427131257",
                "-0.04092878522826364720593663771638424330891",
                "-0.04072184901799838690844543158393516325688",
                "-0.04051699500917013990311522804410444169808",
                "-0.04031419192954838362119883958562276004336",
                "-0.04011340913006640510829661903959830468954",
                "-0.03991461656937466431357395846244660367172",
                "-0.03971778479885138762896055717121605180141",
                "-0.03952288494805467790478090550731508954042",
                "-0.03932988871060104139012548346034151776008",
                "-0.03913876833045581938750734556243854671669",
                "-0.03894949658862157417283878866489063600261",
                "-0.03876204679021101614546457083508232641822",
                "-0.03857639275189157340590053293154182763164",
                "-0.03839250878968919711680919556823275608379",
                "-0.03821036970713946713360686706320052116156",
                "-0.03802995078377451348847501976794610157228",
                "-0.03785122776393470131757697643808623845353",
                "-0.03767417684589444062958142275244241611253",
                "-0.03749877467129187877198899066639393304416",
                "-0.03732499831485261336481818637247439337228",
                "-0.03715282527439792760264834845216753107286",
                "-0.03698223346112839890095413914126136231684",
                "-0.03681320119017406656972918250626201805672",
                "-0.03664570717140266519072710761818053190420",
                "-0.03647973050047773827577403422242443015781",
                "-0.03631525065015874218320737204533032729091",
                "-0.03615224746183553372906675248689842638284",
                "-0.03599070113728990698308032196340968275703",
                "-0.03583059223067710589448663795142115550807",
                "-0.03567190164072049013228942713830192058620",
                "-0.03551461060311277230819787014272670489235",
                "-0.03535870068311747601559106929233442657503",
                "-0.03520415376836448628065352286132324185609",
                "-0.03505095206183377747870932173041606083961",
                "-0.03489907807502160889718350556614737866750",
                "-0.03474851462128367528606257103824848289172",
                "-0.03459924480934988926973604005011787069433",
                "-0.03445125203700565472707448142465941600354",
                "-0.03430451998493466549063211085020212644577",
                "-0.03415903261071843226752748713579643746311",
                "-0.03401477414298790282664149350773140759933",
                "-0.03387172907572269649897572340612940691436",
                "-0.03372988216269362415760317030784347653348",
                "-0.03358921841204430932607447441874016431702",
                "-0.03344972308100786514365465833573001695692",
                "-0.03331138167075471581593227980469281467899",
                "-0.03317417992136778011360482443642056601909",
                "-0.03303810380694135865440434018407653687703",
                "-0.03290313953080018630782565010058365430942",
                "-0.03276927352083522628547999286812965562267",
                "-0.03263649242495289349915187265387904376382",
                "-0.03250478310663450175372851439326008741252",
                "-0.03237413264060283245533269833126048801932",
                "-0.03224452830859282191130575016292223073535"
            };

            const double m = 0.5;

            for ((int i, double n) = (0, -1); i < expecteds.Length; i++, n += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }

        [TestMethod]
        public void EllipticPikm0p50Test() {
            ddouble[] expecteds = {
                "1.018679933006156206673666921948332671513",
                "1.034165636442310997560557406703997171325",
                "1.050404405371665445969962294375484231518",
                "1.067459935872995747175247877857406645986",
                "1.085403764550017059523667424014996718234",
                "1.104316557660372407360532879884443725054",
                "1.124289669521413018252678053984863984915",
                "1.145427039359732012349036379261188289733",
                "1.167847517129878574684334559323008027609",
                "1.191687737986230995280175540942983481716",
                "1.217105705378768709093384540830677508148",
                "1.244285299130520995334386949303841940309",
                "1.273442004891368949163519445837629156313",
                "1.304830276716713842317472202537926299540",
                "1.338753113570048027480913380698348512742",
                "1.375574682864915459752475703197893747361",
                "1.415737208425956198892165965423613532473",
                "1.459783938678718417913112898465160565544",
                "1.508390966318892902982634129425416295098",
                "1.562412239322241076670658968084044747811",
                "1.622944760954741603710555258247964135990",
                "1.691425644502004606860765492404867798806",
                "1.769781233475969665870651165674537083809",
                "1.860664911836072739043218447248966496025",
                "1.967853602214696611449820735115032303059",
                "2.096945603784697201241948157208851752056",
                "2.256674414710741256710499684941067386284",
                "2.461605753491579880711829077171714192593",
                "2.738352819152779967041632991033763661627",
                "3.142453622443274381631419018198184552488",
                "3.817599906505218640221138189610972753222",
                "5.334144700788700541592419802683252100729",
                ddouble.PositiveInfinity,
                "0.2368567199393162538308382416105803018580",
                "0.2267732022357675704672683968753126568353",
                "0.2175205055864422527497506268892575711542",
                "0.2089991480668273132461351154815422193598",
                "0.2011250507409175854161743109939591914478",
                "0.1938266441132708773495191608245786068627",
                "0.1870426081678610862595142929067152885417",
                "0.1807200886806956640477231757240570887252",
                "0.1748132759025122649577949107349903567190",
                "0.1692822620064977146874446738272718354616",
                "0.1640921151662461272290787619289309807217",
                "0.1592121235552894117082997336725284250352",
                "0.1546151737844698936341540598397332116011",
                "0.1502772365573237111197232208447025252707",
                "0.1461769384736720724025227313851004414693",
                "0.1422952035345872497286465195859843761598",
                "0.1386149514095370616709381766091859137424",
                "0.1351208422111597746199874238536523322394",
                "0.1317990595946748883390522285599726174827",
                "0.1286371256096605527127967201173414282514",
                "0.1256237419933620683798540948044867691580",
                "0.1227486535892861150695366823435902702687",
                "0.1200025303640510278454537412504679830559",
                "0.1173768651255033250414888945822819419456",
                "0.1148638845509617177122386248822197226101",
                "0.1124564715427992961758572017081294750713",
                "0.1101480972599181315158062152553041064040",
                "0.1079327614438506915725853611201677796795",
                "0.1058049398795605163464990750400295255772",
                "0.1037595380131493356100167977467154102966",
                "0.1017918498991916895382357285553144428753",
                "0.09989752177530769231497388055674794568775",
                "0.09807251966561634600010820658728717815038",
                "0.09631310050169293035780522589847386353270",
                "0.09461578632263953499066526983865145395637",
                "0.09297734117733024904146702042343331920943",
                "0.09139475040380521401345840482954472736635",
                "0.08986520200478086552360886337200953974126",
                "0.08838606987563933078328840003644086889485",
                "0.08695489867314104299368676221507160567299",
                "0.08556939014036145725585042662928879299394",
                "0.08422739072671977166696446695728655420569",
                "0.08292688036205275198822273805675773455812",
                "0.08166596226099505039501094879160911805540",
                "0.08044285364887945455586605697075796374178",
                "0.07925587731331782439804533842570912087337",
                "0.07810345389686068524593008090572720962495",
                "0.07698409485590817141125258472526501973021",
                "0.07589639601956595538736931384200060634793",
                "0.07483903168958332127928118157870980507451",
                "0.07381074922902607389167920992660489604490",
                "0.07281036409305143632910891052059317535058",
                "0.07183675526017354294405883181986833669369",
                "0.07088886102682880758088135165104267468128",
                "0.06996567513194922969254001403634317744925",
                "0.06906624318169622563023279362717920565810",
                "0.06818965934755594565839987389345519894251",
                "0.06733506331369928582975249260235510404779",
                "0.06650163745190908625876242707242231049130",
                "0.06568860420451063059251959197187995478805",
                "0.06489522365764183679022519394122601475034",
                "0.06412079128889449364791985919727318739870",
                "0.06336463587487192351696616964809850736478",
                "0.06262611754556276443922446475740397788521",
                "0.06190462597364368055783090073526625035518",
                "0.06119957868791190840045275377788930033744",
                "0.06051041950102579089156611846764124930775",
                "0.05983661704261025695233231175766753673203",
                "0.05917766338957547473734968166531372815662",
                "0.05853307278621022886521504796361111970966",
                "0.05790238044725539096798128947320338844388",
                "0.05728514143774461691360839515968178694029",
                "0.05668092962392569230852445076207945063646",
                "0.05608933669005257985532364119132916317370",
                "0.05550997121627035239274452405080755324778",
                "0.05494245781320739570171387728029813122960",
                "0.05438643630924559549747665823726334174444",
                "0.05384156098676329374366422118430541725449",
                "0.05330749986394082488627811533656785192168",
                "0.05278393401898728817212427915801135591201",
                "0.05227055695389243519263912584545201650091",
                "0.05176707399503143723006857639472843107726",
                "0.05127320172815488900440874193967351740519",
                "0.05078866746548353468904575154276655829852",
                "0.05031320874279850988041816723211444384909",
                "0.04984657284457485268789709745128806114890",
                "0.04938851635534997182114762348552765045059",
                "0.04893880473565085992912133690090160053791",
                "0.04849721192092517827417803016993653013463",
                "0.04806351994203288003439032204812992841244",
                "0.04763751856595765549482585436297849377076",
                "0.04721900495549195995403419283759024538187",
                "0.04680778334673643550864387718309556115917",
                "0.04640366474333480436658565161328851671289",
                "0.04600646662643937655595469980428680304127",
                "0.04561601267947070683537953741588105098088",
                "0.04523213252679813321606613727138394870254",
                "0.04485466148552636759927417766548067093721",
                "0.04448344032962738271881382292203358513564",
                "0.04411831506570690816538339740819931685592",
                "0.04375913671974123878332629954482601170641",
                "0.04340576113416306905159804753728141295228",
                "0.04305804877471496873770178017054089545591",
                "0.04271586454652615588172507496662560163373",
                "0.04237907761890262921110767667821827053962",
                "0.04204756125835270006711884006268181483718",
                "0.04172119266939970280533974224102807981721",
                "0.04139985284276133532227411786678190237248",
                "0.04108342641050084618692922440381620684679",
                "0.04077180150777928690025474800556640122547",
                "0.04046486964086042009968189798035708381323",
                "0.04016252556104073913969026222571978511153",
                "0.03986466714419652349608972497539588279886",
                "0.03957119527565803084472007416380846168622",
                "0.03928201374013790513755564995594310934641",
                "0.03899702911645674764827174308920686577594",
                "0.03871615067682363497380457830529135946825",
                "0.03843929029044324822342185588655278857082",
                "0.03816636233123426918415955405141822004352",
                "0.03789728358945586491034945974133603343732",
                "0.03763197318705047988768388983895569739495",
                "0.03737035249652183816971560835176681211468",
                "0.03711234506317707610521814269623022071294",
                "0.03685787653057132516019090886345057328855",
                "0.03660687456900188614976907379343221271294",
                "0.03635926880690742004282955082072208646014",
                "0.03611499076503536259895008562110420245487",
                "0.03587397379324808399272408419328259104354",
                "0.03563615300984519137171115001745713303870",
                "0.03540146524328584082147255041365409092982",
                "0.03516984897620101223431515370601649406825",
                "0.03494124429159143094040833392438328802834",
                "0.03471559282111221673536738921302733839603",
                "0.03449283769535042556985536151770373088580",
                "0.03427292349600644159012625804298884375874",
                "0.03405579620989469597763570600176745283978",
                "0.03384140318468345138821173450802308053155",
                "0.03362969308629741280434016101039821939476",
                "0.03342061585791072225455423702862635291451",
                "0.03321412268046148006933847535906625699289",
                "0.03301016593462232213715038929494627853480",
                "0.03280869916416478312635686990897140213195",
                "0.03260967704065820116752379677933456832258",
                "0.03241305532944678061203831531273859883079",
                "0.03221879085685113606612079082292338422000",
                "0.03202684147854320216470501191280992517016",
                "0.03183716604904581811653328236882410518994",
                "0.03164972439231059198011373002961840114334",
                "0.03146447727332982446013154619416228504349",
                "0.03128138637074033280228944679535395150160",
                "0.03110041425037896871837494588803043879046",
                "0.03092152433975147638091746159362571551420",
                "0.03074468090337809318650029584106198352743",
                "0.03056984901898096263376596730064355959836",
                "0.03039699455448001039296397267137283002422",
                "0.03022608414576543623941606318186417972339",
                "0.03005708517521640046992177672082650802674",
                "0.02988996575093683793050970112354968224116",
                "0.02972469468668061981114060311738666634986",
                "0.02956124148243950662349381579402223081249",
                "0.02939957630566849876349563100087665676576",
                "0.02923966997312429705325786512962987036209",
                "0.02908149393329363774446966064447064322038",
                "0.02892502024938926755096081251675593953186",
                "0.02877022158289227709488341681389916468849",
                "0.02861707117762041827126249650207027928348",
                "0.02846554284430289488203265919977047776092",
                "0.02831561094564293874505584520780240214233",
                "0.02816725038185026749626463347458717698099",
                "0.02802043657662626750081527971843936372095",
                "0.02787514546358545758303414208014030121328",
                "0.02773135347309746847749539279603576206727",
                "0.02758903751953442069539294410101654040928",
                "0.02744817498890920149645284821185382617028",
                "0.02730874372689073137217015360877055161658",
                "0.02717072202718287331200398298412647842249",
                "0.02703408862025417549194170824691473559006",
                "0.02689882266240615117168446478048643793315",
                "0.02676490372516828971972575782941783663053",
                "0.02663231178500846094605137924244536857366",
                "0.02650102721334782238938650636403397199209",
                "0.02637103076686976690085578002070582616517",
                "0.02624230357811285675472169018236160281294",
                "0.02611482714633808151396250115076987030497",
                "0.02598858332866115084960102904820311284103",
                "0.02586355433144089127779232784824613891870",
                "0.02573972270191515811438719316768166148582",
                "0.02561707132007600158892240731227920886484",
                "0.02549558339077613970623036350307660902312",
                "0.02537524243605909075534137788169100840681",
                "0.02525603228770560596909757118657720531085",
                "0.02513793707998931832864976576217953325030",
                "0.02502094124263478744903168081114337981794",
                "0.02490502949397137341077951292048304163984",
                "0.02479018683427661482638227596754316522095",
                "0.02467639853930301883181254305094239375864",
                "0.02456365015398239353082297205730048637711",
                "0.02445192748630206712847322562219756413964",
                "0.02434121660134754298414253626183996153876",
                "0.02423150381550633648622417873158449458008",
                "0.02412277569082792837450600768356879625041",
                "0.02401501902953495026725225094285628125294",
                "0.02390822086868089202615377313930746958350",
                "0.02380236847494978753507179259936633279938",
                "0.02369744933959349578372740495862405407094",
                "0.02359345117350234812627160232193117546029",
                "0.02349036190240508050409027598140464990814",
                "0.02338816966219411154606730967113673217322",
                "0.02328686279437236403907699591521192237758",
                "0.02318642984161795853600637860884337137237",
                "0.02308685954346323406610683054562052700878",
                "0.02298814083208467225019771876087573386112",
                "0.02289026282820041780826517766321094616481",
                "0.02279321483707220067672245044208835610852",
                "0.02269698634460857291525658502328678593802",
                "0.02260156701356647745829933898488832188578",
                "0.02250694667984826572497410618850578694578",
                "0.02241311534889137730727224682848795253684",
                "0.02232006319214798756512057588865402731335",
                "0.02222778054365201811773942624262306196928",
                "0.02213625789667099107533437434775440613041",
                "0.02204548590044029053937758322459725363628",
                "0.02195545535697747454308099484214422975269",
                "0.02186615721797435732990646008300617826599",
                "0.02177758258176465579534166773027055047355",
                "0.02168972269036506515868833699129648928223",
                "0.02160256892658769759525548011888944268811",
                "0.02151611281122188374836275433126398468279",
                "0.02143034600028340085364412591596411372693",
                "0.02134526028232925273969337346332267826041",
                "0.02126084757583618630939434565123632551877",
                "0.02117709992664118634169960570141546425770",
                "0.02109400950544224566680010477351361565515",
                "0.02101156860535776103764959851089614659607",
                "0.02092976963954295642336543964455035648840",
                "0.02084860513886178505758577365816005663960",
                "0.02076806774961280945680440112651662530496",
                "0.02068815023130760484647214509554114111059",
                "0.02060884545450027605988738745634710405266",
                "0.02053014639866672106756341136883461915347"
            };

            const double m = -0.5;

            for ((int i, double n) = (0, -1); i < expecteds.Length; i++, n += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.EllipticPi(n, m);

                Console.WriteLine(m);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-29);
            }
        }
    }
}
