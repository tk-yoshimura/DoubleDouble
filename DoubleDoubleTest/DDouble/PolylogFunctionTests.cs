using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using PrecisionTestTools;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class PolylogFunctionTests {
        [TestMethod]
        public void PolylogTest() {
            ddouble[] nm4_expecteds = {
                "-0.08832000000000000000000000000000000000000",
                "-0.09198552153397338556588349429403080652453",
                "-0.09569084273286326596796008560239311917658",
                "-0.09941572846787500171067538012000093966371",
                "-0.1031346847533404460702128740537519687040",
                "-0.1068158362587017314214315463794847385018",
                "-0.1104195704215283651804371848714342359829",
                "-0.1138969014569497232339023655645926437994",
                "-0.1171875000000000000000000000000000000000",
                "-0.1202173267380510166019243812015242785230",
                "-0.1228958024691358024691358024691358024691",
                "-0.1251124449439668153159045356259661513843",
                "-0.1267329089070030344499315761289938716011",
                "-0.1275943875028251280742149907306528643610",
                "-0.1275003837939309386387569924560926276552",
                "-0.1262149632000000000000000000000000000000",
                "-0.1234567901234567901234567901234567901235",
                "-0.1188936015373947597261364100701283321911",
                "-0.1121383909444834245052809358526181147587",
                "-0.1027496626552575462751778175907011114564",
                "-0.09024000000000000000000000000000000000000",
                "-0.07410042974856821152950669581466653796960",
                "-0.05385357923080831174109637758471777676167",
                "-0.02915786589776294373306607637247976380720",
                "0",
                "0.03296395061728395061728395061728395061728",
                "0.06782888082346641280418873088594038198370",
                "0.1005136105447719186733927114165901323214",
                "0.1234567901234567901234567901234567901235",
                "0.1244326331410546969593482809793171107289",
                "0.08832000000000000000000000000000000000000",
                "0.01422547375908144083727074124879337499365",
                "0",
                "0.6211697506991134646278336407449277086928",
                "4.691358024691358024691358024691358024691",
                "26.44224000000000000000000000000000000000",
                "150.0000000000000000000000000000000000000",
                "1046.419753086419753086419753086419753086",
                "12180.00000000000000000000000000000000000",
                "565320.0000000000000000000000000000000000",
            };
            ddouble[] nm3_expecteds = {
                "-0.006400000000000000000000000000000000000000",
                "-0.003537587515739541228844824657296209412732",
                "-0.0004604016236830595222565818248785690717536",
                "0.002847140667210554482779227611715322216181",
                "0.006401463191586648376771833561957018747142",
                "0.01021974177426072469804248229904206580591",
                "0.01431975191867913458890578417404006178087",
                "0.01871962803593156711113134854682563172420",
                "0.02343750000000000000000000000000000000000",
                "0.02849096014059236335719490948229655849732",
                "0.03389629629629629629629629629629629629630",
                "0.03966740234786456867920953623807227961729",
                "0.04581424406497292794668887963348604748022",
                "0.05234071138658853946157710827730641783378",
                "0.05924162319246524981618290676096775322993",
                "0.06649856000000000000000000000000000000000",
                "0.07407407407407407407407407407407407407407",
                "0.08190365243120200399512580358131939208336",
                "0.08988457072604330305307014548186599276006",
                "0.09786045937649436191710244188378299165471",
                "0.1056000000000000000000000000000000000000",
                "0.1127677043607707123180454416402575179748",
                "0.1188843164151806127114769090077732053041",
                "0.1232743860825421151566671854982579231571",
                "0.1250000000000000000000000000000000000000",
                "0.1227851851851851851851851851851851851852",
                "0.1149521032902957101207830070803831736776",
                "0.09943629424740030110990511536710899478310",
                "0.07407407407407407407407407407407407407407",
                "0.03770234273615190219247319172187692097534",
                "-0.006400000000000000000000000000000000000000",
                "-0.04023776863283036122542295381801554641061",
                "0",
                "0.3231986672219908371511870054144106622241",
                "1.629629629629629629629629629629629629630",
                "6.489600000000000000000000000000000000000",
                "26.00000000000000000000000000000000000000",
                "122.9629629629629629629629629629629629630",
                "876.0000000000000000000000000000000000000",
                "18872.00000000000000000000000000000000000",
            };
            ddouble[] nm2_expecteds = {
                "0.09600000000000000000000000000000000000000",
                "0.09615806065510207522041841568468787403699",
                "0.09622393934975944015162560139962093599650",
                "0.09618383906185221013562868931751327660751",
                "0.09602194787379972565157750342935528120713",
                "0.09572011661807580174927113702623906705539",
                "0.09525748015469163443924282515774475880318",
                "0.09461001196538386621031249130422684141692",
                "0.09375000000000000000000000000000000000000",
                "0.09264542982780034238528414621865664126750",
                "0.09125925925925925925925925925925925925926",
                "0.08954856697691582270695805486079790069294",
                "0.08746355685131195335276967930029154518950",
                "0.08494640044708631814255956917136615353351",
                "0.08192990441511151570323167956304050978607",
                "0.07833600000000000000000000000000000000000",
                "0.07407407407407407407407407407407407407407",
                "0.06903920440535875729432070354236870222734",
                "0.06311044327573253193087903831705484598047",
                "0.05614944390454594536227189288413778209697",
                "0.04800000000000000000000000000000000000000",
                "0.03848957573990377606065024055984837439860",
                "0.02743484224965706447187928669410150891632",
                "0.01465499694687563606757581925503765520049",
                "0",
                "-0.01659259259259259259259259259259259259259",
                "-0.03498542274052478134110787172011661807580",
                "-0.05461993627674101046882111970869367319071",
                "-0.07407407407407407407407407407407407407407",
                "-0.09015777610818933132982719759579263711495",
                "-0.09600000000000000000000000000000000000000",
                "-0.07681755829903978052126200274348422496571",
                "0",
                "0.2099125364431486880466472303206997084548",
                "0.7407407407407407407407407407407407407407",
                "2.112000000000000000000000000000000000000",
                "6.000000000000000000000000000000000000000",
                "19.25925925925925925925925925925925925926",
                "84.00000000000000000000000000000000000000",
                "840.0000000000000000000000000000000000000",
            };
            ddouble[] nm1_expecteds = {
                "-0.1600000000000000000000000000000000000000",
                "-0.1630506245890861275476660092044707429323",
                "-0.1662049861495844875346260387811634349030",
                "-0.1694667640613586559532505478451424397370",
                "-0.1728395061728395061728395061728395061728",
                "-0.1763265306122448979591836734693877551020",
                "-0.1799307958477508650519031141868512110727",
                "-0.1836547291092745638200183654729109274564",
                "-0.1875000000000000000000000000000000000000",
                "-0.1914672216441207075962539021852237252862",
                "-0.1955555555555555555555555555555555555556",
                "-0.1997621878715814506539833531510107015458",
                "-0.2040816326530612244897959183673469387755",
                "-0.2085048010973936899862825788751714677641",
                "-0.2130177514792899408284023668639053254438",
                "-0.2176000000000000000000000000000000000000",
                "-0.2222222222222222222222222222222222222222",
                "-0.2268431001890359168241965973534971644612",
                "-0.2314049586776859504132231404958677685950",
                "-0.2358276643990929705215419501133786848073",
                "-0.2400000000000000000000000000000000000000",
                "-0.2437673130193905817174515235457063711911",
                "-0.2469135802469135802469135802469135802469",
                "-0.2491349480968858131487889273356401384083",
                "-0.2500000000000000000000000000000000000000",
                "-0.2488888888888888888888888888888888888889",
                "-0.2448979591836734693877551020408163265306",
                "-0.2366863905325443786982248520710059171598",
                "-0.2222222222222222222222222222222222222222",
                "-0.1983471074380165289256198347107438016529",
                "-0.1600000000000000000000000000000000000000",
                "-0.09876543209876543209876543209876543209877",
                "0",
                "0.1632653061224489795918367346938775510204",
                "0.4444444444444444444444444444444444444444",
                "0.9600000000000000000000000000000000000000",
                "2.000000000000000000000000000000000000000",
                "4.444444444444444444444444444444444444444",
                "12.00000000000000000000000000000000000000",
                "56.00000000000000000000000000000000000000",
            };
            ddouble[] n0_expecteds = {
                "-0.8000000000000000000000000000000000000000",
                "-0.7948717948717948717948717948717948717949",
                "-0.7894736842105263157894736842105263157895",
                "-0.7837837837837837837837837837837837837838",
                "-0.7777777777777777777777777777777777777778",
                "-0.7714285714285714285714285714285714285714",
                "-0.7647058823529411764705882352941176470588",
                "-0.7575757575757575757575757575757575757576",
                "-0.7500000000000000000000000000000000000000",
                "-0.7419354838709677419354838709677419354839",
                "-0.7333333333333333333333333333333333333333",
                "-0.7241379310344827586206896551724137931034",
                "-0.7142857142857142857142857142857142857143",
                "-0.7037037037037037037037037037037037037037",
                "-0.6923076923076923076923076923076923076923",
                "-0.6800000000000000000000000000000000000000",
                "-0.6666666666666666666666666666666666666667",
                "-0.6521739130434782608695652173913043478261",
                "-0.6363636363636363636363636363636363636364",
                "-0.6190476190476190476190476190476190476190",
                "-0.6000000000000000000000000000000000000000",
                "-0.5789473684210526315789473684210526315789",
                "-0.5555555555555555555555555555555555555556",
                "-0.5294117647058823529411764705882352941176",
                "-0.5000000000000000000000000000000000000000",
                "-0.4666666666666666666666666666666666666667",
                "-0.4285714285714285714285714285714285714286",
                "-0.3846153846153846153846153846153846153846",
                "-0.3333333333333333333333333333333333333333",
                "-0.2727272727272727272727272727272727272727",
                "-0.2000000000000000000000000000000000000000",
                "-0.1111111111111111111111111111111111111111",
                "0",
                "0.1428571428571428571428571428571428571429",
                "0.3333333333333333333333333333333333333333",
                "0.6000000000000000000000000000000000000000",
                "1.000000000000000000000000000000000000000",
                "1.666666666666666666666666666666666666667",
                "3.000000000000000000000000000000000000000",
                "7.000000000000000000000000000000000000000",
            };
            ddouble[] n1_expecteds = {
                "-1.609437912434100374600759333226187639526",
                "-1.584120104449810499197036314113314605226",
                "-1.558144618046549841174563188971500401086",
                "-1.531476370964388516116399306656917459674",
                "-1.504077396776274073373258352386874841219",
                "-1.475906519809577751454415712294837664936",
                "-1.446918982936325461415070374956773399437",
                "-1.417066019786644307205492450513125300243",
                "-1.386294361119890618834464242916353136151",
                "-1.354545662805310317677467960167827506223",
                "-1.321755839982319447161540327232360208022",
                "-1.287854288306638098931575667987381901268",
                "-1.252762968495367995688120621985003161562",
                "-1.216395324324493145934039346393047409716",
                "-1.178654996341646117219023198648965468654",
                "-1.139434283188364820949822302077845574825",
                "-1.098612288668109691395245236922525704647",
                "-1.056052674249313762555056467435666414216",
                "-1.011600911678479925227479335048776163671",
                "-0.9650808960435870682489016159911757300581",
                "-0.9162907318741550651835272117680110714501",
                "-0.8649974374866045317573310675133238330109",
                "-0.8109302162163287639560262309286982731440",
                "-0.7537718023763801519978382534985968313617",
                "-0.6931471805599453094172321214581765680755",
                "-0.6286086594223741377443082057741836399466",
                "-0.5596157879354226862708885005268265934861",
                "-0.4855078157817008078017910771907889005788",
                "-0.4054651081081643819780131154643491365720",
                "-0.3184537311185346158102472135905995955952",
                "-0.2231435513142097557662950903098345033746",
                "-0.1177830356563834545387941094705217050685",
                "0",
                "0.1335313926245226231463436209313499745894",
                "0.2876820724517809274392190059938274315035",
                "0.4700036292457355536509370311483420647009",
                "0.6931471805599453094172321214581765680755",
                "0.9808292530117262368564511274520039995790",
                "1.386294361119890618834464242916353136151",
                "2.079441541679835928251696364374529704227",
            };
            ddouble[] n2_expecteds = {
                "-2.369939796998365831985537425350323048751",
                "-2.319244572744681726945064553825984505159",
                "-2.267727904646116613659270066592990357474",
                "-2.215356976795001406921239755252663214133",
                "-2.162096799077975095098549495119353056285",
                "-2.107910001513338351044352281949195190792",
                "-2.052756602904809111323119353968497172790",
                "-1.996593749774778525627027551424829542242",
                "-1.939375420766708953077271719177891441223",
                "-1.881052090756281740969883240758881220303",
                "-1.821570347737061994609613672347161793591",
                "-1.760872454086960536450336979306661454411",
                "-1.698895841995014173048091284015303096255",
                "-1.635572530525305592716346266111785155029",
                "-1.570828448870206811517312246393421780982",
                "-1.504582646600489089283108434908707086588",
                "-1.436746366883680946362902023893583354250",
                "-1.367221952337992045702503103030389984250",
                "-1.295901544889110041115705670068510847791",
                "-1.222665529950763749837121417455638821182",
                "-1.147380660375570754079976633862792129215",
                "-1.069897775337797462171116603079391716198",
                "-0.9900490012601040264760611239827842640088",
                "-0.9076442825164287791659741657902442370980",
                "-0.8224670334241132182362075833230125946095",
                "-0.7342686212815033932519700435354863693436",
                "-0.6427612688399788791052904010470916233247",
                "-0.5476087802311696649191525864446819377710",
                "-0.4484142069236462024430644059157743208343",
                "-0.3447031086857277308752814952544797054707",
                "-0.2359002976862634538210827939490320839289",
                "-0.1212966287227264787142098916925930041635",
                "0",
                "0.1291398601099534056689353043446094486235",
                "0.2676526390827326069191838284878115758199",
                "0.4176554682925851140782148220357498792266",
                "0.5822405264650125059026563201596801087442",
                "0.7662852899697461919912832183292637861309",
                "0.9784693929303061037430666665245614977615",
                "1.238123481796480234683050755559260464416",
                "1.644934066848226436472415166646025189219"
            };
            ddouble[] n3_expecteds = {
                "-2.967107693943194459725048726039053506642",
                "-2.892672070652637349323004637585884314385",
                "-2.817471390587925008525816599593334697956",
                "-2.741482177891745816489569612476976018680",
                "-2.664679674287803040918924793190058878577",
                "-2.587037735243882817479223073103201459020",
                "-2.508528714772253891337516400624409006349",
                "-2.429123337277089397788330189654509211992",
                "-2.348790554584076557805870669806798778114",
                "-2.267497385955880930311995817098893135881",
                "-2.185208738494706133888657241935488270700",
                "-2.101887204841912232538906397930947213702",
                "-2.017492834481324936190028272580108389350",
                "-1.931982874207217760411515291900679145213",
                "-1.845311472390169686330863706032341690147",
                "-1.757429340511259257284959165057319429033",
                "-1.668283363966571212046345315887518776241",
                "-1.577816152273968096169135655798732220033",
                "-1.485965516411445158129028560796665959145",
                "-1.392663857899685781386571305359437722927",
                "-1.297837450156250147922642959891062945094",
                "-1.201405587233511195107105785452416921021",
                "-1.103279567785171972010606097437856944633",
                "-1.003361472221616626562382795688613897950",
                "-0.9015426773696957140498036211335874930737",
                "-0.7977020338075092199872531334728731777066",
                "-0.6917036036904594510141448426629230968674",
                "-0.5833938170009195120379974331673207918028",
                "-0.4725978446588968746186231931265476736650",
                "-0.3591148958541199116453772593681075642256",
                "-0.2427120033389163051507508979053807573341",
                "-0.1231156260288360722576237777990959941644",
                "0",
                "0.1270295409793485990426937768985767601950",
                "0.2584613957965733052880001298736726120216",
                "0.3949165234332217059006983347121178117809",
                "0.5372131936080402009406232255949658266704",
                "0.6864849629546578850955782387443358620765",
                "0.8444258088622044485043448773485128867040",
                "1.013927114199606714547335452095596745894",
                "1.202056903159594285399738161511449990765"
            };
            ddouble[] n4_expecteds = {
                "-3.382309996183727622922156796677248531195",
                "-3.289294064522162337594954301732284724787",
                "-3.195681384094846481777077304126619018632",
                "-3.101457824144122001882262849191422781314",
                "-3.006608612263438738745388451831135417710",
                "-2.911118289543327048240631401842477517603",
                "-2.814970661380900719105843453979744899204",
                "-2.718148743408250075642119988053353675664",
                "-2.620634701909763503399941391847464354792",
                "-2.522409787996887322601781760500103202713",
                "-2.423454264687442670392844126048078470283",
                "-2.323747325890743009641007559575920686246",
                "-2.223267006123517725219225668006162061820",
                "-2.121990079567511678363925291663144580514",
                "-2.019891946817868650246931103248935607889",
                "-1.916946507349353309822696266912075798732",
                "-1.813126015328491172128145260606351874683",
                "-1.708400915901768063735595188457958287225",
                "-1.602739658463626597849972865307029620948",
                "-1.496108482613210245302723948734027123926",
                "-1.388471171491002881941929286929072272114",
                "-1.279788765869978834106453406061382434439",
                "-1.170019230654250845105342463165510294374",
                "-1.059117063159830452078877152982586177521",
                "-0.9470328294972459175765032344735219149279",
                "-0.8337126112202340321145272683263697166572",
                "-0.7190973386608226808469954378578993753773",
                "-0.6031219792887986062228203125098661292601",
                "-0.4857145378306064445732989477546728727549",
                "-0.3667948078434315629467251691966749128557",
                "-0.2462727887607290643683494888096253547473",
                "-0.1240466425497875792159718262103350728579",
                "0",
                "0.1260016808145903985106470416004938305953",
                "0.2541161907463435340596737131535205829398",
                "0.3845319223737143606318644249302477364538",
                "0.5174790616738993863307581618988629456224",
                "0.6532478042399217805517922010998439821313",
                "0.7922210279728277795294857895573574111674",
                "0.9349429281290232165864642447248987786918",
                "1.082323233711138191516003696541167902775"
            };
            ddouble[] n5_expecteds = {
                "-3.646912367305734317706559261203230556051",
                "-3.541011247438500590643137153389525703752",
                "-3.434697387219475150467542933003617463662",
                "-3.327963269995149756031201731190078658063",
                "-3.220801094784773606480965573185551547826",
                "-3.113202759055245444570631323102127765826",
                "-3.005159840018325655064929656335528443624",
                "-2.896663574282888232593012480245110368037",
                "-2.787704835671046976220389289411947782684",
                "-2.678274110978934756804520037412212559965",
                "-2.568361473429818927774962988126023854991",
                "-2.457956553528016171531523641495319049941",
                "-2.347048506975368340803973517879800296857",
                "-2.235625979256144411987431303783322232432",
                "-2.123677066428967133063323635134074988557",
                "-2.011189271582942760674806835617882714604",
                "-1.898149456316008341769293020682484376506",
                "-1.784543786471933592286847314412150614307",
                "-1.670357671222294170679087017897851771109",
                "-1.555575694392945812365206835363894244304",
                "-1.440181536700192231164691113325017942228",
                "-1.324157887265210873426442922051217362946",
                "-1.207486342396157822979130254501783292519",
                "-1.090147289137604835624963895577542279151",
                "-0.9721197704469093059356551435534695325535",
                "-0.8533813280099235238578738695970889393059",
                "-0.7339078175711285424059158434386588769244",
                "-0.6136731901022945578076913212404320757530",
                "-0.4926492299811078198961903994938682731492",
                "-0.3708052383034978962247854849124310196355",
                "-0.2481076450397828738148831318539868813268",
                "-0.1245195271845829048982711500515507229407",
                "0",
                "0.1254965675065442471518026037429986156110",
                "0.2520215881785742010066951962355466907247",
                "0.3796336649042209037411784827298559891508",
                "0.5084005792422687074591088492585899413195",
                "0.6384022442658289807082561681802678286076",
                "0.7697354105997573809726917315253500211817",
                "0.9025220398584402056272242439826950916267",
                "1.036927755143369926331365486457034168057"
            };
            ddouble[] n6_expecteds = {
                "-3.805074587517757646318078790521117340147",
                "-3.690978791451867468903231101921057988681",
                "-3.576621053753020985810629722585020502448",
                "-3.461997733169962575451802072721005292871",
                "-3.347105073826922559354810587585586257149",
                "-3.231939199197744941785573640463514323680",
                "-3.116496105620311727883332583269035592949",
                "-3.000771655304235919127850048352563910789",
                "-2.884761568778657991841518953849874932330",
                "-2.768461416719855833723462968640428664286",
                "-2.651866611090074562025774518522389685476",
                "-2.534972395509265468069034399959733433402",
                "-2.417773834770002247715214662074939366887",
                "-2.300265803392356812746750323390239806564",
                "-2.182442973099514814652584988351969164420",
                "-2.064299799075823755068530116569763628562",
                "-1.945830504846072453615557303948409637836",
                "-1.827029065587176721895745357107991057026",
                "-1.707889189649902219520751017223613833809",
                "-1.588404298027243278473649571526241941000",
                "-1.468567501455562120321271694156554209408",
                "-1.348371574771876952102524069288634373728",
                "-1.227808928072146703159743476992176677751",
                "-1.106871574116111738616310609512202079899",
                "-0.9855510912974351040984392444849542614049",
                "-0.8638385813340762931360467821282326205045",
                "-0.7417246206195702565816052263045305092798",
                "-0.6191992038917374503390657973327980068991",
                "-0.4962516784926481541672722801416896854301",
                "-0.3728706669691755157035767498243057992595",
                "-0.2490439750303344934025185989809584883836",
                "-0.1247584808293702910863030872039771210180",
                "0",
                "0.1252468814526408643471934527840758649922",
                "0.2509990179628926887287753487100611128443",
                "0.3772749764799917052623624817317764091175",
                "0.5040953978039885506900465097888790952065",
                "0.6314834946706974911011261606660014534654",
                "0.7594657743039583341684489402667718178975",
                "0.8880731694386662248174454222637800403894",
                "1.017343061984449139714517929790920527902"
            };
            ddouble[] n7_expecteds = {
                "-3.895211273494962323605182759841582779354",
                "-3.776225200266671557485902990200279877324",
                "-3.657083069987671369147111823144412628605",
                "-3.537783243178443177024830173548171586699",
                "-3.418324037534320518067434505320751446285",
                "-3.298703725972390451952046935305221025198",
                "-3.178920534545775250878219173253677379548",
                "-3.058972640213016349896915392452210089602",
                "-2.938858168448815526578167176660659700346",
                "-2.818575190680703301736118985989843109978",
                "-2.698121721534262384126196906015380257622",
                "-2.577495715867287020987469630136824612295",
                "-2.456695065570649288696635753663815159108",
                "-2.335717596110599416505372931632553031593",
                "-2.214561062783661257434281787376614842823",
                "-2.093223146651086818839001120406547649086",
                "-1.971701450114868847518580765331124571889",
                "-1.849993492091405981624613393204272801643",
                "-1.728096702731852920781216369820883643317",
                "-1.606008417629689584061269767973816227131",
                "-1.483725871445748538480866295622141831001",
                "-1.361246190868380457819638821783283787387",
                "-1.238566386810996330613225465881585202748",
                "-1.115683345730082006538231800431758272857",
                "-0.9925938199228302826704257131333936852311",
                "-0.8692944166332697465957082245627326013926",
                "-0.7457815857570991877180271111018455051259",
                "-0.6220516058854218210804631670240222049081",
                "-0.4981005683620026447703403364251222106002",
                "-0.3739243589413870148875927759669133729820",
                "-0.2495186365170098392147673296247562743952",
                "-0.1248788082251599757669888111948162679668",
                "0",
                "0.1251229786797934610749135930273737341204",
                "0.2504956776131743870175333897974288435217",
                "0.3761240588071172507590002977569380749100",
                "0.5020145633247084945674892956407070362802",
                "0.6281741980596852921841733593006599860699",
                "0.7546106525767309947493826442409478223836",
                "0.8813324648802387826076294670306663327376",
                "1.008349277381922826839797549849796759600"
            };
            ddouble[] n8_expecteds = {
                "-3.944784180829129331260645256531017802479",
                "-3.823014703430642299413600029978211649558",
                "-3.701156518886232951145397166653059610333",
                "-3.579208930849437164722531088143900199122",
                "-3.457171227943864537415209351521541341053",
                "-3.335042683169327232422704248484528033966",
                "-3.212822553272076275404734143207549168190",
                "-3.090510078076136030152357793246632619593",
                "-2.968104479772398049262513897598698588490",
                "-2.845604962161760693089796958523079000574",
                "-2.723010709848173257554690676145322005105",
                "-2.600320887376953752014433707917574556901",
                "-2.477534638313186954618476091776440994825",
                "-2.354651084254360652848143597607450411361",
                "-2.231669323770646856160316444066726929823",
                "-2.108588431265361399067692291223120247576",
                "-1.985407455747115265715624212395134440975",
                "-1.862125419503973791411436156809389643123",
                "-1.738741316668527678974198826017141512314",
                "-1.615254111661104721617401810476724553056",
                "-1.491662737496352598565443592617803638824",
                "-1.367966093936023459818938629500812979606",
                "-1.244163045467889910937605449571842536498",
                "-1.120252419087188484001625068580590337512",
                "-0.9962330018526478992272892600828036178741",
                "-0.8721035381837845237897547041119147268385",
                "-0.7478627268594239657694771117208596586996",
                "-0.6235092176689066093280275322350598350862",
                "-0.4990416076565572282282818393382707895220",
                "-0.3744584368858935413551115678700517206452",
                "-0.2497581836314813928462519776667795106479",
                "-0.1249392588814832386931031922598605464851",
                "0",
                "0.1250613366491133042575133323097669006393",
                "0.2502465843833193381214804725762136581017",
                "0.3755576765545471490144966234557039641983",
                "0.5009966590970519105573559055302724587260",
                "0.6265657060445737724316696303714815328484",
                "0.7522671392276775946602956360025477994701",
                "0.8781034541913132992673751162595652004346",
                "1.004077356197944339378685238508652465259"
            };

            ddouble[] xm8_expecteds = {
                "-3.685676000757406368760166643423424557843",
                "-5.042270791907577003416204476528931478517",
                "-6.105498359675406645535467450765975329790",
                "-6.852239982331027392180409225361399001826",
                "-7.335194679743249308299595928553945681932",
                "-7.628463428491801503224697113431573058357",
                "-7.798115670039984115565573414611757656616"
            };

            ddouble[] xm16_expecteds = {
                "-5.427008531068195691294900694545378583535",
                "-8.175009127060655767478771418475464727381",
                "-10.61655613612548899763892368526668159760",
                "-12.52243870762194822098239172618146163335",
                "-13.86989211330604882531181105090450622157",
                "-14.75156651995631265988786106356297791338",
                "-15.29424829057247649593878281738526046717"
            };

            ddouble[] xm32_expecteds = {
                "-7.619587549046572220226290206195691011905",
                "-12.67004968161816139705996133725046732991",
                "-17.75312613976106219761286371453910207278",
                "-22.17486278358419071418418713706899438795",
                "-25.61003109680598813858680046992862968055",
                "-28.04924259319256165658797505161026046084",
                "-29.66010958360244585632380385159138261404"
            };

            ddouble[] xm64_expecteds = {
                "-10.27752393236528737426919984865645696618",
                "-18.84557055824159801880019010511484357048",
                "-28.56919473645756738633493280936820035004",
                "-37.98191925452048102809927010238397576629",
                "-46.02658405613506207074262070846309356803",
                "-52.24569992051862457499449592659095061180",
                "-56.67424115576521809295006170183229922444"
            };

            ddouble[] xm128_expecteds = {
                "-13.40823561388299014413689736555997903825",
                "-27.02698403474189958748069248971579077877",
                "-44.34206644302724606847217365595813263213",
                "-62.92369119373856384235247561925037871927",
                "-80.36729712807254749940906134191239650270",
                "-95.05448913580491462877053825257711945029",
                "-106.3547169702817389286231553705795181476"
            };

            ddouble[] xm256_expecteds = {
                "-17.01552807031971497628737117800708144642",
                "-37.54345926638678690017418501598363082059",
                "-66.57605015042664640780655351835851373755",
                "-100.9441460649633520173986914522653079347",
                "-136.2705196107545922174349979104219787758",
                "-168.6165506614486690365069707123998130907",
                "-195.5050116561335124635518644005110970030"
            };

            ddouble[] xm512_expecteds = {
                "-21.10132895838276661256613825028477408553",
                "-50.72608056087916868294417817778093106479",
                "-97.00435581708674557324502800594935614508",
                "-157.1092137581728001266653823578824342068",
                "-224.4880279962810415715913540961888181327",
                "-291.4014365956859949042661185056245801578",
                "-351.4128069056514989698058522279524741130"
            };

            ddouble[] xm1024_expecteds = {
                "-25.66660843857345329323745510939186558256",
                "-66.90689921457529720204297358565543885285",
                "-137.5900567380701444107103221708188994720",
                "-237.7658199030712568664415717558843402039",
                "-359.7177895747803899286311704271325996157",
                "-490.6476202290156993574968340705688650068",
                "-617.0490559681951394410896817334033021288"
            };

            ddouble[] xm65536_expecteds = {
                "-63.14290458964715356003242973122107744248",
                "-245.5877469201547944087883975139314152267",
                "-733.3878914523460504169147759948561200051",
                "-1793.098036588709306027446845533016113560",
                "-3739.593267355055534995516404881540669142",
                "-6846.664114188522793798821336951311266161",
                "-11244.08912913497677898693972288417669253"
            };

            foreach ((int n, ddouble[] expecteds) in new (int, ddouble[])[] {
                (-4, nm4_expecteds), (-3, nm3_expecteds), (-2, nm2_expecteds), (-1, nm1_expecteds), (0, n0_expecteds),
                (1, n1_expecteds), (2, n2_expecteds), (3, n3_expecteds), (4, n4_expecteds),
                (5, n5_expecteds), (6, n6_expecteds), (7, n7_expecteds), (8, n8_expecteds)}) {

                for ((int i, ddouble x) = (0, -4); i < expecteds.Length; i++, x += 1d / 8) {
                    ddouble expected = expecteds[i];

                    ddouble actual = ddouble.Polylog(n, x);
                    PrecisionAssert.AlmostEqual(expected, actual, 4e-30d, $"x = {x},n = {n}");

                    if (x < 1 && x != 0) {
                        ddouble actual_dec = ddouble.Polylog(n, ddouble.BitDecrement(x));
                        PrecisionAssert.AlmostEqual(expected, actual_dec, 4e-30d, $"{x}-eps,{n}");

                        ddouble actual_inc = ddouble.Polylog(n, ddouble.BitIncrement(x));
                        PrecisionAssert.AlmostEqual(expected, actual_inc, 4e-30d, $"{x}+eps,{n}");
                    }
                }
            }

            foreach ((ddouble x, ddouble[] expecteds) in new (ddouble, ddouble[])[] {
                (-8, xm8_expecteds), (-16, xm16_expecteds), (-32, xm32_expecteds), (-64, xm64_expecteds),
                (-128, xm128_expecteds), (-256, xm256_expecteds), (-512, xm512_expecteds), (-1024, xm1024_expecteds),
                (-65536, xm65536_expecteds)}) {

                for (int n = 2; n <= 8; n++) {
                    ddouble expected = expecteds[n - 2];

                    ddouble actual = ddouble.Polylog(n, x);
                    PrecisionAssert.AlmostEqual(expected, actual, 1e-30d, $"x = {x},n = {n}");

                    if (x > 0) {
                        ddouble actual_dec = ddouble.Polylog(n, ddouble.BitDecrement(x));
                        PrecisionAssert.AlmostEqual(expected, actual_dec, 1e-30d, $"{x}-eps,{n}");

                        ddouble actual_inc = ddouble.Polylog(n, ddouble.BitIncrement(x));
                        PrecisionAssert.AlmostEqual(expected, actual_inc, 1e-30d, $"{x}+eps,{n}");
                    }
                }
            }
        }

        [TestMethod]
        public void PolylogLimitTest() {
            for (int n = 0; n <= 8; n++) {
                for (ddouble r = 0.5; r >= Math.ScaleB(1, 102); r /= 2) {
                    ddouble x = 1 - r;

                    ddouble yn = ddouble.Polylog(n, x - r / 2);
                    ddouble yz = ddouble.Polylog(n, x);
                    ddouble yp = ddouble.Polylog(n, x + r / 2);

                    Console.WriteLine($"n={n} x={x}\n{yz}");

                    Assert.IsTrue(yn <= yz && yz <= yp && yp <= ddouble.RiemannZeta(n), $"nearone\n{yn},\n{yz},\n{yp}");
                }

                for (ddouble x = -2; x > ddouble.NegativeInfinity; x *= 2) {
                    ddouble yn = ddouble.Polylog(n, x * 1.125);
                    ddouble yz = ddouble.Polylog(n, x);
                    ddouble yp = ddouble.Polylog(n, x * 0.875);

                    Console.WriteLine($"n={n} x={x}\n{yz}");

                    Assert.IsTrue(yn <= yz && yz <= yp, $"mlimit\n{yn},\n{yz},\n{yp}");
                }
            }
        }

        [TestMethod]
        public void PolylogAbnormalTest() {
            for (int n = 2; n <= 8; n++) {
                Console.WriteLine(n);

                ddouble pg_pzero = ddouble.Polylog(n, 0d);
                ddouble pg_mzero = ddouble.Polylog(n, -0d);
                ddouble pg_pinf = ddouble.Polylog(n, double.PositiveInfinity);
                ddouble pg_ninf = ddouble.Polylog(n, double.NegativeInfinity);
                ddouble pg_nan = ddouble.Polylog(n, double.NaN);

                PrecisionAssert.IsPlusZero(pg_pzero, nameof(pg_pzero));
                PrecisionAssert.IsMinusZero(pg_mzero, nameof(pg_mzero));
                PrecisionAssert.IsNaN(pg_pinf, nameof(pg_pinf));
                PrecisionAssert.IsNegativeInfinity(pg_ninf, nameof(pg_ninf));
                PrecisionAssert.IsNaN(pg_nan, nameof(pg_nan));
            }
        }
    }
}
