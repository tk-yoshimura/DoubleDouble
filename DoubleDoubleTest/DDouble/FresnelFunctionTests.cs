using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class FresnelFunctionTests {
        [TestMethod]
        public void FresnelCTest() {
            ddouble[] expecteds = {
                "6.2499764690704392437825626674536546182138e-2",
                "1.2499247029941109950559526257972854711344e-1",
                "1.8744282781397402464403866279445962150455e-1",
                "2.4975915035654318345922151780088572437814e-1",
                "3.1176545781475070117681803376661013894927e-1",
                "3.7317436047429970795682697625461851077175e-1",
                "4.3356166644468459033044864440831276017678e-1",
                "4.9234422587144639287884366515668163776610e-1",
                "5.4876319610834695080310565782385271887024e-1",
                "6.0187563714613758822211236562488318517875e-1",
                "6.5055804572508811570350097883950567514651e-1",
                "6.9352599078713589748587590899395547906400e-1",
                "7.2937425922452073042234910102251414907248e-1",
                "7.5664165311290255019680858424287815826697e-1",
                "7.7390355977475814250128095840313052334001e-1",
                "7.7989340037682282947420641365269013663063e-1",
                "7.7365084719733626711933472417447205321329e-1",
                "7.5469018670844954622034227769577171372111e-1",
                "7.2317649169968725842609114653238247735956e-1",
                "6.8009074107545508366792230510495898378424e-1",
                "6.2735846968805370038278434614365108341269e-1",
                "5.6791117203536701909922142357799261074146e-1",
                "5.0564719137783068129782143919611689747512e-1",
                "4.4526117603982153506455100974208978215940e-1",
                "3.9192036487020932330133081974371394259890e-1",
                "3.5078348478088720950770139876731879187428e-1",
                "3.2638427359081480290487721102288668420664e-1",
                "3.2193504614953785958835936070824847601607e-1",
                "3.3864217425287976689913088482347261248447e-1",
                "3.7515778106849233791676489584525164308028e-1",
                "4.2731066061144660528691637604497976613314e-1",
                "4.8825340607534075450022350335726103768837e-1",
                "5.4912213545516613124514998765288277083175e-1",
                "6.0022498790342553461694146071994177032789e-1",
                "6.3265958666408911423385937431390747038634e-1",
                "6.4012420994655464052361490469819710651753e-1",
                "6.2056246201406057896946151701828955120188e-1",
                "5.7720765528529174142898455042433307831611e-1",
                "5.1861436543336398837228528761373463864623e-1",
                "4.5741300964177704524565610495614443882908e-1",
                "4.0780295200544881371967036000461295723022e-1",
                "3.8217124064129374450766525757272119259863e-1",
                "3.8759862462293731872669933467971840339927e-1",
                "4.2326379628366276346541950113929321236102e-1",
                "4.7974546437114452943680885232710746553480e-1",
                "5.4085840831524388542615501057628341822650e-1",
                "5.8795406770335353482697177959641730798407e-1",
                "6.0572078929768562955616107428715469714522e-1",
                "5.8772447300718123101696122468690808423555e-1",
                "5.3959688412174216369971046787337528779399e-1",
                "4.7820044752594189243237021434748185217671e-1",
                "4.2633865559802077062431254760673412851663e-1",
                "4.0434908488322022014757692747022159027482e-1",
                "4.2156570560807362219458523480535084837208e-1",
                "4.7135356932560365513465711151090289266791e-1",
                "5.3257243502800084532952032250263351326114e-1",
                "5.7787591326669049098198269804375343318606e-1",
                "5.8599023167070093339171678205528276855866e-1",
                "5.5253028905486405824834704453721851367899e-1",
                "4.9359046264602496047468310895483529138601e-1",
                "4.3909337077533663313910536300585280089964e-1",
                "4.1794683830103865730188851185001257979409e-1",
                "4.4208619282795364090780946500912264393983e-1",
                "4.9842603303817761553070958682450973003501e-1",
                "5.5462536133187407966806270496858700009287e-1",
                "5.7709800784716843840291160851306922985891e-1",
                "5.5167506844449113298025816302886120231615e-1",
                "4.9397314947167313306951231158254804084814e-1",
                "4.4124069751924664959769718176540536163964e-1",
                "4.2880560669348869979653932079426832539453e-1",
                "4.6557863471427204053997345529950595068597e-1",
                "5.2602591505353874136960693692023096651580e-1",
                "5.6653652854821416901421404728405005107880e-1",
                "5.5681994702498039703656527322163005777373e-1",
                "5.0389371716372022807301163346581828717953e-1",
                "4.4882726502533662827982967968235723285221e-1",
                "4.3575011954337042460468069280058106922361e-1",
                "4.7569969928562681009214641288849964742427e-1",
                "5.3543101864682602833607833322387376904494e-1",
                "5.6363118870401223110210740441301396412075e-1",
                "5.3524514373483333135949548825712256905209e-1",
                "4.7552841921797180827331361461185795221104e-1",
                "4.3937635201715424817179169959905399170456e-1",
                "4.6101157744078022846151757337618189404033e-1",
                "5.1988979161194936239468921832824707485551e-1",
                "5.5821607261513579895463802956970562899088e-1",
                "5.3733487666945655186267435185827632989317e-1",
                "4.7842141492531445350830934156377729720221e-1",
                "4.4309000369710785340802171878447395592703e-1",
                "4.6925424736700995998737132445939551754571e-1",
                "5.2858821151980663510516280947037213051378e-1",
                "5.5512857331847213127031699080797155674837e-1",
                "5.1861376451498635740348170164703415642987e-1",
                "4.6111408153917872763740302688462967654071e-1",
                "4.5042185192225164534720455098366327514204e-1",
                "4.9953146785550112018827990327113522776271e-1",
                "5.4844825732128061296729831132621278563884e-1",
                "5.3614599378436436811620348918870540361153e-1",
                "4.7810964385385517801887190135589220215783e-1",
                "4.4928509345850480361392123015420213416772e-1",
                "4.8765933506823109796049281204781484615708e-1",
                "5.4196757265035761050517957639239322159974e-1",
                "5.3826503912483986367918748598564917405183e-1",
                "4.8160345989096403455552409694360703874506e-1",
                "4.5172987202256374768593408346878245655745e-1",
                "4.9144407457308491003824001439804599676221e-1",
                "5.4300250623005064485748290975468289971379e-1",
                "5.3016620605241866291918055748892470925629e-1",
                "4.7219656059601260366743090615333602997457e-1",
                "4.5755191559409246906378041913593617897533e-1",
                "5.0892891689598875208315120298107332288673e-1",
                "5.4546709254696981032706902646163409255850e-1",
                "5.0880262978594922418622705059261652130652e-1",
                "4.5842414403741623762002278266860755710242e-1",
                "4.7723343263352243191748845174575624868226e-1",
                "5.3376656924787114231522550096865418676693e-1",
                "5.3224499043238159865003552378628045559567e-1",
                "4.7535669438013846927872253384765570466366e-1",
                "4.6226643045913473665292986385566290974924e-1",
                "5.1601825015233634634154681699468840040235e-1",
                "5.4026804303607491800284449548502321633151e-1",
                "4.9107721427595335832232241589161531160020e-1",
                "4.5904954066771497540150232369597705152354e-1",
                "5.0380891591942716535165198573522112286569e-1",
                "5.4068996218864746776941486019495975748121e-1",
                "4.9921543690445480258671148992764861929021e-1",
                "4.5990054733765034881911702189201178800523e-1",
                "4.9980218037719713555698386025998493803712e-1",
                "5.3947790095839570667113123619583686874638e-1",
                "4.9922740163517117482473222159433043943564e-1",
                "4.6117416006515121680017663735490736560759e-1",
                "5.0360203437810607572756012290316952884126e-1",
                "5.3786780443255711821425541690747322488439e-1",
                "4.9184134022779096264678561260351369052954e-1",
                "4.6391893126202601182298818693999339972098e-1",
                "5.1417759858373344687722344711398188037225e-1",
                "5.3275225774313747094178364620577711485424e-1",
                "4.7887975405187225066384678330675914940191e-1",
                "4.7290004083756918674914626087112944456597e-1",
                "5.2802340488625188497756448360627196217951e-1",
                "5.1850557441512449174569131065251829126761e-1",
                "4.6659116088960670433716256901626373750388e-1",
                "4.9312729283243299385828097836680924114796e-1",
                "5.3536612746811985255106330305762761709389e-1",
                "4.9307006875165224026542497033621987828489e-1",
                "4.6805673877071090615028801348770763841260e-1",
                "5.2070361865128352708801437501161547516536e-1",
                "5.2192869898246377873301868347657267110261e-1",
                "4.6906590289687369673321922117304034349597e-1",
                "4.9407441775592648254314189670030588333840e-1",
                "5.3355613621089162665656102115093575225017e-1",
                "4.8728733102656716351584917440614717619313e-1",
                "4.7432550588277815146104433246868573881236e-1",
                "5.2787851400892771168114819871548807453904e-1",
                "5.0789605601685623072579247272197591884953e-1",
                "4.6750041651646531985042353674382528911711e-1",
                "5.1395212117253806475164544822418468825691e-1",
                "5.2230207086123848952931312886174271128613e-1",
                "4.7037223216318799015449936863362189659638e-1",
                "4.9989869420551572361415184773562111439235e-1",
                "5.2918826145421153839848509802582658495331e-1",
                "4.7729906833985332997198873452753153178267e-1",
                "4.8956441728482190416811189041934239701850e-1",
                "5.3091345661481617631468704369728414622025e-1",
                "4.8404871310469626625807491589995661448793e-1",
                "4.8350981066541983819552906777346208152031e-1",
                "5.3035870924194361038022426916911515426603e-1",
                "4.8848000730270921217768014750621531585725e-1",
                "4.8095899234657473772215486185297563703958e-1",
                "5.2950237301287368886905959480832291747111e-1",
                "4.8987260787095227711496403170612557670512e-1",
                "4.8115286225762747507966798054155133158530e-1",
                "5.2913446662493304327279098699080325388242e-1",
                "4.8821090830709167289211188867297168349419e-1",
                "4.8391592992180219421195108823121465977588e-1",
                "5.2893666175579644963481599231985598465200e-1",
                "4.8392994283629780882090983546034260046530e-1",
                "4.8963419347200139995507717600217968332384e-1",
                "5.2757413830581192283559016849720201020241e-1",
                "4.7817383307129618764783775003117643926785e-1",
                "4.9872191333857629416646789029935177646693e-1",
                "5.2291793044346929789249639482940496947666e-1",
                "4.7333865685786371712646796702613505179048e-1",
                "5.1053061299658130731457898444854839514649e-1",
                "5.1288587335657570770519603992751921746652e-1",
                "4.7327013139624912880058391980381999119092e-1",
                "5.2193670246845616540443716380238569520715e-1",
                "4.9740689018889329935581737793369315758863e-1",
                "4.8198092489001981273165780281155490501918e-1",
                "5.2679804511159556088613021523052844830694e-1",
                "4.8107200950678156421410179806491162731964e-1",
                "4.9994136935201138031000091691537162919824e-1",
                "5.1858536287064083634985362085865054863444e-1",
                "4.7375451917432142818180409720455890809933e-1",
                "5.1942162368403831992869854812632994483387e-1",
                "4.9750795860766678680901796863289265641682e-1",
                "4.8468374478234368009782300608048773612560e-1",
                "5.2510840904690902404187199469444551569559e-1",
                "4.7738043042751187206849681122284425934688e-1",
                "5.0969690766970042657910737731893316095959e-1",
                "5.0725525132003733182380616980693631086270e-1",
                "4.7935776455447300790873115733237002444913e-1",
                "5.2506290149650339177500956517763071038295e-1",
                "4.8073265406176302628821226555842602324546e-1",
                "5.0613755918404786425401146133297675064843e-1",
                "5.0894191255635932114440785022303462445364e-1",
                "4.7960104832137056499562004406542462993518e-1",
                "5.2448511530435840639837918170252500205066e-1",
                "4.7968111141982337631764913286795676391457e-1",
                "5.0978691914291404432620942874683983613328e-1",
                "5.0343880520037530689829924547731138054894e-1",
                "4.8472620655799753521806642893476565158208e-1",
                "5.2247753316203186397560916231691776853410e-1",
                "4.7655896749272071002574030967744680016270e-1",
                "5.1837660886303020301377652148800916073886e-1",
                "4.9101502211761508315624932163561137534314e-1",
                "4.9780248887645718475797691078449978808904e-1",
                "5.1253244944440180830278302921860853186906e-1",
                "4.8010646458233347606915049507077585848622e-1",
                "5.2304196145790334450582878512882962734999e-1",
                "4.7826774418679000408504824267334249310093e-1",
                "5.1658884504108994965938901758340154239131e-1",
                "4.9116538565468478846390411416000041220322e-1",
                "4.9996307683096610045195378037577624167512e-1",
                "5.0856738046303166479388801186218445150335e-1",
                "4.8443513762618563103899447183602193187528e-1",
                "5.2023782170669276396717688873194685526742e-1",
                "4.7776675736886276984227928721926739530158e-1",
                "5.2159789145198704619229285120730483048219e-1",
                "4.8131053813405559028516401907359637646333e-1",
                "5.1406506432163197267549679725318291213102e-1",
                "4.9162993982669210749656134709724880202039e-1",
                "5.0224326550930375152404691784253537623975e-1",
                "5.0375283513396341737375006112274521413166e-1",
                "4.9082541077849896132197418546979141991991e-1",
                "5.1371473526016174594048590853216336867450e-1",
                "4.8279990821193450087231411352782026960439e-1",
                "5.1957551311813019836668031865931260479999e-1",
                "4.7911992271720960655209131676914573949902e-1",
                "5.2122053167437345793460004588139668472182e-1",
                "4.7925427195762281763122649753616831785342e-1",
                "5.1962444380335836904799042815292980554597e-1",
                "4.8197218855063404723430530872961222874531e-1",
                "5.1611666271815986321485642676354975371955e-1",
                "4.8596653618465751772422369749374712224626e-1",
                "5.1189814772268530307692475362192599106335e-1",
                "4.9019301112004797844567804650454507669161e-1",
                "5.0783365540525173147735880986865249907341e-1",
                "4.9396834104489838274223091808254254461666e-1",
                "5.0443755634111362546973211238698202355375e-1",
                "4.9692559400979039294113945894560105323156e-1",
                "5.0195512363733672769386507622027943927700e-1",
                "4.9891449762199490539968202460006397760197e-1",
                "5.0046675689560386299156300070846262227613e-1",
                "4.9990248004489361590178576245686015947581e-1",
                "4.9997526395650041930550062985220766047037e-1",
            };

            for ((int i, ddouble x) = (0, 1d / 16); i < expecteds.Length; i++, x += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.FresnelC(x);
                ddouble y_neg = ddouble.FresnelC(-x);
                ddouble y_dec = ddouble.FresnelC(ddouble.BitDecrement(x));
                ddouble y_inc = ddouble.FresnelC(ddouble.BitIncrement(x));

                Console.WriteLine(x);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 8e-30);
                HPAssert.AreEqual(-expected, y_neg, expected * 8e-30);
                HPAssert.AreEqual(expected, y_dec, expected * 8e-30);
                HPAssert.AreEqual(expected, y_inc, expected * 8e-30);
            }

            Assert.AreEqual(0, ddouble.FresnelC(0));

            Assert.IsTrue(ddouble.IsFinite(ddouble.FresnelC(ddouble.Epsilon)));

            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelS(ddouble.NaN)));
            Assert.AreEqual(0.5d, ddouble.FresnelC(ddouble.PositiveInfinity));
            Assert.AreEqual(-0.5d, ddouble.FresnelC(ddouble.NegativeInfinity));
        }

        [TestMethod]
        public void FresnelSTest() {
            ddouble[] expecteds = {
                "1.2783138855224588316718869362308636063348e-4",
                "1.0226098566217430539373989595747450535830e-3",
                "3.4507050163941716537798553824576128111125e-3",
                "8.1756002357777557781023088669427747524867e-3",
                "1.5952129455424389924969850220644932139487e-2",
                "2.7515569311172155313461234310167992190860e-2",
                "4.3563986203458386758956986386810689528714e-2",
                "6.4732432859999277611480512230614767650726e-2",
                "9.1557949898394939394929123723774555823625e-2",
                "1.2443492485654742427300761538506968213926e-1",
                "1.6356126508826181991029933653419948420091e-1",
                "2.0887711123338357022239297712186820302464e-1",
                "2.5999948421702116107593226492454948932309e-1",
                "3.1615829626329342074143398180362139541447e-1",
                "3.7614145707642173699430883531048450656965e-1",
                "4.3825914739035476607675669662515263749379e-1",
                "5.0033934931461712423037150408916459771686e-1",
                "5.5976789761486591664661272736226189862516e-1",
                "6.1358598882560202270943010739906412174471e-1",
                "6.5865551163667913056041236815301619956704e-1",
                "6.9189702635917893323571060061330969676817e-1",
                "7.1059621602881399425959568239222279470934e-1",
                "7.1276210305423486725733074501724374774591e-1",
                "6.9750496008209301308065516318726833294477e-1",
                "6.6538534598742441077497914136037082260920e-1",
                "6.1867096866799262011553526260806357182256e-1",
                "5.6142917870819339648573252700667605846493e-1",
                "4.9938467459067455156684442659134656915689e-1",
                "4.3948923023292248059107854889413340635061e-1",
                "3.8918631330154313832400168815583154647691e-1",
                "3.5540858000472693478276593851513882279970e-1",
                "3.4341567836369824219530081595806845688654e-1",
                "3.5565252300622494034602364459950282223489e-1",
                "3.9086673569606110062152774700361566254737e-1",
                "4.4374625981956217357063577460925555892821e-1",
                "5.0530222682369370355927402883734708352367e-1",
                "5.6411303997635930971450153909761678485570e-1",
                "6.0836410058071772450786323537315582598636e-1",
                "6.2838783622527603481228671708711531974746e-1",
                "6.1918175581959293611357623979855566939776e-1",
                "5.8223123721607027308626211787467392889346e-1",
                "5.2596791400871616340085571941740694262549e-1",
                "4.6441270161264127696294807375558127355328e-1",
                "4.1399090147578201682971496691136652588544e-1",
                "3.8909205071090744587036147362852370583204e-1",
                "3.9751918592036950548509547911784511325158e-1",
                "4.3731104817924424722813696312936731141612e-1",
                "4.9631299896737503609761226529911210385647e-1",
                "5.5520629967390682705424331254673279518786e-1",
                "5.9356427046848462817630043795531348138711e-1",
                "5.9721061772467508043811582812939285212672e-1",
                "5.6422119956714129572569029966222846903422e-1",
                "5.0686752053861805594806826887708819384597e-1",
                "4.4794789579586931047104897563291023936437e-1",
                "4.1211548627328309945309235880812488376656e-1",
                "4.1524801197243752389765332164157869170198e-1",
                "4.5647709452929710886455831305867198090377e-1",
                "5.1714827023216291146844215947146801358189e-1",
                "5.6835148110249486857295493650847939979847e-1",
                "5.8453320215047270471945945492441833541507e-1",
                "5.5696247412129340658143589468384805396923e-1",
                "4.9971615052903520353274586774959868328165e-1",
                "4.4371828323886546993382016107927494033326e-1",
                "4.2051575424692842444534314074306704545443e-1",
                "4.4392834397945460675960507964952763617001e-1",
                "5.0045609672556689639215786650171135392837e-1",
                "5.5566377645422678733067176401390633939688e-1",
                "5.7459586571658671207766313125772563711799e-1",
                "5.4458152448439223820553392869588187460503e-1",
                "4.8524778385704462043150504648086194369572e-1",
                "4.3711944993970883311576459129719525993885e-1",
                "4.3427297504870358947191613242511114990824e-1",
                "4.7915244540284431439892599486639375076588e-1",
                "5.3876856898600096234814338587575837578116e-1",
                "5.6775896672728669483534745186494856354905e-1",
                "5.4321579288204829651492020531493873078960e-1",
                "4.8442259158379991197853493386204171368813e-1",
                "4.3942734050197234528428568612438086421628e-1",
                "4.4617414021198471662728589437393637836422e-1",
                "4.9919138191711688675192838046599165540843e-1",
                "5.5203982079679826641713388320238679111486e-1",
                "5.5706034469137565823954664689957902512019e-1",
                "5.0934442069934600979291430367984187156833e-1",
                "4.5359401210824599230437680184536514965101e-1",
                "4.4350053871424448494580719381428287875772e-1",
                "4.8923752392483012879180617073418469719347e-1",
                "5.4506697059590376171010889550692908754750e-1",
                "5.5368406277902167296824819912708383953900e-1",
                "5.0584303589180049420137845058099291064718e-1",
                "4.5250964164074103932681941636393256660092e-1",
                "4.5190155410247627441341032380291271687295e-1",
                "5.0489488948115667726430526907860327234940e-1",
                "5.5148967230452164015055250882951434046579e-1",
                "5.3771150253493404539299182931042169783778e-1",
                "4.7963138131151939310393705148142271104257e-1",
                "4.4696076123693027762392028784077891910625e-1",
                "4.7978907708887545197608114086352765179250e-1",
                "5.3732653903763965381214007184579232442512e-1",
                "5.4654446670167598107356113156439603952603e-1",
                "4.9542162367354672987253153880824855170706e-1",
                "4.5111633786121229793907774398593384137597e-1",
                "4.7296186154487846750018792716422777108414e-1",
                "5.3130484708338607652019150960713016770091e-1",
                "5.4537645524323358023302547625172788267663e-1",
                "4.9530673532992789284411591700346603870474e-1",
                "4.5272756763389112826471311718165892990428e-1",
                "4.7960989045278195645598045361449779749655e-1",
                "5.3623869306991821488588373445670565859024e-1",
                "5.3754496655659312666999054849756538053155e-1",
                "4.8152489121786108673205282957773236743669e-1",
                "4.5499978722014109153365484049391158005628e-1",
                "4.9970478945344677586828238637962899137366e-1",
                "5.4419778318101174688652912581531358272009e-1",
                "5.1633763992463974076874560072502439822607e-1",
                "4.6201824199814025897536728644529495552437e-1",
                "4.7194472715389316353960861551009174280130e-1",
                "5.2923606782075215944863708450421436234467e-1",
                "5.3542924899517629660803311616629783171867e-1",
                "4.7981235754063864079506667615233772517549e-1",
                "4.6070123294683061084375857613529368104474e-1",
                "5.1224034993978820959073305578485516129207e-1",
                "5.4077762497033511820422794830308386305141e-1",
                "4.9389411075736628315308984472251307888582e-1",
                "4.5910764510265519877318109958644690275515e-1",
                "5.0203659765223724104188565826053277568767e-1",
                "5.4041002793098673277607024561931255201766e-1",
                "4.9995648059478218329721991741503942387085e-1",
                "4.6021421439301448386198863207105243391326e-1",
                "5.0004897583981328985582769992222837424939e-1",
                "5.3916670689551770755580417421925860157675e-1",
                "4.9803855207513881862195088871411105738701e-1",
                "4.6158760814186797723817076697785591359248e-1",
                "5.0567640205269340887289215372172819353960e-1",
                "5.3711914776220736797555147198105965117407e-1",
                "4.8898925808401712711647743004105146423332e-1",
                "4.6534124898107450714248214145698084475291e-1",
                "5.1758212031529405968194751708350635242708e-1",
                "5.3026261890246079930803825807190084398346e-1",
                "4.7534312399702317838475338998173151386087e-1",
                "4.7680618173631548961359211374247498369047e-1",
                "5.3101786831031885381295472222685860272065e-1",
                "5.1304252532697872705416803676075894220719e-1",
                "4.6505575818866558528512739930299737788720e-1",
                "4.9986104562968492986170709555971004637356e-1",
                "5.3443208172523352801514711155476086345862e-1",
                "4.8598636075116638829315980214323726210286e-1",
                "4.7222198011431436954528231401715614233159e-1",
                "5.2651844105386810592199264724730738322598e-1",
                "5.1453749541813365322530198573351618337057e-1",
                "4.6656914867220938812993793190445552613872e-1",
                "5.0339183941398286727075918684337192966825e-1",
                "5.3099984915139829533117788938012861291938e-1",
                "4.7881514346429920562565002067868873393540e-1",
                "4.8221165126348605607988345265691747318067e-1",
                "5.3189396334502225089961821048947034507349e-1",
                "4.9690889756353076819494951158975860863084e-1",
                "4.7071546323577142565495700821174603398616e-1",
                "5.2327203086064394554236445571319960528728e-1",
                "5.1217122893177201061709993390717309462772e-1",
                "4.6816997858488224040335111081044694605384e-1",
                "5.1219263743894327062594708427445988519042e-1",
                "5.2174784508108590587876572420260889785407e-1",
                "4.7054984507924814859394525728923033428305e-1",
                "5.0295018069720495569448934987744403108236e-1",
                "5.2642440630759573718868163821414487791755e-1",
                "4.7412870682304785351882539253460094785365e-1",
                "4.9710842850597009323153956386669582842566e-1",
                "5.2804040799812976056179736640181215685843e-1",
                "4.7664250949098476884885070188615710785515e-1",
                "4.9479512854795717249640086354374468947342e-1",
                "5.2800805755989797924282096527267367664685e-1",
                "4.7716324467462194948457704108704165750098e-1",
                "4.9577989736646555093496698270286181786439e-1",
                "5.2679014470316642484548170601492252416299e-1",
                "4.7574644150413142758554351072687357606740e-1",
                "4.9992388379375106273953212107383818103763e-1",
                "5.2386745468125536942184850669798310486337e-1",
                "4.7333210430424021244169328059564832441184e-1",
                "5.0701234474827593367408352391095590414911e-1",
                "5.1800432065897223801512827422361005646533e-1",
                "4.7189158684995813702228515168823498987254e-1",
                "5.1605643511822612633362366748194036352638e-1",
                "5.0797994329678438802664181034033123013674e-1",
                "4.7440277911222933225859704020173150313617e-1",
                "5.2432707058974052084446697046635707963315e-1",
                "4.9406370218756686934784827291268193346651e-1",
                "4.8385967740034911484721411836833792887023e-1",
                "5.2696544795530206456894149870168793839118e-1",
                "4.7996433746314978659795816149312376664569e-1",
                "5.0059733534493217293870532518927140960869e-1",
                "5.1878083602073895357042238766362694417550e-1",
                "4.7347456491993544793248131827165475393027e-1",
                "5.1873271084682796524902294275841894894469e-1",
                "4.9941256286008248195584072771702200538275e-1",
                "4.8253801513810669045724645160284031025498e-1",
                "5.2586441125403998361774335806355666035849e-1",
                "4.7917325116875167228815912152125039505822e-1",
                "5.0558348953510410347797819709617579052546e-1",
                "5.1197206328958259480514789418222726007946e-1",
                "4.7645404274109913227089620369358110072262e-1",
                "5.2427689441997073494562375533958652414475e-1",
                "4.8552367862970959059401634628021659017287e-1",
                "4.9887319605815419608504069045693679183906e-1",
                "5.1587553743485468410429783757522103424819e-1",
                "4.7592660975548788655249415106970877514725e-1",
                "5.2304913241107525752295962176427211988129e-1",
                "4.8624456311675625382059341882852037857332e-1",
                "4.9995388448191256140726535568270639112511e-1",
                "5.1345149166119034850358429450526632964007e-1",
                "4.7781048679405520482432903838187617600289e-1",
                "5.2389082123676675237974335305277525759317e-1",
                "4.8145748391464827893547608564989224145366e-1",
                "5.0815280073181506507209215088343926142616e-1",
                "5.0411038233259924553277797733270357272290e-1",
                "4.8505271644229512610751867701331634943977e-1",
                "5.2179926218777673056640304212971063931098e-1",
                "4.7663342740553367238088479727806825003325e-1",
                "5.1971602832229521313817026018686338467405e-1",
                "4.8795597637546449182728797105906548113962e-1",
                "5.0223027265730782268386002647714673028062e-1",
                "5.0766657941809421094484921352120206164286e-1",
                "4.8415373486290224390543024485356657792667e-1",
                "5.2106024865837830908017920564248601166072e-1",
                "4.7726375944182029503942380209779522907978e-1",
                "5.2095121275802827254131678563289247260289e-1",
                "4.8370385229748128551626285918524130073479e-1",
                "5.0968481507200087195631944566742033254294e-1",
                "4.9784539998208431750373132672274988680445e-1",
                "4.9469506265450676131879616468082511958651e-1",
                "5.1187534315933035547070451677171759878276e-1",
                "4.8302184283207138884587693578761148400717e-1",
                "5.2029395715602368583547778354625980315279e-1",
                "4.7825734995071825155787355172070134054726e-1",
                "5.2143866992838993176065091816914124519619e-1",
                "4.8036573337765100772753009473121056539845e-1",
                "5.1666168509677627720854308223145472784255e-1",
                "4.8711819407027810507008328450465780588137e-1",
                "5.0864355609975965962696210175200970424444e-1",
                "4.9574437483965432247131446387225073111712e-1",
                "4.9996997980970274342411608825064096412655e-1",
                "5.0402460341997075973481382898652801397737e-1",
                "4.9239863160839718147773404506463413510327e-1",
                "5.1068924301788782972758495932764372412867e-1",
                "4.8673644003085586865154306255271115285062e-1",
                "5.1533563096305389129819956615380139242976e-1",
                "4.8305751491933811803740629545552636279730e-1",
                "5.1813761891930076965894556217034449816062e-1",
                "4.8101678542100388704290038949381558721056e-1",
                "5.1954398028402853268030706940136955995627e-1",
                "4.8011744144280147617740429471910598147414e-1",
                "5.2005631757424489179577890237824902167338e-1",
                "4.7988472339530865576732307701012033023138e-1",
                "5.2010089924547568387168165351500744099363e-1",
                "4.7995449696183207700792431851620467622867e-1",
                "5.1997206852208643217894092299273856027188e-1",
                "4.8010572438090102486656698062608623508114e-1",
            };

            for ((int i, ddouble x) = (0, 1d / 16); i < expecteds.Length; i++, x += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.FresnelS(x);
                ddouble y_neg = ddouble.FresnelS(-x);
                ddouble y_dec = ddouble.FresnelS(ddouble.BitDecrement(x));
                ddouble y_inc = ddouble.FresnelS(ddouble.BitIncrement(x));

                Console.WriteLine(x);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 8e-30);
                HPAssert.AreEqual(-expected, y_neg, expected * 8e-30);
                HPAssert.AreEqual(expected, y_dec, expected * 8e-30);
                HPAssert.AreEqual(expected, y_inc, expected * 8e-30);
            }

            Assert.AreEqual(0, ddouble.FresnelS(0));

            Assert.IsTrue(ddouble.IsFinite(ddouble.FresnelS(ddouble.Epsilon)));

            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelS(ddouble.NaN)));
            Assert.AreEqual(0.5d, ddouble.FresnelS(ddouble.PositiveInfinity));
            Assert.AreEqual(-0.5d, ddouble.FresnelS(ddouble.NegativeInfinity));
        }
    }
}
