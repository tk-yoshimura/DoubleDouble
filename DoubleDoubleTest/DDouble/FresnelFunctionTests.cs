using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class FresnelFunctionTests {
        [TestMethod]
        public void FresnelCTest() {
            ddouble[] expecteds = {
                "6.2499764690704392437825626674536546182138e-2",
                "1.2499247029941109950559526257972854711344e-1",
                "1.8744282781397402464403866279445962150455e-1",
                "2.4975915035654318345922151780088572437814e-1",
                "3.1176545781475070117681803376661013894927e-1",
                "3.7317436047429970795682697625461851077175e-1",
                "4.3356166644468459033044864440831276017678e-1",
                "4.9234422587144639287884366515668163776610e-1",
                "5.4876319610834695080310565782385271887024e-1",
                "6.0187563714613758822211236562488318517875e-1",
                "6.5055804572508811570350097883950567514651e-1",
                "6.9352599078713589748587590899395547906400e-1",
                "7.2937425922452073042234910102251414907248e-1",
                "7.5664165311290255019680858424287815826697e-1",
                "7.7390355977475814250128095840313052334001e-1",
                "7.7989340037682282947420641365269013663063e-1",
                "7.7365084719733626711933472417447205321329e-1",
                "7.5469018670844954622034227769577171372111e-1",
                "7.2317649169968725842609114653238247735956e-1",
                "6.8009074107545508366792230510495898378424e-1",
                "6.2735846968805370038278434614365108341269e-1",
                "5.6791117203536701909922142357799261074146e-1",
                "5.0564719137783068129782143919611689747512e-1",
                "4.4526117603982153506455100974208978215940e-1",
                "3.9192036487020932330133081974371394259890e-1",
                "3.5078348478088720950770139876731879187428e-1",
                "3.2638427359081480290487721102288668420664e-1",
                "3.2193504614953785958835936070824847601607e-1",
                "3.3864217425287976689913088482347261248447e-1",
                "3.7515778106849233791676489584525164308028e-1",
                "4.2731066061144660528691637604497976613314e-1",
                "4.8825340607534075450022350335726103768837e-1",
                "5.4912213545516613124514998765288277083175e-1",
                "6.0022498790342553461694146071994177032789e-1",
                "6.3265958666408911423385937431390747038634e-1",
                "6.4012420994655464052361490469819710651753e-1",
                "6.2056246201406057896946151701828955120188e-1",
                "5.7720765528529174142898455042433307831611e-1",
                "5.1861436543336398837228528761373463864623e-1",
                "4.5741300964177704524565610495614443882908e-1",
                "4.0780295200544881371967036000461295723022e-1",
                "3.8217124064129374450766525757272119259863e-1",
                "3.8759862462293731872669933467971840339927e-1",
                "4.2326379628366276346541950113929321236102e-1",
                "4.7974546437114452943680885232710746553480e-1",
                "5.4085840831524388542615501057628341822650e-1",
                "5.8795406770335353482697177959641730798407e-1",
                "6.0572078929768562955616107428715469714522e-1",
                "5.8772447300718123101696122468690808423555e-1",
                "5.3959688412174216369971046787337528779399e-1",
                "4.7820044752594189243237021434748185217671e-1",
                "4.2633865559802077062431254760673412851663e-1",
                "4.0434908488322022014757692747022159027482e-1",
                "4.2156570560807362219458523480535084837208e-1",
                "4.7135356932560365513465711151090289266791e-1",
                "5.3257243502800084532952032250263351326114e-1",
                "5.7787591326669049098198269804375343318606e-1",
                "5.8599023167070093339171678205528276855866e-1",
                "5.5253028905486405824834704453721851367899e-1",
                "4.9359046264602496047468310895483529138601e-1",
                "4.3909337077533663313910536300585280089964e-1",
                "4.1794683830103865730188851185001257979409e-1",
                "4.4208619282795364090780946500912264393983e-1",
                "4.9842603303817761553070958682450973003501e-1",
                "5.5462536133187407966806270496858700009287e-1",
                "5.7709800784716843840291160851306922985891e-1",
                "5.5167506844449113298025816302886120231615e-1",
                "4.9397314947167313306951231158254804084814e-1",
                "4.4124069751924664959769718176540536163964e-1",
                "4.2880560669348869979653932079426832539453e-1",
                "4.6557863471427204053997345529950595068597e-1",
                "5.2602591505353874136960693692023096651580e-1",
                "5.6653652854821416901421404728405005107880e-1",
                "5.5681994702498039703656527322163005777373e-1",
                "5.0389371716372022807301163346581828717953e-1",
                "4.4882726502533662827982967968235723285221e-1",
                "4.3575011954337042460468069280058106922361e-1",
                "4.7569969928562681009214641288849964742427e-1",
                "5.3543101864682602833607833322387376904494e-1",
                "5.6363118870401223110210740441301396412075e-1",
                "5.3524514373483333135949548825712256905209e-1",
                "4.7552841921797180827331361461185795221104e-1",
                "4.3937635201715424817179169959905399170456e-1",
                "4.6101157744078022846151757337618189404033e-1",
                "5.1988979161194936239468921832824707485551e-1",
                "5.5821607261513579895463802956970562899088e-1",
                "5.3733487666945655186267435185827632989317e-1",
                "4.7842141492531445350830934156377729720221e-1",
                "4.4309000369710785340802171878447395592703e-1",
                "4.6925424736700995998737132445939551754571e-1",
                "5.2858821151980663510516280947037213051378e-1",
                "5.5512857331847213127031699080797155674837e-1",
                "5.1861376451498635740348170164703415642987e-1",
                "4.6111408153917872763740302688462967654071e-1",
                "4.5042185192225164534720455098366327514204e-1",
                "4.9953146785550112018827990327113522776271e-1",
                "5.4844825732128061296729831132621278563884e-1",
                "5.3614599378436436811620348918870540361153e-1",
                "4.7810964385385517801887190135589220215783e-1",
                "4.4928509345850480361392123015420213416772e-1",
                "4.8765933506823109796049281204781484615708e-1",
                "5.4196757265035761050517957639239322159974e-1",
                "5.3826503912483986367918748598564917405183e-1",
                "4.8160345989096403455552409694360703874506e-1",
                "4.5172987202256374768593408346878245655745e-1",
                "4.9144407457308491003824001439804599676221e-1",
                "5.4300250623005064485748290975468289971379e-1",
                "5.3016620605241866291918055748892470925629e-1",
                "4.7219656059601260366743090615333602997457e-1",
                "4.5755191559409246906378041913593617897533e-1",
                "5.0892891689598875208315120298107332288673e-1",
                "5.4546709254696981032706902646163409255850e-1",
                "5.0880262978594922418622705059261652130652e-1",
                "4.5842414403741623762002278266860755710242e-1",
                "4.7723343263352243191748845174575624868226e-1",
                "5.3376656924787114231522550096865418676693e-1",
                "5.3224499043238159865003552378628045559567e-1",
                "4.7535669438013846927872253384765570466366e-1",
                "4.6226643045913473665292986385566290974924e-1",
                "5.1601825015233634634154681699468840040235e-1",
                "5.4026804303607491800284449548502321633151e-1",
                "4.9107721427595335832232241589161531160020e-1",
                "4.5904954066771497540150232369597705152354e-1",
                "5.0380891591942716535165198573522112286569e-1",
                "5.4068996218864746776941486019495975748121e-1",
                "4.9921543690445480258671148992764861929021e-1",
                "4.5990054733765034881911702189201178800523e-1",
                "4.9980218037719713555698386025998493803712e-1",
                "5.3947790095839570667113123619583686874638e-1",
                "4.9922740163517117482473222159433043943564e-1",
                "4.6117416006515121680017663735490736560759e-1",
                "5.0360203437810607572756012290316952884126e-1",
                "5.3786780443255711821425541690747322488439e-1",
                "4.9184134022779096264678561260351369052954e-1",
                "4.6391893126202601182298818693999339972098e-1",
                "5.1417759858373344687722344711398188037225e-1",
                "5.3275225774313747094178364620577711485424e-1",
                "4.7887975405187225066384678330675914940191e-1",
                "4.7290004083756918674914626087112944456597e-1",
                "5.2802340488625188497756448360627196217951e-1",
                "5.1850557441512449174569131065251829126761e-1",
                "4.6659116088960670433716256901626373750388e-1",
                "4.9312729283243299385828097836680924114796e-1",
                "5.3536612746811985255106330305762761709389e-1",
                "4.9307006875165224026542497033621987828489e-1",
                "4.6805673877071090615028801348770763841260e-1",
                "5.2070361865128352708801437501161547516536e-1",
                "5.2192869898246377873301868347657267110261e-1",
                "4.6906590289687369673321922117304034349597e-1",
                "4.9407441775592648254314189670030588333840e-1",
                "5.3355613621089162665656102115093575225017e-1",
                "4.8728733102656716351584917440614717619313e-1",
                "4.7432550588277815146104433246868573881236e-1",
                "5.2787851400892771168114819871548807453904e-1",
                "5.0789605601685623072579247272197591884953e-1",
                "4.6750041651646531985042353674382528911711e-1",
                "5.1395212117253806475164544822418468825691e-1",
                "5.2230207086123848952931312886174271128613e-1",
                "4.7037223216318799015449936863362189659638e-1",
                "4.9989869420551572361415184773562111439235e-1",
                "5.2918826145421153839848509802582658495331e-1",
                "4.7729906833985332997198873452753153178267e-1",
                "4.8956441728482190416811189041934239701850e-1",
                "5.3091345661481617631468704369728414622025e-1",
                "4.8404871310469626625807491589995661448793e-1",
                "4.8350981066541983819552906777346208152031e-1",
                "5.3035870924194361038022426916911515426603e-1",
                "4.8848000730270921217768014750621531585725e-1",
                "4.8095899234657473772215486185297563703958e-1",
                "5.2950237301287368886905959480832291747111e-1",
                "4.8987260787095227711496403170612557670512e-1",
                "4.8115286225762747507966798054155133158530e-1",
                "5.2913446662493304327279098699080325388242e-1",
                "4.8821090830709167289211188867297168349419e-1",
                "4.8391592992180219421195108823121465977588e-1",
                "5.2893666175579644963481599231985598465200e-1",
                "4.8392994283629780882090983546034260046530e-1",
                "4.8963419347200139995507717600217968332384e-1",
                "5.2757413830581192283559016849720201020241e-1",
                "4.7817383307129618764783775003117643926785e-1",
                "4.9872191333857629416646789029935177646693e-1",
                "5.2291793044346929789249639482940496947666e-1",
                "4.7333865685786371712646796702613505179048e-1",
                "5.1053061299658130731457898444854839514649e-1",
                "5.1288587335657570770519603992751921746652e-1",
                "4.7327013139624912880058391980381999119092e-1",
                "5.2193670246845616540443716380238569520715e-1",
                "4.9740689018889329935581737793369315758863e-1",
                "4.8198092489001981273165780281155490501918e-1",
                "5.2679804511159556088613021523052844830694e-1",
                "4.8107200950678156421410179806491162731964e-1",
                "4.9994136935201138031000091691537162919824e-1",
                "5.1858536287064083634985362085865054863444e-1",
                "4.7375451917432142818180409720455890809933e-1",
                "5.1942162368403831992869854812632994483387e-1",
                "4.9750795860766678680901796863289265641682e-1",
                "4.8468374478234368009782300608048773612560e-1",
                "5.2510840904690902404187199469444551569559e-1",
                "4.7738043042751187206849681122284425934688e-1",
                "5.0969690766970042657910737731893316095959e-1",
                "5.0725525132003733182380616980693631086270e-1",
                "4.7935776455447300790873115733237002444913e-1",
                "5.2506290149650339177500956517763071038295e-1",
                "4.8073265406176302628821226555842602324546e-1",
                "5.0613755918404786425401146133297675064843e-1",
                "5.0894191255635932114440785022303462445364e-1",
                "4.7960104832137056499562004406542462993518e-1",
                "5.2448511530435840639837918170252500205066e-1",
                "4.7968111141982337631764913286795676391457e-1",
                "5.0978691914291404432620942874683983613328e-1",
                "5.0343880520037530689829924547731138054894e-1",
                "4.8472620655799753521806642893476565158208e-1",
                "5.2247753316203186397560916231691776853410e-1",
                "4.7655896749272071002574030967744680016270e-1",
                "5.1837660886303020301377652148800916073886e-1",
                "4.9101502211761508315624932163561137534314e-1",
                "4.9780248887645718475797691078449978808904e-1",
                "5.1253244944440180830278302921860853186906e-1",
                "4.8010646458233347606915049507077585848622e-1",
                "5.2304196145790334450582878512882962734999e-1",
                "4.7826774418679000408504824267334249310093e-1",
                "5.1658884504108994965938901758340154239131e-1",
                "4.9116538565468478846390411416000041220322e-1",
                "4.9996307683096610045195378037577624167512e-1",
                "5.0856738046303166479388801186218445150335e-1",
                "4.8443513762618563103899447183602193187528e-1",
                "5.2023782170669276396717688873194685526742e-1",
                "4.7776675736886276984227928721926739530158e-1",
                "5.2159789145198704619229285120730483048219e-1",
                "4.8131053813405559028516401907359637646333e-1",
                "5.1406506432163197267549679725318291213102e-1",
                "4.9162993982669210749656134709724880202039e-1",
                "5.0224326550930375152404691784253537623975e-1",
                "5.0375283513396341737375006112274521413166e-1",
                "4.9082541077849896132197418546979141991991e-1",
                "5.1371473526016174594048590853216336867450e-1",
                "4.8279990821193450087231411352782026960439e-1",
                "5.1957551311813019836668031865931260479999e-1",
                "4.7911992271720960655209131676914573949902e-1",
                "5.2122053167437345793460004588139668472182e-1",
                "4.7925427195762281763122649753616831785342e-1",
                "5.1962444380335836904799042815292980554597e-1",
                "4.8197218855063404723430530872961222874531e-1",
                "5.1611666271815986321485642676354975371955e-1",
                "4.8596653618465751772422369749374712224626e-1",
                "5.1189814772268530307692475362192599106335e-1",
                "4.9019301112004797844567804650454507669161e-1",
                "5.0783365540525173147735880986865249907341e-1",
                "4.9396834104489838274223091808254254461666e-1",
                "5.0443755634111362546973211238698202355375e-1",
                "4.9692559400979039294113945894560105323156e-1",
                "5.0195512363733672769386507622027943927700e-1",
                "4.9891449762199490539968202460006397760197e-1",
                "5.0046675689560386299156300070846262227613e-1",
                "4.9990248004489361590178576245686015947581e-1",
                "4.9997526395650041930550062985220766047037e-1",
                "4.9990285395399558684024433620404632602477e-1",
                "5.0046028733116232442709334689920823496281e-1",
                "4.9893849933739773383891587819157213415166e-1",
                "5.0189648265899207279120247379232055726552e-1",
                "4.9704151061073311689598543149412220037096e-1",
                "5.0423652636774489511137807902608059730724e-1",
                "4.9428689310028758034985342902125987625456e-1",
                "5.0736167237605391035387694024645984500080e-1",
                "4.9085617320684606468855499314710239106969e-1",
                "5.1100661658285485614400704180400319733846e-1",
                "4.8711981630292588182169426857838772172436e-1",
                "5.1467622815279572678330935440491751966508e-1",
                "4.8371217694388559796057093603305119358220e-1",
                "5.1759120996788843171864614427599385254902e-1",
                "4.8154976365239740264250648267146892222653e-1",
                "5.1872404281097372375728899090762828248017e-1",
                "4.8172157589239830289326843808673905348108e-1",
                "5.1700093315985050637958960003727710276284e-1",
                "4.8518075756098267304622799428093702866555e-1",
                "5.1172151706763597932308401323034189275321e-1",
                "4.9222337195755705420371929495398592454015e-1",
                "5.0315104191992248149271805812908189550855e-1",
                "5.0188165921349827871408883983639392058277e-1",
                "4.9305680746541789310226791107894751578515e-1",
                "5.1156932882288481097453011815981231737016e-1",
                "4.8475177880815532780344499780218679486145e-1",
                "5.1747909933899341770125824246627144133689e-1",
                "4.8215167954854922064953751941551415189925e-1",
                "5.1611484540890157425378154908180168356136e-1",
                "4.8770816333063842181745140675239164836560e-1",
                "5.0670642482796230195333655813415768974821e-1",
                "4.9998262693470038802800589652475394216142e-1",
                "4.9317217805076848118556807732182027069304e-1",
                "5.1270740365985584685761002073975828763139e-1",
                "4.8349125092660630963339669863244350750091e-1",
                "5.1735923761944605939127798587836057874436e-1",
                "4.8513745060839044150924439510306821918277e-1",
                "5.0928152939825059126258037713815754284573e-1",
                "4.9839716653924512716237972630219383173058e-1",
                "4.9343037308486559534099163879743070298350e-1",
                "5.1331208084128997604803506428064277219634e-1",
                "4.8316387181638351973849184466950936484691e-1",
                "5.1600737548329194438670002767182411453491e-1",
                "4.8921834995947442586591707645698765019679e-1",
                "5.0239501610694703593461042068196963892457e-1",
                "5.0682023901677750059087380700681858628080e-1",
                "4.8597550030009007401420812381704188895434e-1",
                "5.1675311283005531214225106807007816516311e-1",
                "4.8616494975865277624321780159440063534883e-1",
                "5.0600346846460763233676915130528926682131e-1",
                "5.0411566888038048756642562182333133896749e-1",
                "4.8722686402690986882206037220743388956781e-1",
                "5.1646622438948853667232418554002115146662e-1",
                "4.8655999063613100632576430039981826331305e-1",
                "5.0467069511401131541689620721710307794226e-1",
                "5.0623412768912197929010049284014453985480e-1",
                "4.8560942063924213820814174581522602320838e-1",
                "5.1582841463410649154346814883286602090741e-1",
                "4.9043783175176984272686682644446500564502e-1",
                "4.9843335394667981043491770203890789209852e-1",
                "5.1196147011785426864837482724097149440011e-1",
                "4.8398894631102453859077706985054417375684e-1",
                "5.1122882458427467985689179651136141544819e-1",
                "4.9998733497234438818700621369766021642521e-1",
            };

            for ((int i, ddouble x) = (0, 1d / 16); i < expecteds.Length; i++, x += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.FresnelC(x);
                ddouble y_neg = ddouble.FresnelC(-x);
                ddouble y_dec = ddouble.FresnelC(ddouble.BitDecrement(x));
                ddouble y_inc = ddouble.FresnelC(ddouble.BitIncrement(x));

                Console.WriteLine(x);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-30d);
                HPAssert.AreEqual(-expected, y_neg, expected * 1e-30d);
                HPAssert.AreEqual(expected, y_dec, expected * 1e-30d);
                HPAssert.AreEqual(expected, y_inc, expected * 1e-30d);
            }

            Assert.AreEqual(0, ddouble.FresnelC(0));

            Assert.IsTrue(ddouble.IsFinite(ddouble.FresnelC(ddouble.Epsilon)));

            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelC(ddouble.NaN)));
            Assert.AreEqual(0.5d, ddouble.FresnelC(ddouble.PositiveInfinity));
            Assert.AreEqual(-0.5d, ddouble.FresnelC(ddouble.NegativeInfinity));
        }

        [TestMethod]
        public void FresnelSTest() {
            ddouble[] expecteds = {
                "1.2783138855224588316718869362308636063348e-4",
                "1.0226098566217430539373989595747450535830e-3",
                "3.4507050163941716537798553824576128111125e-3",
                "8.1756002357777557781023088669427747524867e-3",
                "1.5952129455424389924969850220644932139487e-2",
                "2.7515569311172155313461234310167992190860e-2",
                "4.3563986203458386758956986386810689528714e-2",
                "6.4732432859999277611480512230614767650726e-2",
                "9.1557949898394939394929123723774555823625e-2",
                "1.2443492485654742427300761538506968213926e-1",
                "1.6356126508826181991029933653419948420091e-1",
                "2.0887711123338357022239297712186820302464e-1",
                "2.5999948421702116107593226492454948932309e-1",
                "3.1615829626329342074143398180362139541447e-1",
                "3.7614145707642173699430883531048450656965e-1",
                "4.3825914739035476607675669662515263749379e-1",
                "5.0033934931461712423037150408916459771686e-1",
                "5.5976789761486591664661272736226189862516e-1",
                "6.1358598882560202270943010739906412174471e-1",
                "6.5865551163667913056041236815301619956704e-1",
                "6.9189702635917893323571060061330969676817e-1",
                "7.1059621602881399425959568239222279470934e-1",
                "7.1276210305423486725733074501724374774591e-1",
                "6.9750496008209301308065516318726833294477e-1",
                "6.6538534598742441077497914136037082260920e-1",
                "6.1867096866799262011553526260806357182256e-1",
                "5.6142917870819339648573252700667605846493e-1",
                "4.9938467459067455156684442659134656915689e-1",
                "4.3948923023292248059107854889413340635061e-1",
                "3.8918631330154313832400168815583154647691e-1",
                "3.5540858000472693478276593851513882279970e-1",
                "3.4341567836369824219530081595806845688654e-1",
                "3.5565252300622494034602364459950282223489e-1",
                "3.9086673569606110062152774700361566254737e-1",
                "4.4374625981956217357063577460925555892821e-1",
                "5.0530222682369370355927402883734708352367e-1",
                "5.6411303997635930971450153909761678485570e-1",
                "6.0836410058071772450786323537315582598636e-1",
                "6.2838783622527603481228671708711531974746e-1",
                "6.1918175581959293611357623979855566939776e-1",
                "5.8223123721607027308626211787467392889346e-1",
                "5.2596791400871616340085571941740694262549e-1",
                "4.6441270161264127696294807375558127355328e-1",
                "4.1399090147578201682971496691136652588544e-1",
                "3.8909205071090744587036147362852370583204e-1",
                "3.9751918592036950548509547911784511325158e-1",
                "4.3731104817924424722813696312936731141612e-1",
                "4.9631299896737503609761226529911210385647e-1",
                "5.5520629967390682705424331254673279518786e-1",
                "5.9356427046848462817630043795531348138711e-1",
                "5.9721061772467508043811582812939285212672e-1",
                "5.6422119956714129572569029966222846903422e-1",
                "5.0686752053861805594806826887708819384597e-1",
                "4.4794789579586931047104897563291023936437e-1",
                "4.1211548627328309945309235880812488376656e-1",
                "4.1524801197243752389765332164157869170198e-1",
                "4.5647709452929710886455831305867198090377e-1",
                "5.1714827023216291146844215947146801358189e-1",
                "5.6835148110249486857295493650847939979847e-1",
                "5.8453320215047270471945945492441833541507e-1",
                "5.5696247412129340658143589468384805396923e-1",
                "4.9971615052903520353274586774959868328165e-1",
                "4.4371828323886546993382016107927494033326e-1",
                "4.2051575424692842444534314074306704545443e-1",
                "4.4392834397945460675960507964952763617001e-1",
                "5.0045609672556689639215786650171135392837e-1",
                "5.5566377645422678733067176401390633939688e-1",
                "5.7459586571658671207766313125772563711799e-1",
                "5.4458152448439223820553392869588187460503e-1",
                "4.8524778385704462043150504648086194369572e-1",
                "4.3711944993970883311576459129719525993885e-1",
                "4.3427297504870358947191613242511114990824e-1",
                "4.7915244540284431439892599486639375076588e-1",
                "5.3876856898600096234814338587575837578116e-1",
                "5.6775896672728669483534745186494856354905e-1",
                "5.4321579288204829651492020531493873078960e-1",
                "4.8442259158379991197853493386204171368813e-1",
                "4.3942734050197234528428568612438086421628e-1",
                "4.4617414021198471662728589437393637836422e-1",
                "4.9919138191711688675192838046599165540843e-1",
                "5.5203982079679826641713388320238679111486e-1",
                "5.5706034469137565823954664689957902512019e-1",
                "5.0934442069934600979291430367984187156833e-1",
                "4.5359401210824599230437680184536514965101e-1",
                "4.4350053871424448494580719381428287875772e-1",
                "4.8923752392483012879180617073418469719347e-1",
                "5.4506697059590376171010889550692908754750e-1",
                "5.5368406277902167296824819912708383953900e-1",
                "5.0584303589180049420137845058099291064718e-1",
                "4.5250964164074103932681941636393256660092e-1",
                "4.5190155410247627441341032380291271687295e-1",
                "5.0489488948115667726430526907860327234940e-1",
                "5.5148967230452164015055250882951434046579e-1",
                "5.3771150253493404539299182931042169783778e-1",
                "4.7963138131151939310393705148142271104257e-1",
                "4.4696076123693027762392028784077891910625e-1",
                "4.7978907708887545197608114086352765179250e-1",
                "5.3732653903763965381214007184579232442512e-1",
                "5.4654446670167598107356113156439603952603e-1",
                "4.9542162367354672987253153880824855170706e-1",
                "4.5111633786121229793907774398593384137597e-1",
                "4.7296186154487846750018792716422777108414e-1",
                "5.3130484708338607652019150960713016770091e-1",
                "5.4537645524323358023302547625172788267663e-1",
                "4.9530673532992789284411591700346603870474e-1",
                "4.5272756763389112826471311718165892990428e-1",
                "4.7960989045278195645598045361449779749655e-1",
                "5.3623869306991821488588373445670565859024e-1",
                "5.3754496655659312666999054849756538053155e-1",
                "4.8152489121786108673205282957773236743669e-1",
                "4.5499978722014109153365484049391158005628e-1",
                "4.9970478945344677586828238637962899137366e-1",
                "5.4419778318101174688652912581531358272009e-1",
                "5.1633763992463974076874560072502439822607e-1",
                "4.6201824199814025897536728644529495552437e-1",
                "4.7194472715389316353960861551009174280130e-1",
                "5.2923606782075215944863708450421436234467e-1",
                "5.3542924899517629660803311616629783171867e-1",
                "4.7981235754063864079506667615233772517549e-1",
                "4.6070123294683061084375857613529368104474e-1",
                "5.1224034993978820959073305578485516129207e-1",
                "5.4077762497033511820422794830308386305141e-1",
                "4.9389411075736628315308984472251307888582e-1",
                "4.5910764510265519877318109958644690275515e-1",
                "5.0203659765223724104188565826053277568767e-1",
                "5.4041002793098673277607024561931255201766e-1",
                "4.9995648059478218329721991741503942387085e-1",
                "4.6021421439301448386198863207105243391326e-1",
                "5.0004897583981328985582769992222837424939e-1",
                "5.3916670689551770755580417421925860157675e-1",
                "4.9803855207513881862195088871411105738701e-1",
                "4.6158760814186797723817076697785591359248e-1",
                "5.0567640205269340887289215372172819353960e-1",
                "5.3711914776220736797555147198105965117407e-1",
                "4.8898925808401712711647743004105146423332e-1",
                "4.6534124898107450714248214145698084475291e-1",
                "5.1758212031529405968194751708350635242708e-1",
                "5.3026261890246079930803825807190084398346e-1",
                "4.7534312399702317838475338998173151386087e-1",
                "4.7680618173631548961359211374247498369047e-1",
                "5.3101786831031885381295472222685860272065e-1",
                "5.1304252532697872705416803676075894220719e-1",
                "4.6505575818866558528512739930299737788720e-1",
                "4.9986104562968492986170709555971004637356e-1",
                "5.3443208172523352801514711155476086345862e-1",
                "4.8598636075116638829315980214323726210286e-1",
                "4.7222198011431436954528231401715614233159e-1",
                "5.2651844105386810592199264724730738322598e-1",
                "5.1453749541813365322530198573351618337057e-1",
                "4.6656914867220938812993793190445552613872e-1",
                "5.0339183941398286727075918684337192966825e-1",
                "5.3099984915139829533117788938012861291938e-1",
                "4.7881514346429920562565002067868873393540e-1",
                "4.8221165126348605607988345265691747318067e-1",
                "5.3189396334502225089961821048947034507349e-1",
                "4.9690889756353076819494951158975860863084e-1",
                "4.7071546323577142565495700821174603398616e-1",
                "5.2327203086064394554236445571319960528728e-1",
                "5.1217122893177201061709993390717309462772e-1",
                "4.6816997858488224040335111081044694605384e-1",
                "5.1219263743894327062594708427445988519042e-1",
                "5.2174784508108590587876572420260889785407e-1",
                "4.7054984507924814859394525728923033428305e-1",
                "5.0295018069720495569448934987744403108236e-1",
                "5.2642440630759573718868163821414487791755e-1",
                "4.7412870682304785351882539253460094785365e-1",
                "4.9710842850597009323153956386669582842566e-1",
                "5.2804040799812976056179736640181215685843e-1",
                "4.7664250949098476884885070188615710785515e-1",
                "4.9479512854795717249640086354374468947342e-1",
                "5.2800805755989797924282096527267367664685e-1",
                "4.7716324467462194948457704108704165750098e-1",
                "4.9577989736646555093496698270286181786439e-1",
                "5.2679014470316642484548170601492252416299e-1",
                "4.7574644150413142758554351072687357606740e-1",
                "4.9992388379375106273953212107383818103763e-1",
                "5.2386745468125536942184850669798310486337e-1",
                "4.7333210430424021244169328059564832441184e-1",
                "5.0701234474827593367408352391095590414911e-1",
                "5.1800432065897223801512827422361005646533e-1",
                "4.7189158684995813702228515168823498987254e-1",
                "5.1605643511822612633362366748194036352638e-1",
                "5.0797994329678438802664181034033123013674e-1",
                "4.7440277911222933225859704020173150313617e-1",
                "5.2432707058974052084446697046635707963315e-1",
                "4.9406370218756686934784827291268193346651e-1",
                "4.8385967740034911484721411836833792887023e-1",
                "5.2696544795530206456894149870168793839118e-1",
                "4.7996433746314978659795816149312376664569e-1",
                "5.0059733534493217293870532518927140960869e-1",
                "5.1878083602073895357042238766362694417550e-1",
                "4.7347456491993544793248131827165475393027e-1",
                "5.1873271084682796524902294275841894894469e-1",
                "4.9941256286008248195584072771702200538275e-1",
                "4.8253801513810669045724645160284031025498e-1",
                "5.2586441125403998361774335806355666035849e-1",
                "4.7917325116875167228815912152125039505822e-1",
                "5.0558348953510410347797819709617579052546e-1",
                "5.1197206328958259480514789418222726007946e-1",
                "4.7645404274109913227089620369358110072262e-1",
                "5.2427689441997073494562375533958652414475e-1",
                "4.8552367862970959059401634628021659017287e-1",
                "4.9887319605815419608504069045693679183906e-1",
                "5.1587553743485468410429783757522103424819e-1",
                "4.7592660975548788655249415106970877514725e-1",
                "5.2304913241107525752295962176427211988129e-1",
                "4.8624456311675625382059341882852037857332e-1",
                "4.9995388448191256140726535568270639112511e-1",
                "5.1345149166119034850358429450526632964007e-1",
                "4.7781048679405520482432903838187617600289e-1",
                "5.2389082123676675237974335305277525759317e-1",
                "4.8145748391464827893547608564989224145366e-1",
                "5.0815280073181506507209215088343926142616e-1",
                "5.0411038233259924553277797733270357272290e-1",
                "4.8505271644229512610751867701331634943977e-1",
                "5.2179926218777673056640304212971063931098e-1",
                "4.7663342740553367238088479727806825003325e-1",
                "5.1971602832229521313817026018686338467405e-1",
                "4.8795597637546449182728797105906548113962e-1",
                "5.0223027265730782268386002647714673028062e-1",
                "5.0766657941809421094484921352120206164286e-1",
                "4.8415373486290224390543024485356657792667e-1",
                "5.2106024865837830908017920564248601166072e-1",
                "4.7726375944182029503942380209779522907978e-1",
                "5.2095121275802827254131678563289247260289e-1",
                "4.8370385229748128551626285918524130073479e-1",
                "5.0968481507200087195631944566742033254294e-1",
                "4.9784539998208431750373132672274988680445e-1",
                "4.9469506265450676131879616468082511958651e-1",
                "5.1187534315933035547070451677171759878276e-1",
                "4.8302184283207138884587693578761148400717e-1",
                "5.2029395715602368583547778354625980315279e-1",
                "4.7825734995071825155787355172070134054726e-1",
                "5.2143866992838993176065091816914124519619e-1",
                "4.8036573337765100772753009473121056539845e-1",
                "5.1666168509677627720854308223145472784255e-1",
                "4.8711819407027810507008328450465780588137e-1",
                "5.0864355609975965962696210175200970424444e-1",
                "4.9574437483965432247131446387225073111712e-1",
                "4.9996997980970274342411608825064096412655e-1",
                "5.0402460341997075973481382898652801397737e-1",
                "4.9239863160839718147773404506463413510327e-1",
                "5.1068924301788782972758495932764372412867e-1",
                "4.8673644003085586865154306255271115285062e-1",
                "5.1533563096305389129819956615380139242976e-1",
                "4.8305751491933811803740629545552636279730e-1",
                "5.1813761891930076965894556217034449816062e-1",
                "4.8101678542100388704290038949381558721056e-1",
                "5.1954398028402853268030706940136955995627e-1",
                "4.8011744144280147617740429471910598147414e-1",
                "5.2005631757424489179577890237824902167338e-1",
                "4.7988472339530865576732307701012033023138e-1",
                "5.2010089924547568387168165351500744099363e-1",
                "4.7995449696183207700792431851620467622867e-1",
                "5.1997206852208643217894092299273856027188e-1",
                "4.8010572438090102486656698062608623508114e-1",
                "5.1981664437421483329474504446362111529534e-1",
                "4.8026529305772064462429331075424064277929e-1",
                "5.1963518661800156283994668335285944838879e-1",
                "4.8050379293805168718720282542101923528501e-1",
                "5.1928760045639689236674002829629972586098e-1",
                "4.8102857342564674395727604173195694481622e-1",
                "5.1850285410581859494475643548735619348151e-1",
                "4.8216841210237449505876130115773585600829e-1",
                "5.1690404576757618047082178259432909822490e-1",
                "4.8433351140494491110568937558195252623733e-1",
                "5.1406927746869413477691668767477113557558e-1",
                "4.8792763995515545868925254492594555131003e-1",
                "5.0965196285549817976388423405611338265512e-1",
                "4.9319172287403712067138450789309017366199e-1",
                "5.0357366852931813302837654790687442161020e-1",
                "4.9997937729695532558486060911274395992062e-1",
                "4.9626828121972449811660201288573714477291e-1",
                "5.0751392778328308392358858763707780037511e-1",
                "4.8889266775403547167463802200957512213781e-1",
                "5.1425159507847428229603648468063666624782e-1",
                "4.8333950934742174694281766028564029384796e-1",
                "5.1804691744512071317774304006452394850442e-1",
                "4.8184295974466483077398054186064898316921e-1",
                "5.1681175100068670179596741036686790939498e-1",
                "4.8604854895546521744873854077785542829018e-1",
                "5.0967773363767762963364346749008913591001e-1",
                "4.9571667243090994960512000466207973990226e-1",
                "4.9826029904504579304283066722845890696876e-1",
                "5.0772321669753832184153059449639346540600e-1",
                "4.8711520760151194260537764187957232209724e-1",
                "5.1642939608274921745516972763466478481568e-1",
                "4.8231616863711996159436104747356014710552e-1",
                "5.1624618927618533370762688039861938576305e-1",
                "4.8787805108093141567902464282136900840637e-1",
                "5.0581075690504018895759737438650088387975e-1",
                "5.0169298616859979742386167515289777569531e-1",
                "4.9098662069260253870422467843134909406691e-1",
                "5.1462661127008094248801320567441420978563e-1",
                "4.8281033843425840471335567238677536913946e-1",
                "5.1590229813703498098564920268236880323935e-1",
                "4.8919067973487825023235206467934955668639e-1",
                "5.0293726185472627541713834110550653802392e-1",
                "5.0582204451687852347360704085657897953151e-1",
                "4.8688675024835802000148365260466928865021e-1",
                "5.1674972931785854721076601355819221369959e-1",
                "4.8457660636863354220214923973703481928635e-1",
                "5.0926477446491761290486939292447358397597e-1",
                "4.9998522816706786946361500505662485770933e-1",
                "4.9065008104918942513028065944553608566549e-1",
                "5.1552316146619951590671183370668280764269e-1",
                "4.8392922617698833116309332452457492344147e-1",
                "5.1050101638489318769822183812172999804186e-1",
                "4.9927823705982183459236915470738917329329e-1",
                "4.9055151619690931831852318446221459470041e-1",
                "5.1569583916608198792739859395571500498829e-1",
                "4.8491377747941919717566805543036639902167e-1",
                "5.0759406382071810229103862024708645292781e-1",
                "5.0354065054281313052675390179647586734853e-1",
                "4.8696266130915592771001754029764091454637e-1",
                "5.1604060579989903341769090363270011492802e-1",
                "4.8927421764207849406349750881196231185723e-1",
                "4.9961986007487793162217737240846103243861e-1",
                "5.1134928349584278682966712247410555666209e-1",
                "4.8408453592595389271475424485583471677011e-1",
            };

            for ((int i, ddouble x) = (0, 1d / 16); i < expecteds.Length; i++, x += 1d / 16) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.FresnelS(x);
                ddouble y_neg = ddouble.FresnelS(-x);
                ddouble y_dec = ddouble.FresnelS(ddouble.BitDecrement(x));
                ddouble y_inc = ddouble.FresnelS(ddouble.BitIncrement(x));

                Console.WriteLine(x);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, expected * 1e-30d);
                HPAssert.AreEqual(-expected, y_neg, expected * 1e-30d);
                HPAssert.AreEqual(expected, y_dec, expected * 1e-30d);
                HPAssert.AreEqual(expected, y_inc, expected * 1e-30d);
            }

            Assert.AreEqual(0, ddouble.FresnelS(0));

            Assert.IsTrue(ddouble.IsFinite(ddouble.FresnelS(ddouble.Epsilon)));

            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelS(ddouble.NaN)));
            Assert.AreEqual(0.5d, ddouble.FresnelS(ddouble.PositiveInfinity));
            Assert.AreEqual(-0.5d, ddouble.FresnelS(ddouble.NegativeInfinity));
        }

        [TestMethod]
        public void FresnelFTest() {
            ddouble[] expecteds = {
                "0.9205157542469284244453431407430670454544",
                "-0.9819219825417521609317474775522336823421",
                "0.4504305418308861493848840042975245656803",
                "0.04093468226128113691524786380670324655963",
                "-1.105720789297685629556161074287154697145",
                "1.292236872992998687159150936542130812091",
                "-0.6676030206410605803045595952607801600230",
                "-1.233171049688214146548960682023396152894",
                "0.8434156783636982421953008159580684568865",
                "0.9159340321371937737355341489090674486102",
                "-0.7446145313722109403030436116016289679292",
                "-1.644294463183471464633037461552485004225",
                "-1.279893400376822829474206413652690136631",
                "-0.4729011885747896956489231236502626429532",
                "0.1419910416204947444670407787593570829090",
                "0.4322393479682526573536893449841649600236",
                "0.5000000000000000000000000000000000000000",
                "0.4649282383743836268969520442366731156907",
                "0.3992050585257022399326824266070323371521",
                "0.3342840193756982330531881271172862126579",
                "0.2798934003768228294742064136526901366306",
                "0.2368907256570890056069592385685218325786",
                "0.2034184312260139559033204062352395478681",
                "0.1772678348645637145034983680890543188264",
                "0.1565843216363017578046991840419315431135",
                "0.1399691826864566583099281650252743854576",
                "0.1264069204948635959048363898943907399619",
                "0.1151668645333837718669272864418323595556",
                "0.1057207892976856295561610742871546971452",
                "0.09768248693781032568048713272627318373572",
                "0.09076555831531083501483920106886485438080",
                "0.08475439619911587668110608833139560662775",
                "0.07948424575307157555465685925693295454557",
                "0.07482740088801755034560906475864927565641",
                "0.07068353958849187260747280845518285900189",
                "0.06697286783675423228666007071957678441067",
                "0.06363118870401223110210740441301396412075",
                "0.06060630717065384264299650944216357657585",
                "0.05785537382555187490520576793907263602277",
                "0.05534289723894407814613888797292703743470",
                "0.05303923876306972237607971215922108089375",
                "0.05091945975957541524903078211435266884770",
                "0.04896242936970589297500745787958138741124",
                "0.04715012708760166888072728320689183839633",
                "0.04546709254696981032706902646163409255850",
                "0.04389998768174998541212608739145241953317",
                "0.04243724548213078862477592552675260245657",
                "0.04106878607767454757907792930760048290224",
                "0.03978578560698551613801136792894756608674",
                "0.03858048680127116292180094956873862686820",
                "0.03744604277750751891875225398309439748345",
                "0.03637638745648266622786174134656178867508",
                "0.03536612746811985255106330305762761709389",
                "0.03441045150644478854601970474326299377566",
                "0.03350505393918872665006758180525317404856",
                "0.03264607012731015637735664597975126319542",
                "0.03183002141511775959664888918955305394615",
                "0.03105376814710415232320688768257679135195",
                "0.03031446937895787659897652332083872071918",
                "0.02960954819687268572805569045879494419030",
                "0.02893666175579644963481599231985598465200",
                "0.02829367530470887831055156338445982861904",
                "0.02767863959382186711513211456590873576113",
                "0.02708977116123584138939192386763308218643",
                "0.02652543508006455206751868172834524606972",
                "0.02598412981524847234463212762030819047008",
                "0.02546447389525239608155430303015371138313",
                "0.02496519414997361092349507985016093435043",
                "0.02448511530435840639837918170252500205066",
                "0.02402315074893267120156240220536483338256",
                "0.02357829433488961185302095228134859974448",
                "0.02314961306349935806014564105763574201500",
                "0.02273624055817970496057619790220477092021",
                "0.02233737122321505516907994936424679045702",
                "0.02195225500633504782783335218387725417924",
                "0.02158019269357514696151934089049993979654",
                "0.02122053167437345793460004588139668472181",
                "0.02087266212298588247766629916816711897120",
                "0.02053601354925144296100535254182344800225",
                "0.02021005167769786701280062505366433980101",
                "0.01989427561909897513343301937391376491886",
                "0.01958821530300859061782656622882655420045",
                "0.01929142914360774646772200467509755251756",
                "0.01900350191450249157931304373821533816560",
                "0.01872404281097372375728899090762828248017",
                "0.01845268368067136833168076979152189402805",
                "0.01818907740591613529879008968889582876716",
                "0.01793289642266804267345614401102682106188",
                "0.01768383136288003840563895252643985289448",
                "0.01744158980840979585142247124115384922274",
                "0.01720589514594069483709202620153609495090",
                "0.01697648551348768536710480374816571414563",
                "0.01675311283005531214225106807007816516310",
                "0.01653554190089092802576659052428090737368",
                "0.01632354959155088261261997258411778812667",
                "0.01611692406468401297349381089793147411001",
                "0.01591546407404610728524575514416528322989",
                "0.01571897831080068295379025641881237583689",
                "0.01552728479764366682478945546699928097761",
                "0.01534021032671954172282029911751159498711",
                "0.01515758993768045004093161218239964732190",
                "0.01497926643258303630181813167455028960455",
                "0.01480508992462518925001408169439166120148",
                "0.01463491741800043606793688109724508583025",
                "0.01446861241639515724644909632257276308506",
                "0.01430604455787619499460196233654172876040",
                "0.01414708927411659878430786232367825243346",
                "0.01399162747208763100784477208451929319819",
                "0.01383954523650789421713170671091266324622",
                "0.01369073355148743521480072587301601036321",
                "0.01354508803993760478045466055988329826706",
                "0.01340250871943778564623431754086770860104",
                "0.01326289977335915650420184909911806435093",
                "0.01312616933614459873888544220870819064806",
                "0.01299222929173370721028504659852224010977",
                "0.01286099508420355412038676371157775291618",
                "0.01273238553977019225945272649192574444027",
            };

            for ((int i, ddouble x) = (0, -4); i < expecteds.Length; i++, x += 1d / 4) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.FresnelF(x);
                ddouble y_dec = ddouble.FresnelF(ddouble.BitDecrement(x));
                ddouble y_inc = ddouble.FresnelF(ddouble.BitIncrement(x));

                Console.WriteLine(x);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, ddouble.Abs(expected) * 1e-30d);
                HPAssert.AreEqual(expected, y_dec, ddouble.Abs(expected) * 1e-30d);
                HPAssert.AreEqual(expected, y_inc, ddouble.Abs(expected) * 1e-30d);
            }

            Assert.AreEqual(0.5d, ddouble.FresnelF(0));

            Assert.IsTrue(ddouble.IsFinite(ddouble.FresnelF(ddouble.Epsilon)));

            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelF(ddouble.NaN)));
            Assert.AreEqual(0d, ddouble.FresnelF(ddouble.PositiveInfinity));
            Assert.AreEqual(0d, ddouble.FresnelF(ddouble.MaxValue));
            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelF(ddouble.NegativeInfinity)));
        }

        [TestMethod]
        public void FresnelGTest() {
            ddouble[] expecteds = {
                "0.9984260330381776155307095868245097300350",
                "-1.095108896059736599620451593531326852125",
                "1.304222789244647607468167386686004051635",
                "-1.410317133928196191873323723815647963130",
                "0.9963129989673750360976122652991121038565",
                "0.1338628760557234762154272953821206582066",
                "-1.312826599525498665574297071534747220620",
                "0.8887097071450276355944530694263524186201",
                "0.9882534060753407545002235033572610376884",
                "-0.9140086414626797602491428268821845643778",
                "-1.331572761819174622079266782611552374144",
                "-0.1771792035264039233540709227320455099343",
                "0.9382591473903547660767566966251526374938",
                "1.305134290163105193613051188096189121239",
                "1.132920265263138779898736280528247940692",
                "0.7959587742379239146707286112210975569935",
                "0.5000000000000000000000000000000000000000",
                "0.2972430927638335735683039057770242104431",
                "0.1736426996132377479579068928989392128920",
                "0.1022694473632772654130270348877740504078",
                "0.06174085260964523392324330337484736250621",
                "0.03856203432731246075833592619906907963899",
                "0.02500979694279809422262360918436522056030",
                "0.01684105512004347599850143766134648866346",
                "0.01174659392465924549977649664273896231163",
                "0.008457879197608648656188319794485657094281",
                "0.006263634649122137717653898107560067036496",
                "0.004754293143367986380307701150855772088735",
                "0.003687001032624963902387734700887896143533",
                "0.002913396401813732847245500831684791483533",
                "0.002340175631728920388475786741183101949138",
                "0.001907029057979111381419076533205084688287",
                "0.001573966961822384469290413175490269964986",
                "0.001313843842220580028032267585011508911444",
                "0.001107833274666174762614696947060807219572",
                "0.0009426202479697537359112955835538895765077",
                "0.0008086180828831132480716195340083445915680",
                "0.0006988111348922443585605979293690257666852",
                "0.0006079883165234611347407755242834247134102",
                "0.0005322258567296337926436686024418433692462",
                "0.0004685321444988798117200967288647722372910",
                "0.0004145999182344311090886513622807696033876",
                "0.0003686307652802169054787964185791119706770",
                "0.0003292091063901333364930667596340390024644",
                "0.0002952105465532241317176136203710086263363",
                "0.0002657344218881983157893741019776091475378",
                "0.0002400536012336146884495764602543521835472",
                "0.0002175767401867370586027178561052036052323",
                "0.0001978196228028644430161397400150619628792",
                "0.0001803832051132459333553949678710001966235",
                "0.0001649366497371219536588011696098768972751",
                "0.0001512041119868081530462200461291109112583",
                "0.0001389543703150701382929044402899536264451",
                "0.0001279926310258821610759998549205336623583",
                "0.0001181540079112464210177631288439456970610",
                "0.0001092983016044944422724593805075055536371",
                "0.0001013057944842763858481522643788856076532",
                "0.00009407384430471552261831327763523620755268",
                "0.00008751410993536209032261136113038140891427",
                "0.00008155028031313403723585656657217164485077",
                "0.00007611620624893726046787892616181896237382",
                "0.00007115435647586143721552540527952337122065",
                "0.00006661453600063073020618185923793096336794",
                "0.00006245281768709148827370907436314653649346",
                "0.00005863064798861968999908308462837080175557",
                "0.00005511409554377384847824826196549124181673",
                "0.00005187321746994361610996432948873286788383",
                "0.00004888152301889220040459198759449950460905",
                "0.00004611551808743859273464431729360887488721",
                "0.00004355431712762203727902851155002792833385",
                "0.00004117931144288714604332515426872779853786",
                "0.00003897388482027916307658734243244474451227",
                "0.00003692316903389954804621962422375832488395",
                "0.00003501383304001807408400393860279826498828",
                "0.00003323390073018422177875781503524672540479",
                "0.00003157259296317539893492096685986914784856",
                "0.00003002019029725657588391174935903587344916",
                "0.00002856791342073306676002358288970393540717",
                "0.00002720781875476081813152025037859866985794",
                "0.00002593270709665607056716816425243752109116",
                "0.00002473604349958069449937014779233952962830",
                "0.00002361188685757105059821787116033049108539",
                "0.00002255482789318294340540839117254142881258",
                "0.00002155993443643682246587094051087297115507",
                "0.00002062270304467441513939088725604007938156",
                "0.00001973901614860046053979420610159201655098",
                "0.00001890510402444661080719103743397590946986",
                "0.00001811751098935511713357776435857736550203",
                "0.00001737306529961197199410347524605783858489",
                "0.00001666885230163269191849134190597091242615",
                "0.00001600219044557849657625817940240324267694",
                "0.00001537060982278101535103032310352714740115",
                "0.00001477183293213053638499494337514229067222",
                "0.00001420375741836200204780458918411117407609",
                "0.00001366444055769515350243995373875068763375",
                "0.00001315208529433840664871800215848227553614",
                "0.00001266502765561181299378630233978357479471",
                "0.00001220172539443962618773095804423443886737",
                "0.00001176074772617721839450501123991725703475",
                "0.00001134076604256739837375933067463885352462",
                "0.00001094054549940392404858729217620109536164",
                "0.00001055893738650071645897132177216635806018",
                "0.00001019487219906687043757621495093643463994",
                "9.847353338777060748015146370581879277558e-6",
                "9.515451380881178010683227065624346877477e-6",
                "9.198298850767288510743024547113865458037e-6",
                "8.895085459607987106391803120877405337998e-6",
                "8.605053754193278268587183776224341087307e-6",
                "8.327495140879091820208064911022113833619e-6",
                "8.061746247841988054779382131438734199678e-6",
                "7.807185593598808926794925592849964391536e-6",
                "7.563230533086617773399717496147541044395e-6",
                "7.329334455556613608370300263710665413888e-6",
                "7.104984211162104468894262587135406833303e-6",
                "6.889697745455297910461312512650515554573e-6",
                "6.683021923085609449603955193428319021168e-6",
                "6.484530523843893167995536916649510416727e-6",
            };

            for ((int i, ddouble x) = (0, -4); i < expecteds.Length; i++, x += 1d / 4) {
                ddouble expected = expecteds[i];

                ddouble y = ddouble.FresnelG(x);
                ddouble y_dec = ddouble.FresnelG(ddouble.BitDecrement(x));
                ddouble y_inc = ddouble.FresnelG(ddouble.BitIncrement(x));

                Console.WriteLine(x);
                Console.WriteLine(y);

                HPAssert.AreEqual(expected, y, ddouble.Abs(expected) * 1e-30d);
                HPAssert.AreEqual(expected, y_dec, ddouble.Abs(expected) * 1e-30d);
                HPAssert.AreEqual(expected, y_inc, ddouble.Abs(expected) * 1e-30d);
            }

            Assert.AreEqual(0.5d, ddouble.FresnelG(0));

            Assert.IsTrue(ddouble.IsFinite(ddouble.FresnelG(ddouble.Epsilon)));

            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelG(ddouble.NaN)));
            Assert.AreEqual(0d, ddouble.FresnelG(ddouble.PositiveInfinity));
            Assert.AreEqual(0d, ddouble.FresnelG(ddouble.MaxValue));
            Assert.IsTrue(ddouble.IsNaN(ddouble.FresnelG(ddouble.NegativeInfinity)));
        }
    }
}
