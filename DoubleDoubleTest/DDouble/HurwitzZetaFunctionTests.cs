using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class HurwitzZetaFunctionTests {
        [TestMethod]
        public void HurwitzZetaTest() {
            ddouble[] a0p015625_expecteds = {
                "514.5814413656319140757143084496442281402",
                "4097.608146981232547114047293193430923959",
                "32769.29857563331540311460366648878406324",
                "262145.1528040124599649853117981205245754",
                "2.097153070971254715628455394923804639657e6",
                "1.677721701992410938661370754199004618404e7",
                "1.342177289855803764541052029467291549000e8",
                "1.073741824961010521203257171041724056111e9",
                "8.589934592942459312262161685928141528180e9",
                "6.871947673692775141207753968314857271186e10",
                "5.497558138889155652129753236789190640833e11",
                "4.398046511104905069335881097648871593950e12",
                "3.518437208883289572706707719529444807023e13",
                "2.814749767106568871850819738575051297229e14",
                "2.251799813685248879207281093735155688856e15",
                "1.801439850948198487163405971617058447252e16",
                "1.441151880758558728643565361535906487193e17",
                "1.152921504606846976857299886217157528728e18",
                "9.223372036854775808850412378722889567776e18",
                "7.378697629483820646484365806233370531602e19",
                "5.902958103587056517128370118344352055901e20",
                "4.722366482869645213696830456087273127151e21",
                "3.777893186295716170956882397841107106485e22",
                "3.022314549036572936765448175700123396986e23",
                "2.417851639229258349412352811224619883654e24",
                "1.934281311383406679529881680493772545919e25",
                "1.547425049106725343623905287987060552213e26",
                "1.237940039285380274899124224792527200978e27",
                "9.903520314283042199192993792786399362462e27",
                "7.922816251426433759354395033678032116693e28",
                "6.338253001141147007483516026887742915427e29",
                "5.070602400912917605986812821504768309631e30",
                "4.056481920730334084789450257203276237472e31",
                "3.245185536584267267831560205762567564862e32",
                "2.596148429267413814265248164610048750644e33",
                "2.076918743413931051412198531688038474485e34",
                "1.661534994731144841129758825350430727391e35",
                "1.329227995784915872903807060280344576733e36",
                "1.063382396627932698323045648224275660873e37",
                "8.507059173023461586584365185794205286472e37",
                "6.805647338418769269267492148635364229127e38",
                "5.444517870735015415413993718908291383297e39",
                "4.355614296588012332331194975126633106637e40",
                "3.484491437270409865864955980101306485309e41",
                "2.787593149816327892691964784081045188248e42",
                "2.230074519853062314153571827264836150598e43",
                "1.784059615882449851322857461811868920478e44",
                "1.427247692705959881058285969449495136383e45",
                "1.141798154164767904846628775559596109106e46",
                "9.134385233318143238773030204476768872850e46",
                "7.307508186654514591018424163581415098280e47",
                "5.846006549323611672814739330865132078624e48",
                "4.676805239458889338251791464692105662899e49",
                "3.741444191567111470601433171753684530319e50",
                "2.993155353253689176481146537402947624255e51",
                "2.394524282602951341184917229922358099404e52",
                "1.915619426082361072947933783937886479523e53",
                "1.532495540865888858358347027150309183619e54",
                "1.225996432692711086686677621720247346895e55",
                "9.807971461541688693493420973761978775160e55",
                "7.846377169233350954794736779009583020128e56",
                "6.277101735386680763835789423207666416102e57"
            };
            ddouble[] a0p0625_expecteds = {
                "66.49433613862373864777001784741464213718",
                "257.5064200429154142639498415278601753058",
                "1025.181946224305252297278154004191120438",
                "4097.021152775181360120364229442772906072",
                "16384.92431571281567855155833828795927569",
                "65536.85839499994662377317737458151727673",
                "262144.8093998291248677948216047348748411",
                "1.048576770472628345742187208388754413142e6",
                "4.194304737913302539948861505534092089951e6",
                "1.677721670958741137274035827780276528732e7",
                "6.710886468420243134938920562570674127918e7",
                "2.684354566609464377244449573691779621938e8",
                "1.073741824639294445778363918391143055234e9",
                "4.294967296618898755622951224663099998998e9",
                "1.717986918459952414039311987110864332167e10",
                "6.871947673658100822487652805226424976486e10",
                "2.748779069445632366101140916504460163642e11",
                "1.099511627776546126923068735982412557709e12",
                "4.398046511104529618416278197244464348105e12",
                "1.759218604441651366509501553490084917879e13",
                "7.036874417766449823112643665188717096799e13",
                "2.814749767106564832877461542048599288614e14",
                "1.125899906842624468811158768850707347715e15",
                "4.503599627370496454781104312385576265738e15",
                "1.801439850948198444117987418197868869018e16",
                "7.205759403792793642799163233171867713215e16",
                "2.882303761517117444152019448008320105610e17",
                "1.152921504606846976402797452013028640846e18",
                "4.611686018427387904390765639250608248697e18",
                "1.844674407370955161637909467483519850052e19",
                "7.378697629483820646436777329512417273436e19",
                "2.951479051793528258563567907219562455566e20",
                "1.180591620717411303424346136602642566339e21",
                "4.722366482869645213696335800965662363758e21",
                "1.888946593147858085478432577418732974716e22",
                "7.555786372591432341913631604696615172918e22",
                "3.022314549036572936765443066103026017065e23",
                "1.208925819614629174706176297455482727429e24",
                "4.835703278458516698824704288574064493803e24",
                "1.934281311383406679529881627995786609466e25",
                "7.737125245533626718119526427159895569924e25",
                "3.094850098213450687247810562634896422601e26",
                "1.237940039285380274899124224255622467121e27",
                "4.951760157141521099596496896247990196241e27",
                "1.980704062856608439838598758424058581291e28",
                "7.922816251426433759354395033623340251083e28",
                "3.169126500570573503741758013442264336876e29",
                "1.267650600228229401496703205376219672938e30",
                "5.070602400912917605986812821504213114050e30",
                "2.028240960365167042394725128601620675099e31",
                "8.112963841460668169578900514406420057792e31",
                "3.245185536584267267831560205762561945892e32",
                "1.298074214633706907132624082305024188779e33",
                "5.192296858534827628530496329220096183143e33",
                "2.076918743413931051412198531688038417767e34",
                "8.307674973655724205648794126752153617237e34",
                "3.323069989462289682259517650700861441672e35",
                "1.329227995784915872903807060280344576162e36",
                "5.316911983139663491615228241121378304157e36",
                "2.126764793255865396646091296448551321615e37",
                "8.507059173023461586584365185794205286415e37",
                "3.402823669209384634633746074317682114561e38"
            };
            ddouble[] a0p25_expecteds = {
                "10.21305536046660073888285571024857141653",
                "17.19732915450711073927131911933522402151",
                "32.84745195469768586271574725680697415182",
                "64.66386996876846016666898358942199494364",
                "128.5469589642843457809379278770936585661",
                "256.4636906681980660037985406381725094614",
                "512.4000175661098435540246526002369306291",
                "1024.348974526580572231592798021748291490",
                "2048.306718246487314102538188884284383806",
                "4096.270948064010767048866559996198797991",
                "8192.240192372767207576445991097013122584",
                "16384.21345519957167514794542195223925078",
                "32768.19002848222237145296371877640609855",
                "65536.16938670901741620606758211393365746",
                "131072.1511250669150160586084363947578269",
                "262144.1349217240825743509781002783992123",
                "524288.1205140442443452676838853951477289",
                "1.048576107683114753926745099997368583807e6",
                "2.097152096243378680821994210077589047761e6",
                "4.194304086035480043366552814447887981748e6",
                "8.388608076921179129574726097677095843962e6",
                "1.677721606877963145892028947484276331238e7",
                "3.355443206150458521637074443186673117651e7",
                "6.710886405500221164338025060395409199676e7",
                "1.342177280491893821846199662471650458273e8",
                "2.684354560439922689364191826229703499301e8",
                "5.368709120393451851407977290910661891432e8",
                "1.073741824035189608553360445054206738738e9",
                "2.147483648031473347650008299322550149738e9",
                "4.294967296028149822037111186852100071986e9",
                "8.589934592025177436113503581388724831789e9",
                "1.717986918402251903028647304034138388804e10",
                "3.435973836802014139769395443293207426113e10",
                "6.871947673601801485696655664489588158979e10",
                "1.374389534720161128734251043054265599072e11",
                "2.748779069440144117224816675297694725287e11",
                "5.497558138880128901900465662213585477573e11",
                "1.099511627776011529305541923839872691291e12",
                "2.199023255552010312103752131463029276219e12",
                "4.398046511104009223412249265670958349336e12",
                "8.796093022208008249661548740243448574012e12",
                "1.759218604441600737871549921857736897136e13",
                "3.518437208883200659971970651742922570245e13",
                "7.036874417766400590296604493919125748365e13",
                "1.407374883553280052797715292269720458207e14",
                "2.814749767106560047223700121282674339109e14",
                "5.629499534213120042238153409261174388363e14",
                "1.125899906842624003777894754784014809216e15",
                "2.251799813685248003379051436157164365910e15",
                "4.503599627370496003022315246120622613861e15",
                "9.007199254740992002703240777130153915696e15",
                "1.801439850948198400241785194903766811478e16",
                "3.602879701896396800216259245646761406635e16",
                "7.205759403792793600193428144907396519678e16",
                "1.441151880758558720017300738917374788410e17",
                "2.882303761517117440015474251103018929721e17",
                "5.764607523034234880013840590807520534176e17",
                "1.152921504606846976001237940066483036852e18",
                "2.305843009213693952001107247250096069945e18",
                "4.611686018427387904000990352043516091381e18",
                "9.223372036854775808000885797793629988159e18",
                "1.844674407370955161600079228163051497470e19"
            };
            ddouble[] a0p5_expecteds = {
                "4.776537947554833248576627669358302173663",
                "4.934802200544679309417245499938075567657",
                "6.247110634568811485289990557365867609357",
                "8.414398322117159997798167130580149935355",
                "11.62080466344189447768117948658747491660",
                "16.23484850566707287274005544811751854162",
                "22.81059914612839721154601564595478149411",
                "32.14476040944446771627233008016805920977",
                "45.37025849777102974636371043575539558183",
                "64.09261290502029580201462957682799325781",
                "90.58431210484366371113254758976148932974",
                "128.0603582275041990086542888309241884692",
                "181.0682596058392694445998429617639236129",
                "256.0397258304758065415647358197063786410",
                "362.0709721089216084829180704960430469244",
                "512.0262887341280115675227650777625629081",
                "724.0987562029427472200211052142226884150",
                "1024.017450355757901299900315955026354397",
                "1448.168915584497036487052605162679117054",
                "2048.011604072632543951663572331683959951",
                "2896.318842388479299875117163065416402583",
                "4096.007724435796457782922602005493952583",
                "5792.625055278867343376605332050168477152",
                "8192.005145030015404601044292987393428296",
                "11585.24170259967276420176309701477721910",
                "16384.00342819666676121774274445743217278",
                "23170.47780453053723371040337204660382279",
                "32768.00228473907214051220948810830676581",
                "46340.95187712360220309572377787479450193",
                "65536.00152287034600041399407244227257779",
                "92681.90126702197392833068413326928998410",
                "131072.0010151315971597409630640775998020",
                "185363.8008761860128033744601162004294144",
                "262144.0006767083668530194924249061291468",
                "370727.6006472500030744510752097796329725",
                "524288.0004511205239149775159094315203032",
                "741455.2005577985503204730247110503615509",
                "1.048576000300739668167184348398962497898e6",
                "1.482910400624481397411482572598593409222e6",
                "2.097152000200490175035111931691635030538e6",
                "2.965820800921559759723789905279474434781e6",
                "4.194304000133658942438663171271600642647e6",
                "5.931641601624853801008283913362221602945e6",
                "8.388608000089105492090224713963921737315e6",
                "1.186328320310419831117765625921315202787e7",
                "1.677721600005940347362631024602604318364e7",
                "2.372656640611139090355986921096723727837e7",
                "3.355443200003960224065742449594175335439e7",
                "4.745313281215811151791855845075796172270e7",
                "6.710886400002640146373806620604857326415e7",
                "9.490626562427310958568901859700864602349e7",
                "1.342177280000176009638130504824551069560e8",
                "1.898125312485174769016702059467518130512e8",
                "2.684354560000117339710707482583529734177e8",
                "3.796250624970157923023572168059078970494e8",
                "5.368709120000078226454587404557119663580e8",
                "7.592501249940188102755874946296974670760e8",
                "1.073741824000005215096203815731826041809e9",
                "1.518500249988029104333701691397045008259e9",
                "2.147483648000003476730495079927343281406e9",
                "3.037000499976052531189865692154098235812e9",
                "4.294967296000002317820207069803413750905e9"

            };
            ddouble[] a1_expecteds = {
                "2.612375348685488343348567567924071630571",
                "1.644934066848226436472415166646025189219",
                "1.341487257250917179756769693348612136623",
                "1.202056903159594285399738161511449990765",
                "1.126733867317056646427812491854984272222",
                "1.082323233711138191516003696541167902775",
                "1.054707510761454264022967288960280117272",
                "1.036927755143369926331365486457034168057",
                "1.025204579954685694592405828195405293079",
                "1.017343061984449139714517929790920527902",
                "1.012005899888524796100784916804783529088",
                "1.008349277381922826839797549849796759600",
                "1.005826727536522807702241644404594080118",
                "1.004077356197944339378685238508652465259",
                "1.002859250882415627713343982503361389401",
                "1.002008392826082214417852769232412060486",
                "1.001412590612173662271209865405805229875",
                "1.000994575127818085337145958900319017006",
                "1.000700842641736155219503740597614699845",
                "1.000494188604119464558702282526469936469",
                "1.000348655883491759901169167806141585268",
                "1.000246086553308048298637998047739670960",
                "1.000173751733643178193389049623749273171",
                "1.000122713347578489146751836526357395714",
                "1.000086686727462338155187960796537026387",
                "1.000061248135058704829258545105135333747",
                "1.000043281024256773030856639576880063927",
                "1.000030588236307020493551728510645062588",
                "1.000021619904246069108132764204504152847",
                "1.000015282259408651871732571487636722023",
                "1.000010803124900178547670908540118488224",
                "1.000007637197637899762273600293563029213",
                "1.000005399297051203488719052342941482308",
                "1.000003817293264999839856461644621939730",
                "1.000002698895944124127792351841934382863",
                "1.000001908212716553938925656957795101353",
                "1.000001349197742811016831834024920039878",
                "1.000000953962033872796113152038683449346",
                "1.000000674515618167856143602709201489492",
                "1.000000476932986787806463116719604373046",
                "1.000000337230096877890451393628554733826",
                "1.000000238450502727732990003648186752995",
                "1.000000168605820704963076244169237170489",
                "1.000000119219925965311073067788718882326",
                "1.000000084299836848228155259623052143802",
                "1.000000059608189051259479612440207935801",
                "1.000000042148894522497527608345416165659",
                "1.000000029803503514652280186063705069366",
                "1.000000021074106110269959320307202917255",
                "1.000000014901554828365041234658506630699",
                "1.000000010536939375454525943702020623689",
                "1.000000007450711789835429491981004170604",
                "1.000000005268431803813145301797696841932",
                "1.000000003725334024788457054819204018402",
                "1.000000002634203276260305322016045654834",
                "1.000000001862659723513049006403909945417",
                "1.000000001317097430162061566227794489330",
                "1.000000000931327432419668182871764735021",
                "1.000000000658547312570044650496183687933",
                "1.000000000465662906503378407298923325122",
                "1.000000000329273188817597015570158901292",
                "1.000000000232831183367650549200145597594"
            };
            ddouble[] a2_expecteds = {
                "1.612375348685488343348567567924071630571",
                "0.6449340668482264364724151666460251892189",
                "0.3414872572509171797567696933486121366230",
                "0.2020569031595942853997381615114499907650",
                "0.1267338673170566464278124918549842722220",
                "0.08232323371113819151600369654116790277475",
                "0.05470751076145426402296728896028011727249",
                "0.03692775514336992633136548645703416805708",
                "0.02520457995468569459240582819540529307885",
                "0.01734306198444913971451792979092052790182",
                "0.01200589988852479610078491680478352908773",
                "0.008349277381922826839797549849796759599864",
                "0.005826727536522807702241644404594080117825",
                "0.004077356197944339378685238508652465258961",
                "0.002859250882415627713343982503361389401039",
                "0.002008392826082214417852769232412060485606",
                "0.001412590612173662271209865405805229874545",
                "0.0009945751278180853371459589003190170060195",
                "0.0007008426417361552195037405976146998450324",
                "0.0004941886041194645587022825264699364686064",
                "0.0003486558834917599011691678061415852678244",
                "0.0002460865533080482986379980477396709604161",
                "0.0001737517336431781933890496237492731709973",
                "0.0001227133475784891467518365263573957142751",
                "0.00008668672746233815518796079653702638707890",
                "0.00006124813505870482925854510513533374748170",
                "0.00004328102425677303085663957688006392749758",
                "0.00003058823630702049355172851064506258762795",
                "0.00002161990424606910813276420450415284688135",
                "0.00001528225940865187173257148763672202323739",
                "0.00001080312490017854767090854011848822370065",
                "7.637197637899762273600293563029213088249e-6",
                "5.399297051203488719052342941482307666363e-6",
                "3.817293264999839856461644621939730454697e-6",
                "2.698895944124127792351841934382863121725e-6",
                "1.908212716553938925656957795101353258571e-6",
                "1.349197742811016831834024920039878283376e-6",
                "9.539620338727961131520386834493459437942e-7",
                "6.745156181678561436027092014894922420187e-7",
                "4.769329867878064631167196043730459664467e-7",
                "3.372300968778904513936285547338256676536e-7",
                "2.384505027277329900036481867529949350418e-7",
                "1.686058207049630762441692371704893863773e-7",
                "1.192199259653110730677887188823263872550e-7",
                "8.429983684822815525962305214380166833480e-8",
                "5.960818905125947961244020793580122750392e-8",
                "4.214889452249752760834541616565880800359e-8",
                "2.980350351465228018606370506936601184473e-8",
                "2.107410611026995932030720291725465702387e-8",
                "1.490155482836504123465850663069862886479e-8",
                "1.053693937545452594370202062368903075878e-8",
                "7.450711789835429491981004170604119454719e-9",
                "5.268431803813145301797696841932056301044e-9",
                "3.725334024788457054819204018402423232893e-9",
                "2.634203276260305322016045654833614287479e-9",
                "1.862659723513049006403909945416948061665e-9",
                "1.317097430162061566227794489330379726920e-9",
                "9.313274324196681828717647350212198135680e-10",
                "6.585473125700446504961836879333040936250e-10",
                "4.656629065033784072989233251220071062692e-10",
                "3.292731888175970155701589012917047553815e-10",
                "2.328311833676505492001455975940495024830e-10"
            };
            ddouble[] a4_expecteds = {
                "1.066371868362339326311762460037661292379",
                "0.2838229557371153253613040555349140781078",
                "0.1005605320443218803777642938777379372854",
                "0.04001986612255724836270112447441295372795",
                "0.01696217636541873311810884361032416247259",
                "0.007477554698792512503658017528822223762405",
                "0.003385555836188552828048482001542392370925",
                "0.001562528805921366660583593452918941719632",
                "0.0007315660089039208149240971039005406191089",
                "0.0003463198719662864909239654562154524560013",
                "0.0001653807545842698187032753883191895215436",
                "0.00007953001109520909859956173822840111792483",
                "0.00003846391586933143008723173945792255595800",
                "0.00001869040766846679828590913812967909831455",
                "9.117720861151866895578851825314693847581e-6",
                "4.462562656923557719659442237798432057104e-6",
                "2.190247653845111195264473714527212196856e-6",
                "1.077540009655050434922303594262988169949e-6",
                "5.311982287202272329737627951267442741171e-7",
                "2.623248499877964652703275616851293232416e-7",
                "1.297413222002676126289324737247942505692e-7",
                "6.425188488937789232731477025384732169040e-8",
                "3.185575311766413706170149598495981208545e-8",
                "1.580960410283983661294870092334324363988e-8",
                "7.852915547653070727340270596290020236919e-9",
                "3.903650576060286803912583176290471207496e-9",
                "1.941782791033967609683700253548479558113e-9",
                "9.664626442372278147797943434352911191490e-10",
                "4.812755491944114448695653825472094357542e-10",
                "2.397730264529579335773531489724584458045e-10",
                "1.195037422857179807431994813704770618530e-10",
                "5.958227462268205432346850486282860136162e-11",
                "2.971592658937849906799877164659202458979e-11",
                "1.482458312665927965459043161370148130940e-11",
                "7.397466088667378745635291787763707552503e-12",
                "3.692144201193262961117931981007499174989e-12",
                "1.843142134117781990494582425664085203243e-12",
                "9.202674668690207064577262218601035307941e-13",
                "4.595534604027215298967901276189454920887e-13",
                "2.295183217150729421957986712718831425794e-13",
                "1.146440411196679848717272639183078215386e-13",
                "5.727071724065572238389487003685397104449e-14",
                "2.861248792328632938544824869910135546176e-14",
                "1.429604540661848011792961808785904753946e-14",
                "7.143473749749030456209694720495797437530e-15",
                "3.569707382462670674284898461038602088950e-15",
                "1.783948048509158228174276466017088845111e-15",
                "8.915698103028071938523984230229586700925e-16",
                "4.456044609894166455801205300082803652511e-16",
                "2.227216658569063362250427659241974180690e-16",
                "1.113248571844910875079743152435446104358e-16",
                "5.564636165773028070205216514118878194359e-17",
                "2.781600439093701213502548120760898024777e-17",
                "1.390479642256896286221843846171630931615e-17",
                "6.950966022833963918363920962156497065075e-18",
                "3.474843118570496226688953137939747142648e-18",
                "1.737135635386173826756731138057385693681e-18",
                "8.684400483856268287785548389927606946319e-19",
                "4.341629246585134252002124904596992587426e-19",
                "2.170559431993773563744521147441205228859e-19",
                "1.085165658457037927764031842208500936528e-19",
                "5.425318486488027467819783864129401317650e-20"
            };
            ddouble[] a16_expecteds = {
                "0.5079345009330627712725611581905666129520",
                "0.06449378340323936178171077231192722541736",
                "0.01091765057878800958168144477148554488371",
                "0.002079005061979481077093264892113263122016",
                "0.0004222534134301109795141867972529161272072",
                "0.00008932687662736980498313642841649779654702",
                "0.00001943516480097153514464845541631156775621",
                "4.316302233482826144961640614192039114296e-6",
                "9.737279765186645920257118420546643265330e-7",
                "2.223930960479266325355272710501987395406e-7",
                "5.130180497956650954419638317447474761207e-8",
                "1.193194025705379025820282376264995722313e-8",
                "2.794338271717925206057637147443443091357e-9",
                "6.582447693149605839728525702317240556979e-10",
                "1.558405601968307109972671358020401279762e-10",
                "3.705709357600710272128523952099960958251e-11",
                "8.845560334135387561591073121390011428529e-12",
                "2.118595988552476085076020879757809996181e-12",
                "5.089521695057778352285520501978592148837e-13",
                "1.225953878192932032192070172547808579800e-13",
                "2.960207300188660474004045869974782018756e-14",
                "7.163411015457561471906258107157353981454e-15",
                "1.736919899251205953821849421455300668677e-15",
                "4.219155321887574017011224672628109192167e-16",
                "1.026573477643675308961319485529852105724e-16",
                "2.501579288438679705773634906221185576023e-17",
                "6.104439934560331538982450036200067478327e-18",
                "1.491550775908562176592945511314497845494e-18",
                "3.648792777670566878054795093285718600628e-19",
                "8.935972652764649706305933757025947709044e-20",
                "2.190696288913322226202709859280689654896e-20",
                "5.375757773917302018147119966913649482813e-21",
                "1.320342763620035132594160859008313804441e-21",
                "3.245622184691153494605645815575952531418e-22",
                "7.984551306217632506251884986888948937123e-23",
                "1.965727478625620610427775660149380829084e-23",
                "4.842805713413223676632797619171291078439e-24",
                "1.193861618950235617776225067145768834989e-24",
                "2.944949145984934208880434640838897363190e-25",
                "7.268643797305518820765058331157347507130e-26",
                "1.795009679145611229897556036038132593035e-26",
                "4.435117086533730425728366497588420111206e-27",
                "1.096367776639317037922602339838773531992e-27",
                "2.711497111822245318374425152002616213332e-28",
                "6.708931191616688097439682819359245111168e-29",
                "1.660653912125386513072442664835651760594e-29",
                "4.112230651244752685298790243970286765510e-30",
                "1.018684867677989255218994313826266718052e-30",
                "2.524401065135578694625362662285208988528e-31",
                "6.257855250880545854485316824439249853762e-32",
                "1.551794944297639686472920734209446397816e-32",
                "3.849268744713794288048622026503104453307e-33",
                "9.551047903100652547396999333418357817893e-34",
                "2.370537709640389610246004012590528381911e-34",
                "5.885186989057583343892804066390049659107e-35",
                "1.461456935198511762937041532029930938212e-35",
                "3.630105351951382343258077530480782593887e-36",
                "9.018934738540683321144641565967884238476e-37",
                "2.241246757366198352130920116554227569878e-37",
                "5.570810127846341443674641625948737887548e-38",
                "1.384960365054386020135299192251683433274e-38",
                "3.443839439515085221531677670898598331585e-39"
            };
            ddouble[] a64_expecteds = {
                "0.2509803770614672836493342545797354877997",
                "0.01574770606433893015574400307135046450730",
                "0.001317441457105318573267539089585276277482",
                "0.0001239925610816426747494660117083779056301",
                "0.00001244762269632382182410599113844882840391",
                "1.301678480570950272096022224223255775429e-6",
                "1.400081277540588961036556224451430626816e-7",
                "1.537288474339244869367672346318600424575e-8",
                "1.714725776184874291734422234462933552506e-9",
                "1.936541334833384577431234877560883382946e-10",
                "2.209130795356837128719801036463624931047e-11",
                "2.541077851996695963434018589807129293231e-12",
                "2.943328429605296404757336439456321472452e-13",
                "3.429530436616201094706315726945376985804e-14",
                "4.016518918886760549361939561061513153234e-15",
                "4.724950158653024559679117805706412259135e-16",
                "5.580102688695338663122076211931362922626e-17",
                "6.612874274403169385194983046336761227486e-18",
                "7.861014348570541319129840039225822749907e-19",
                "9.370642602866875754172164861569474372904e-20",
                "1.119811740009190133420126924835816042372e-20",
                "1.341233317240856606873151788560084220304e-21",
                "1.609754481745582621328708038966584321076e-22",
                "1.935684019816078006952573443581049867128e-23",
                "2.331641025893187998752014873157643453131e-24",
                "2.813080128206955223639833739509985378839e-25",
                "3.398937700612948778362284334230607195157e-26",
                "4.112427166192652447163262050065653592052e-27",
                "4.982018085908976153598877173719848905433e-28",
                "6.042641865301545425821297501436784971351e-29",
                "7.337176972152181798484074276475494572868e-30",
                "8.918278994119072181858930182876027984962e-31",
                "1.085063624197872596025908303560533361523e-31",
                "1.321375062036977752959863140846684276314e-32",
                "1.610536700968337211948736402971874095697e-33",
                "1.964570350270230075645740996586625690185e-34",
                "2.398267084689657973635387377218818109954e-35",
                "2.929831400503845787087037828893390257076e-36",
                "3.581676390440497578641532939730624399144e-37",
                "4.381405572871084724456723832856139530931e-38",
                "5.363025465404155262612684733424112060239e-39",
                "6.568443462986313091645782785384392089139e-40",
                "8.049318548160966959000423821677824886863e-41",
                "9.869348424360523876563490604707764766307e-42",
                "1.210709656386835693633089259856623025624e-42",
                "1.485948732060867903189108633116070202833e-43",
                "1.824612781582160712497896989990826602969e-44",
                "2.241465317838044805628852193093199836513e-45",
                "2.754733866857736565317007714787472338256e-46",
                "3.386928041574953336412469044310312185068e-47",
                "4.165851866312856285669900723404073416322e-48",
                "5.125856689777109911145039096455457152631e-49",
                "6.309392122031767335384746333524550938178e-50",
                "7.768926195675644319585504227566093486215e-51",
                "9.569323026145743570270675031760299446477e-52",
                "1.179078742905749073256102839825926783572e-52",
                "1.453251223510466730749030205404494786400e-53",
                "1.791719665648075446977037551867803778451e-54",
                "2.209664453224296411701084708605759467355e-55",
                "2.725870151300627391393413293435592197278e-56",
                "3.363585259746815769689865541284802145749e-57",
                "4.151587883603828801575906623813963650687e-58"
            };
            ddouble[] a256_expecteds = {
                "0.1251221895215242838784333192184832424329",
                "0.003913889328608396405461529929293372114800",
                "0.0001632380299239067204707345662983175554763",
                "7.659255061002553824058831674861751621653e-6",
                "3.833366159936249622990538208024388645968e-7",
                "1.998493340954481654500047415938873934538e-8",
                "1.071665930405863596826122109108391416335e-9",
                "5.866388854590917011177935777062494209110e-11",
                "3.262282418249717011708687882587017850214e-12",
                "1.836822359890725257746381972790727683961e-13",
                "1.044665918138870450151530249519264872683e-14",
                "5.990894623550182535720817540113769436222e-16",
                "3.459650685788284137394069044867223851358e-17",
                "2.009787338641059254608124021683826890939e-18",
                "1.173516721021018260388839237574091076040e-19",
                "6.882763064546648631973299161400889472934e-21",
                "4.052621117354336426386262104622876062933e-22",
                "2.394497584040145288609905694500207118981e-23",
                "1.419172387351772835407887415683015930590e-24",
                "8.434521789016035406149892684459820074647e-26",
                "5.025424277467581495989539773189445556059e-27",
                "3.001033040197228454215130287140026842305e-28",
                "1.795836989229649620394732525074825736503e-29",
                "1.076675074851875075078826874162682116929e-30",
                "6.466315729419234957951656083988286085353e-32",
                "3.889774651973473394967370604232259937883e-33",
                "2.343337067208449149236028382553504482846e-34",
                "1.413647381794772480856038331525735283868e-35",
                "8.538893287040768845977684564216836665075e-37",
                "5.163909829869917327670560635455020571389e-38",
                "3.126355737638777365264944482405320913548e-39",
                "1.894742308319432968231109432551256564414e-40",
                "1.149439444435923734867733470865217886430e-41",
                "6.979444946659542577444730481761284858340e-43",
                "4.241616372328798139413369449028488524551e-44",
                "2.579861668866112443023346262145614833942e-45",
                "1.570350320939379971351999031066741605308e-46",
                "9.565636811705311909431406285877483001251e-48",
                "5.830851098720056214419358241001566772510e-49",
                "3.556603914611082269015968541240077576804e-50",
                "2.170753118603018769350597642111767280525e-51",
                "1.325695121988103996349718857119645553130e-52",
                "8.100708654438884452533699601675703572395e-54",
                "4.952644701717090296729935551148287188440e-55",
                "3.029532240402633334585366598083991664429e-56",
                "1.854079554887503170370031338025582636435e-57",
                "1.135236390948791886184867361197790556321e-58",
                "6.954097125890304365882991734534146055944e-60",
                "4.261707099689216086146012005902476984667e-61",
                "2.612806355874678027425513639632661372236e-62",
                "1.602523709614376470566324392727633388361e-63",
                "9.832604466432896072660863990852299641736e-65",
                "6.035221000161841239408972902515384561905e-66",
                "3.705717289526585199616707696411462724392e-67",
                "2.276146502630064212687631685913543936976e-68",
                "1.398529376507415441255635652204947161892e-69",
                "8.595701890720435427022321644375531272676e-71",
                "5.284752458421101613019232314101894198110e-72",
                "3.250101581536374715130695428662094540480e-73",
                "1.999373176914823224036925324367267475956e-74",
                "1.230300791699639120492254305707761408271e-75",
                "7.572605580938781943220029297865178915358e-77"
            };
            ddouble[] a1024_expecteds = {
                "0.06251526251435228035812707133081246449181",
                "0.0009770394923786026216525966908576305552979",
                "0.00002035995930782367492729559230873180797024",
                "4.773030468640359024139712111814284485473e-7",
                "1.193548915996848131307170061770763809048e-8",
                "3.108959016153780307240018788020448250890e-10",
                "8.329601393545487421250396861861283703041e-12",
                "2.278181260535650233121753392173625510377e-13",
                "6.329825639926749649658699657338666757830e-15",
                "1.780697883251159058306815213098057038618e-16",
                "5.060035158689536449853006993094631501816e-18",
                "1.449842886598328627155917432082901548280e-19",
                "4.183259401364930172575101398630308535500e-21",
                "1.214188355851651091986875458262734508705e-22",
                "3.542246524782894449916991523737021981940e-24",
                "1.038020649972461017976042903012780047214e-25",
                "3.053746483745843388079952048005359658564e-27",
                "9.014991319972461868631117834563546572413e-29",
                "2.669562697199176145752788072991222488435e-30",
                "7.927196613262116046804996297070702279372e-32",
                "2.359859905558153527105163131230344777666e-33",
                "7.041070903364295404528131205436774682202e-35",
                "2.105180972391991478004109058298091531128e-36",
                "6.306115127944116318096234714222592327079e-38",
                "1.892295621617661771386419528141202842164e-39",
                "5.687370130969388439294734573194425549781e-41",
                "1.711894180673091577015520257524440356548e-42",
                "5.159866659239838568959408239354811628190e-44",
                "1.557235637121836965419333094624045749390e-45",
                "4.705295361095589486237766965095140199551e-47",
                "1.423319028424237255221562258809330829567e-48",
                "4.309925536334458433714989636145291684266e-50",
                "1.306356144738659662303187630614488516662e-51",
                "3.963258445648212057393110882232927121250e-53",
                "1.203425019536048044093164872785832895557e-54",
                "3.657129517528192695031047139506506210689e-56",
                "1.112235801823756906520955799995775718538e-57",
                "3.385094069348764645332754463474239152666e-59",
                "1.030968667858447415417281289775777708183e-60",
                "3.141997312653940772092197898249559332928e-62",
                "9.581591734943395383078089355116039257075e-64",
                "2.923667214567921563964470873874458648034e-65",
                "8.926156013750412124581989202896951264925e-67",
                "2.726691124733901609914197190604664917956e-68",
                "8.333583490143296840233048416554413623843e-70",
                "2.548250673914654634958645014148719260941e-71",
                "7.795747923916302378077164697463871203688e-73",
                "2.385997948344125665244981274948590897791e-74",
                "7.305852034836802806173400562650285555327e-76",
                "2.237961382610913174112988289238797554883e-77",
                "6.858166873158164360149410411376982245444e-79",
                "2.102473369922139594269731422826497766054e-80",
                "6.447830201666650435029255425697244616574e-82",
                "1.978113959307947966236320593300470095938e-83",
                "6.070688868120638834264509362610727107588e-85",
                "1.863666618024110163722000227205104699776e-86",
                "5.723174363401794176716295878849375954276e-88",
                "1.758083146856606014921841613306305214777e-89",
                "5.402203690781147831125426716289746021214e-91",
                "1.660455612644490740441436840241444336306e-92",
                "5.105099737171589051223919481052616198626e-94",
                "1.569993713481689816595202501350446964113e-95"
            };

            foreach ((ddouble a, ddouble[] expecteds) in new (ddouble, ddouble[])[] {
                (0.015625, a0p015625_expecteds), (0.0625, a0p0625_expecteds), (0.25, a0p25_expecteds),
                (0.5, a0p5_expecteds), (1, a1_expecteds), (2, a2_expecteds),
                (4, a4_expecteds), (16, a16_expecteds), (64, a64_expecteds),
                (256, a256_expecteds), (1024, a1024_expecteds)}) {

                for ((int i, ddouble x) = (0, 1.5); i < expecteds.Length; i++, x += 0.5) {
                    ddouble expected = expecteds[i];

                    ddouble actual = ddouble.HurwitzZeta(x, a);
                    HPAssert.AreEqual(expected, actual, ddouble.Abs(expected) * 1e-30d, $"x = {x},a = {a}");

                    ddouble actual_dec = ddouble.HurwitzZeta(ddouble.BitDecrement(x), a);
                    HPAssert.AreEqual(expected, actual_dec, ddouble.Abs(expected) * 1e-30d, $"{x}-eps,{a}");

                    ddouble actual_inc = ddouble.HurwitzZeta(ddouble.BitIncrement(x), a);
                    HPAssert.AreEqual(expected, actual_inc, ddouble.Abs(expected) * 1e-30d, $"{x}+eps,{a}");
                }
            }
        }

        [TestMethod]
        public void HurwitzZetaLimitTest() {
            for (ddouble a = 1d / 32; a <= 8; a += 1d / 32) {
                for (ddouble x = 0.5; x >= Math.ScaleB(1, 102); x /= 2) {
                    ddouble yn = ddouble.HurwitzZeta(1 + x - x / 2, a);
                    ddouble yz = ddouble.HurwitzZeta(1 + x, a);
                    ddouble yp = ddouble.HurwitzZeta(1 + x + x / 2, a);

                    Console.WriteLine($"x={x} a={a}\n{yz}");

                    Assert.IsTrue(yn >= yz && yz >= yp && yp >= 1, $"nearzero\n{yn},\n{yz},\n{yp}");
                }

                for (ddouble x = 8; x < ddouble.PositiveInfinity; x *= 2) {
                    ddouble yn = ddouble.HurwitzZeta(x * 0.875, a);
                    ddouble yz = ddouble.HurwitzZeta(x, a);
                    ddouble yp = ddouble.HurwitzZeta(x * 1.125, a);

                    Console.WriteLine($"x={x} a={a}\n{yz}");

                    if (a >= 1) {
                        Assert.IsTrue(yn >= yz && yz >= yp && yp >= 0, $"limit\n{yn},\n{yz},\n{yp}");
                    }
                    else {
                        Assert.IsTrue(yn <= yz && yz <= yp, $"limit\n{yn},\n{yz},\n{yp}");
                    }
                }
            }
        }

        [TestMethod]
        public void HurwitzZetaAbnormalTest() {
            for (ddouble a = 1d / 32; a <= 8; a += 1d / 4) {
                Console.WriteLine(a);

                ddouble hz_pone = ddouble.HurwitzZeta(1d, a);
                ddouble hz_xnan = ddouble.HurwitzZeta(double.NaN, a);
                ddouble hz_pinf = ddouble.HurwitzZeta(double.PositiveInfinity, a);

                Assert.IsTrue(ddouble.IsPositiveInfinity(hz_pone), nameof(hz_pone));
                Assert.IsTrue(ddouble.IsNaN(hz_xnan), nameof(hz_xnan));

                if (a < 1) {
                    Assert.IsTrue(ddouble.IsPositiveInfinity(hz_pinf), nameof(hz_pinf));
                }
                else if (a == 1) {
                    Assert.AreEqual(1d, hz_pinf, nameof(hz_pinf));
                }
                else {
                    Assert.IsTrue(ddouble.IsZero(hz_pinf), nameof(hz_pinf));
                }
            }
        }
    }
}
