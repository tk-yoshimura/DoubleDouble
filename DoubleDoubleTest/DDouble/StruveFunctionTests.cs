using DoubleDouble;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace DoubleDoubleTest.DDouble {
    [TestClass]
    public class StruveFunctionTests {
        [TestMethod]
        public void StruveHTest() {
            ddouble[] n0_expecteds = {
                "0",
                "0.3095559145837547181640731567486780257723",
                "0.5686566270482879509864228863223532743027",
                "0.7367234656043998715893445572796195761295",
                "0.7908588495080958925516676824833390825127",
                "0.7299577377373715211161595250613318427526",
                "0.5743061488143983979756175433066279369885",
                "0.3608207733778295024977796910446816370862",
                "0.1350145734224863971618958976170894634587",
                "-0.05854331596920384501283986212472255657126",
                "-0.1852168157766848901057186921439789100379",
                "-0.2268499054305923494605435665615431568263",
                "-0.1845553398672656895185240306326537932117",
                "-0.07728023128723158700771209671134308259696",
                "0.06338296118881594673690862683439842580100",
                "0.2008647966816450313668929391271846634540",
                "0.3019881117101377668915517163203120783455",
                "0.3441652602440662395442465269550331278820",
                "0.3198759981140886664391543604879458016909",
                "0.2375406397318753185006179521301711982967",
                "0.1187436836874612681385117178843939608276",
                "-0.007412346661406156783581913938371508978999",
                "-0.1114209780026199155221991625533412866467",
                "-0.1702680486598988586903116852857709427587",
                "-0.1725341351199887173499439240440387067235",
                "-0.1205942542313131977487774280935968407395",
                "-0.02951326558876340004724213146540588493499",
                "0.07698664382041043975696660704907879036998",
                "0.1724429483011480032738617147697836285043",
                "0.2340059415726384010021372791204954722529",
                "0.2477238309811512423602215806735856261507",
                "0.2115520404189838945923835440838279499948",
                "0.1354493180818646759401104573940069221623",
                "0.03862684559250750610978972526507268137864",
                "-0.05531482176637124291081390126158636978776",
                "-0.1241484633866197178823182697144541646007",
                "-0.1522907272182280160181814383946751442883",
                "-0.1343425379003319736364753558548963426676",
                "-0.07610403109794084351322061489133570361130",
                "0.007111480618858081649544342269536333710444",
                "0.09439369808132345089655218812036050227973",
                "0.1643917918050767916905958812054043001265",
                "0.2004495745773071442257945493611815345248",
                "0.1944925545792499502728801248028273033976",
                "0.1487661318033593093482436486620247418517",
                "0.07505780262693905483156947991918631344588",
                "-0.008354141687952980390078633498690868001871",
                "-0.08124420278783559415402373672654259171948",
                "-0.1263535660535143310192644663977812972258",
                "-0.1334869026810343464504867079805292896344",
                "-0.1018248201600151027058892130229472254379",
                "-0.03993216554932272276400692497737464303051",
                "0.03649424630892346452487872154267219356232",
                "0.1085527380058567727805660181032714159953",
                "0.1587615291029786131702302459336858357637",
                "0.1752543846802253913565138242916686964752",
                "0.1545442132311118363361030622279738286622",
                "0.1022143702500322190778622714942229064014",
                "0.03140773440237148552956202821366692228898",
                "-0.04048360251670139185524598670143297521820",
                "-0.09609842155416211001201937600759861975076",
                "-0.1223067630380355474349862631931292288819",
                "-0.1133177131777757477632318739038436524488",
                "-0.07196178363131432782778874596719801329900",
                "-0.008867378090357889032738538203624559269086"
            };

            ddouble[] n1_expecteds = {
                "0",
                "0.05217374424234107037559789471257600041045",
                "0.1984573362019443989353381326480237720461",
                "0.4102884759694156390007351518252809147775",
                "0.6467637282835621171228332858530973836621",
                "0.8631542066565353161919626297008024880957",
                "1.020109569186450360812823159076296095691",
                "1.091572318284190955284174540107308774769",
                "1.069726661308919359306622077616082748810",
                "0.9659743530116510997843172682940550418098",
                "0.8078119457940644415036446898345495769056",
                "0.6323810263876727317506325865396293437827",
                "0.4781752513827056561856436237446103350184",
                "0.3767590983964179346086708881587774882783",
                "0.3463057316786637261815900999919703366295",
                "0.3883130800042056097029921404162739136251",
                "0.4881160461214211402672246421251974779520",
                "0.6189509571294519036748687010509778003850",
                "0.7485424374510771033305170440228296239942",
                "0.8466485464256735999323328691793555120772",
                "0.8918324920945381111102670961861701105272",
                "0.8759580067678335339374480266982162721270",
                "0.8054691162982238201222472759586828900155",
                "0.6992769430369574608358088487457955089653",
                "0.5838573246424438456428789282672277391835",
                "0.4867839202388431653293275718738336267357",
                "0.4302434847424365556728379680995258039971",
                "0.4260364913247584580930876283748061630013",
                "0.4731765517961617287487917279822470084632",
                "0.5585650726975681518940838547438288671113",
                "0.6604872985119659653057866500600693041721",
                "0.7540244712892465377842023096042140454655",
                "0.8170541118759702188476604547419029723670",
                "0.8354094766457941951258661708201253904224",
                "0.8060058452421577282411056242922178786192",
                "0.7372518677139875492435187390297433840403",
                "0.6467223523183012038171054561878663207554",
                "0.5567163628618159912761944712856909645028",
                "0.4888090512655272274185567713204705266975",
                "0.4587166899220551473148954046930543039504",
                "0.4726881842910428798807071943294643355739",
                "0.5262450774871699492724663646890936647434",
                "0.6055145842210961934687432713621381288829",
                "0.6907774333568047583160804273652032532563",
                "0.7613330422262764425783341672688467092055",
                "0.8004900310476975402873702005070904033983",
                "0.7994857705950126668068986748668603470567",
                "0.7594197257787159730452116598192953352459",
                "0.6907791763334555575489595801430720914522",
                "0.6107205327711970379842490832271411889001",
                "0.5388036213269294761569084496412066830099",
                "0.4922333342863726687459902625112464663027",
                "0.4817608733489350389822422122926743037084",
                "0.5092167937542183975489539295561583694333",
                "0.5672382892126428320733661001005256130928",
                "0.6412158775466504483358409470401390458076",
                "0.7129508637506307348963724270983474844615",
                "0.7651126271689621152469822113564751737316",
                "0.7854082170112404995634760314496156859473",
                "0.7694645640992149705256708673985702479054",
                "0.7217503783469899850626791607273552061742",
                "0.6543480960072202309503786057180769794907",
                "0.5839073641029312641652097111344636369097",
                "0.5275445533136161394953204582639479939526",
                "0.4986948442673510389132977745578928073968"
            };

            ddouble[] n2_expecteds = {
                "0",
                "0.005242357780206453850907597683302217225822",
                "0.04046463614479462790943173013704675250205",
                "0.1286377218719449852827365052324503676427",
                "0.2803180603538537866215223056964632665747",
                "0.4910821045608411844003564566076913545055",
                "0.7423866696774831856417996162342935749434",
                "1.005657904832457848395587132374085637990",
                "1.248675120388748406592128545844361841797",
                "1.442794909192420792863616783823833191805",
                "1.569374548040279571833068323894561154363",
                "1.623942891639402774826527256701665209485",
                "1.617186635063330261064808678860972134493",
                "1.572548947846658220474039344860450370468",
                "1.521007669100873013634079859878203335081",
                "1.494234788905096488909409265375632000524",
                "1.517693626133767766376681253517807152843",
                "1.605226280788657817681503269945457751736",
                "1.756326082866672496860899031987299792499",
                "1.956663772012975832803278040591015390016",
                "2.181688722623384164335325212986364888404",
                "2.402430694094194864012230415762756629295",
                "2.592142406919792201366842348251797303761",
                "2.732257224133359072799133827794028060730",
                "2.816322778697388063925897292715473122472",
                "2.851062066334450367016199229135316254925",
                "2.854390251193272792708843460911992130045",
                "2.850918849067003153430065226748743602250",
                "2.866045973004159463757034019800329273538",
                "2.920033083173784272400063827195540198406",
                "3.023440003991684268391558573451377521761",
                "3.174943596979874103270036035671259925014",
                "3.361987898529732097818700718062370672785",
                "3.564043657174134631730000483575106967067",
                "3.757651082269978194249564179778839502799",
                "3.922021158507680891450770128105093284533",
                "4.043867400570193986006625698911449424310",
                "4.120350020242234867605106687110505485230",
                "4.159482840436362391140931052397187667435",
                "4.177964905403451945501935598204868289847",
                "4.197006936131656457595085554579635585530",
                "4.237184302542875714376532645905672196920",
                "4.313556887635866656680926374722757567096",
                "4.432207513282072598355996790545549051971",
                "4.588990960306747186167346819410715942299",
                "4.770745159556383021816042994634652583446",
                "4.958626231630280610648041464592046696223",
                "5.132730552357609956589988321815904261870",
                "5.276876676355286372085958192663496889950",
                "5.382403114385359290790560318276717458044",
                "5.450093879596013986427900668078055827894",
                "5.489806766696224740376328625722176400540",
                "5.517935642929263691282238578880851918789",
                "5.553353374040172265711109640899619064148",
                "5.612834073258041832440945687336129391039",
                "5.707060744025996346714861083394352872362",
                "5.838165390562787656290060229424349079038",
                "5.999365581429286127174596681317917599942",
                "6.176749482416057853825677468037321675408",
                "6.352745119889390133489578252284641062556",
                "6.510412837119774873104881854956663448207",
                "6.637515853977771785486557357656893196173",
                "6.729393470488133363683451709073219883437",
                "6.789964285764798819930133503375591567569",
                "6.830646711111268321770526886340772306535"
            };

            ddouble[] n4_expecteds = {
                "0",
                "0.00002089336642651773352969102925066573626823",
                "0.0006535685167624078501201144074800111748711",
                "0.004778716035883841221975506854492400675944",
                "0.01909929842160623471958047969526499358860",
                "0.05445793851843277158379170002904299614323",
                "0.1247379317775707353064660249424570008099",
                "0.2445645670977737851375503887870665637144",
                "0.4263741128907939414173133699237075402355",
                "0.6776290454224463138457158633320450156846",
                "0.9989709092506519628490107146634175389309",
                "1.383907084699418153071871552087592846374",
                "1.820267808053594433548471626476464531850",
                "2.293230930597615488783910939048190512738",
                "2.789302147097496164852556589201222583013",
                "3.300361540484965926965591571141962161148",
                "3.826816991624938613938476928858126859303",
                "4.379066129820401296309139019185273143553",
                "4.976829853330896439736330311021698762613",
                "5.646401199098056853874802585503636202232",
                "6.416341616139652855746228541903247059980",
                "7.312536018042477470691333216220361523901",
                "8.353695244709885909476433964619457345867",
                "9.548322794425220259604261213303538968592",
                "10.89385313566373143099835316707785590210",
                "12.37818929389618616437141463729422450163",
                "13.98332670062916014683256542632320453910",
                "15.69027346449246640661778125837980449533",
                "17.48417592421495707104030374219929215139",
                "19.35850441569884283000114504256192612531",
                "21.31736237543086403904330148319445673786",
                "23.37540591104047488617029658308287009621",
                "25.55540388594325425222822632792389546526",
                "27.88400529007683287707083980245077809537",
                "30.38668708903516989055883888786211994361",
                "33.08303778656016589886208052283047142822",
                "35.98344764734333161553062294845057151077",
                "39.08794595069782930970950404828001183542",
                "42.38742614091056193208762136154085236788",
                "45.86694784373177079612324726041648309070",
                "49.51032881264815933054145382851161602549",
                "53.30495010455044335415371428186110345077",
                "57.24566035139766722814201961282884810753",
                "61.33688678899404222242643920438323638781",
                "65.59248798656731896135194392628487766402",
                "70.03341453455019541819481973923461178931",
                "74.68375420196607172497210589883357566345",
                "79.56610806762439101111548059213220219700",
                "84.69738852208535791351929696427630527456",
                "90.08601718277827597711135022944312087872",
                "95.73115975368504697908324427963089903291",
                "101.6241481962080811856599727601264744584",
                "107.7517242929955030463416816477018901554",
                "114.1003146937033457286901301113380048365",
                "120.6603147903929356024257530489329735542",
                "127.4293701107528725901514174066338229488",
                "134.4138939665377395546992876858414995593",
                "141.6284870826965664393865271436346475221",
                "149.0934258455483873883502034289029011394",
                "156.8308411870096767095244391648625859893",
                "164.8605125448468664152093849874016954347",
                "173.1962807940718268244829991663776316524",
                "181.8439241871415528503326062217159063349",
                "190.8009828491612887180884542104103384336",
                "200.0585477164796525191785526443790886514"
            };

            ddouble[] n8_expecteds = {
                "0",
                "3.592507586300015309406991899618119921440e-11",
                "1.815342873242548549559566570062953203897e-8",
                "6.827782710960613967857933270622828620027e-7",
                "8.819816174857112908924431020315691883024e-6",
                "0.00006318965591401158772732276492447230396939",
                "0.0003108742558374831519240886717218986908118",
                "0.001177024337068422409931323504008686200688",
                "0.003671494951325393728930729193760656654710",
                "0.009860419239411090662443770669793094811958",
                "0.02349994154410740029338185365173673351907",
                "0.05079060677309914010503476145186028567482",
                "0.1011766924537979903815587266640902806177",
                "0.1880989660582410778540948281067752502418",
                "0.3296228570083884265604096931172474822413",
                "0.5489106012112237488025454595475857089801",
                "0.8745796214811473011704474117223023780947",
                "1.341074738304163183629340938866584544545",
                "1.989256652643891560315079663718889548921",
                "2.867450159492017870816063646690918425872",
                "4.033184623296765486738192287255839509952",
                "5.555789364076120198895043428778347962910",
                "7.519885427454641784858186052638093447487",
                "10.02966509985345129079487929855263258812",
                "13.21370461939955469416613709898618856786",
                "17.22995051862111834661100198018673701872",
                "22.27048720099786988919558568206704247771",
                "28.56575002775025612934475954378729847763",
                "36.38799186418230339047057391136385271654",
                "46.05401788882985419245643493558423859043",
                "57.92743207891264184961811361357368785213",
                "72.42083850263698079946298672809029143373",
                "89.99856285831662194894303887335454944220",
                "111.1804699891037348529177757691739676363",
                "136.5473399797175354533158545594396851474",
                "166.7480451736615692716957825988065554688",
                "202.5084851033928498641856302292955403560",
                "244.6419456705015168353741463837592203926",
                "294.0603176320266253992167814553416773632",
                "351.7854924467993368227094215927024728674",
                "418.9602827188828132639107781167379175277",
                "496.8583902168612873647554305264429018342",
                "586.8932339775229128161712338239915823254",
                "690.6257944246073396863119145817514113767",
                "809.7719522969999544451830259607365635027",
                "946.2100309331607661789846178601415159819",
                "1101.989333088562268550914912765167993526",
                "1279.340376461554953515532909113458566626",
                "1480.687290594353807066231740486337057720",
                "1708.662492208486250967077879865730018001",
                "1966.123381480004859336531698657435772207",
                "2256.170481630534689718378879562869671627",
                "2582.166251263085231811859921037504005594",
                "2947.753778414459543759948891926564464152",
                "3356.874724300369786357157952187068517293",
                "3813.786189544211621504261828377235467912",
                "4323.076559055329629529589650583937035296",
                "4889.680757688500243397346034401356258649",
                "5518.895632117240508490746043527025539007",
                "6216.396299999782126214123864446367530460",
                "6988.254245929177793647129297019503720524",
                "7840.957707830607209447000825372752365400",
                "8781.434540375309903545373166266631039731",
                "9817.077344726209539362837143903841923580",
                "10955.77030727741813987292244652134773969"
            };

            foreach ((int n, ddouble[] expecteds) in new (int, ddouble[])[] {
                (0, n0_expecteds),
                (1, n1_expecteds),
                (2, n2_expecteds),
                (4, n4_expecteds),
                (8, n8_expecteds)}) {

                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5d, i++) {
                    ddouble expected = expecteds[i];

                    ddouble actual = ddouble.StruveH(n, x);
                    HPAssert.AreEqual(expected, actual, ddouble.Abs(expected) * 1e-29d + 1e-58d, $"{x},{n}");

                    if (x > 0) {
                        ddouble actual_dec = ddouble.StruveH(n, ddouble.BitDecrement(x));
                        HPAssert.AreEqual(expected, actual_dec, ddouble.Abs(expected) * 1e-29d + 1e-58d, $"{x}-eps,{n}");

                        ddouble actual_inc = ddouble.StruveH(n, ddouble.BitIncrement(x));
                        HPAssert.AreEqual(expected, actual_inc, ddouble.Abs(expected) * 1e-29d + 1e-58d, $"{x}+eps,{n}");
                    }
                }
            }
        }

        [TestMethod]
        public void StruveLTest() {
            ddouble[] n0_expecteds = {
                "0",
                "0.3272406993941807802475218143697526013250",
                "0.7102431859378908887385266778116507449444",
                "1.216162510717181857992529749535876072203",
                "1.937433757991445661161521326319693095686",
                "3.011211693737305844123707955172163278012",
                "4.648685731753710282598935769061639910923",
                "7.180846515103737996249971785451748540442",
                "11.13105020324858343097100040520357379036",
                "17.33089305837677895066848319862197024570",
                "27.10591712655814655322253488178511411833",
                "42.57386983077723045779785014005868582685",
                "67.12445480390249156120767865927815620989",
                "106.1919336606531057893010525008439611832",
                "168.5006203470326714814205511919322730537",
                "268.0745645842682328776212237301649681264",
                "427.4830347130955659684785419034990276601",
                "683.0858023736762482145692992030385677140",
                "1093.516603582007699838472233378687707484",
                "1753.413128979494757810715726539959851665",
                "2815.652249374594855548334002593719310874",
                "4527.380472707572578240995694708803157523",
                "7288.430939427028561555651775927584600196",
                "11746.08570491999805974223085659584115885",
                "18948.87189987486777162740657978246572480",
                "30596.28387682395006494895769994422162648",
                "49444.44030281520300239383988445633121071",
                "79965.32068832963991988178071840767092340",
                "129418.5169831999854704964474514652658791",
                "209594.2798380666604791838726093822016156",
                "339649.3306592783659032280838155645440212",
                "550722.0790639213519747339611980176450595",
                "893446.1879697840081476191854466996032737",
                "1.450186378606488271956754496004031216916e6",
                "2.354970185586019030390721582663431419821e6",
                "3.825965212911510935929748640407647829877e6",
                "6.218412385300761061263429125998175872353e6",
                "1.011092147172043323904794361424875092676e7",
                "1.644619040701008773867425187009635981444e7",
                "2.676052530710355224669122184975322902527e7",
                "4.355828252764104671762626974669400150634e7",
                "7.092286980318679712317780578301939852872e7",
                "1.155139618917726011671851743720416489742e8",
                "1.881953804508778409946300398017884882728e8",
                "3.066929936113665191194417084697871240136e8",
                "4.999351647603795716534283637643275783540e8",
                "8.151421224851598755251428155518531005386e8",
                "1.329407193968940289256321602742119452424e9",
                "2.168619088214803874121870334925772249728e9",
                "3.538383451191213036059019322908280772978e9",
                "5.774560606440804168887835058903871801593e9",
                "9.425875965292671959093493566298751495743e9",
                "1.538897670563628836445228009327514355905e10",
                "2.512926155882526645252543341319962873779e10",
                "4.104200585473434426363679732882775802928e10",
                "6.704298960134221733940773345562116095830e10",
                "1.095346047317345077174206110238504233095e11",
                "1.789863375637768746763523953409756830120e11",
                "2.925206317856688874688434743861334985746e11",
                "4.781441638880181988262489395392357443005e11",
                "7.816722978239562452370719914128833742000e11",
                "1.278062138712545579249535488439434543981e12",
                "2.089962966491883237741261563852895527649e12",
                "3.418083498821055257018823224876607119019e12",
                "5.590908381350853172528982567840449882489e12"
            };

            ddouble[] n1_expecteds = {
                "0",
                "0.05394218262352266329233324711166140172770",
                "0.2267643810558086368261753538677918847362",
                "0.5538569084469909528036042914097475596921",
                "1.102759787367715817589721650181908914812",
                "1.988030772235941619192274274668963130676",
                "3.396612947474775997751454161593429909993",
                "5.629501784243684751229495614097907971707",
                "9.169277811738684734414116023452451381955",
                "14.78907536786911544302722014975834835332",
                "23.72821578040828244582709544174408094554",
                "37.97532826643887380386991877471957017379",
                "60.72501073909463448951786385227277836739",
                "97.11494086325776139591491032046358687936",
                "155.4165665242666096577585856013282921164",
                "248.9598897278396627127023796259733767158",
                "399.2470913872569767243187488725777172921",
                "640.9925758904929989869873389622785424401",
                "1030.286336927693234969226335721166345986",
                "1657.823806973640863208609663828299555382",
                "2670.358285208482969378435752177230712182",
                "4305.504219152466282755862856242959019805",
                "6948.227455786042067354498301476550880526",
                "11222.57805962761006611788169725360153551",
                "18140.71668848608250377823185289451537131",
                "29345.11718523012632929690109147994169431",
                "47502.35458104362933268418319289652459023",
                "76943.58528639345928262930301103699552849",
                "124706.6258319541243600868713672372866119",
                "202232.0066704533293152042664705991959968",
                "328124.2882206846643236459587526280114562",
                "532649.0684640855748897718985589378091175",
                "865058.8017530463390644840697464172537536",
                "1.405530156094138971526069152326026762085e6",
                "2.284620949415393478717978384015852217252e6",
                "3.714991383165718933197656429614450647867e6",
                "6.043132607479886285338393900259045687845e6",
                "9.833741224668536589218562753787063178856e6",
                "1.600737315099605122727213033871608739627e7",
                "2.606506862952539645993817885100236035254e7",
                "4.245497275011197944883219975963068482375e7",
                "6.917083104409069899847448149235401469480e7",
                "1.127291985026095216485490421871343585398e8",
                "1.837652939307375432235533945827254942525e8",
                "2.996396062420829644144238142029466562987e8",
                "4.886961458799769553913816166414239255731e8",
                "7.972200254542410174982373216842415745161e8",
                "1.300807286071902048661511734885596559502e9",
                "2.122947892651805138022489176922559283605e9",
                "3.465402510845931498989997952142614945427e9",
                "5.657865129243105186330293993901548392246e9",
                "9.239167087921253026457343551392399693664e9",
                "1.509007264170597055558012609960362007010e10",
                "2.465047194512060673750088595701475150327e10",
                "4.027465431280231697003475499446080551295e10",
                "6.581251689371329415510007295763590160043e10",
                "1.075605042074464395521388836285109875374e11",
                "1.758176578099415995772779687273094253124e11",
                "2.874321081256189520668645269724625677200e11",
                "4.699688854156414152130446338088439389215e11",
                "7.685320389383210894760277396850642388585e11",
                "1.256932623307835601273619050849831729233e12",
                "2.055972795293928776006283794866850481801e12",
                "3.363383210948073022645765932978327653752e12",
                "5.502845511210612190700528054213769160640e12"
            };

            ddouble[] n2_expecteds = {
                "0",
                "0.005368673505493236565599650341430753057859",
                "0.04450783303707983406099761891271449275943",
                "0.1593767466040699160499565009111839352115",
                "0.4102607890453422815214429738110792154494",
                "0.8902705989755680962069426575286115666898",
                "1.747657327736278274355764607842629189457",
                "3.221265284916597047673564348324067438544",
                "5.697584934222465939663228988823938168535",
                "9.803041014105800072487527218494284805354",
                "16.55359786044886466976580494927071932655",
                "27.59752330273161964257030783603494892691",
                "45.60954501280245071188398726820711519115",
                "74.93107055490557347543280542737029715960",
                "122.6104409188607122548847068476950079272",
                "200.0937112259253694632117515295135907151",
                "325.9736091399677715391974278760477784753",
                "530.4602637894991601377406152270257086838",
                "862.6542249476397924827508869468472360319",
                "1402.381628056757235162848181924265991419",
                "2279.458526425006323862395068646639643611",
                "3705.056261760959132539114587499119571730",
                "6022.782584058157963172647850159960290064",
                "9791.892623103729276283418401687271033905",
                "15922.87263937105036229206579741941959979",
                "25898.41254480226492999863879591788904936",
                "42133.62706620515435513525361313789615302",
                "68563.40622729569553974471073495778114214",
                "111600.3138292212047061211133306579379998",
                "181697.1329569204476086411776652766507982",
                "295896.2424643252394200265783066133588731",
                "481989.8778018821098079316969259697345002",
                "785310.4424452005886640622738747788329148",
                "1.279815585549965829468328895430809535287e6",
                "2.086187642848635204835505521217831970211e6",
                "3.401391055505804246958848536401993825738e6",
                "5.546949386973250601848882461647960966692e6",
                "9.047810386474878061750177053445247574590e6",
                "1.476119972761159419375324077710599430061e7",
                "2.408718079681601683588037095098026745759e7",
                "3.931278100849803298886742926716390975692e7",
                "6.417449169255259335948827218224329580733e7",
                "1.047778432923285258656825307302358594448e8",
                "1.711009299413907861689587808225259853070e8",
                "2.794530247389957977195036337155955205745e8",
                "4.564955025741777717506677025519103282387e8",
                "7.458186371301264597651434761741213216496e8",
                "1.218700185912136295185883771213356152468e9",
                "1.991706758734195267012678825577945214840e9",
                "3.255493445106769398540914712106299745360e9",
                "5.321931390796190984251567013762289151129e9",
                "8.701235403966011499737103636322005525888e9",
                "1.422820188152615003811938593280484334649e10",
                "2.326884857621155732585701437021996835624e10",
                "3.805869812213052061084450931563232732469e10",
                "6.225662473050920560869762644414614527582e10",
                "1.018517115681179774930275506102517875099e11",
                "1.666482563079085237106303396886135789293e11",
                "2.726977277708515203313455080486472872378e11",
                "4.462818665654434321801341885034781396245e11",
                "7.304368285550353082149943286697904077412e11",
                "1.195640327341625042081375304291948130222e12",
                "1.957319560337309428523165344069060128969e12",
                "3.204535358436715319399708640902674149925e12",
                "5.246980536893399299704945363459283602712e12"
            };

            ddouble[] n4_expecteds = {
                "0",
                "0.00002121234269827818089849150841717092642842",
                "0.0006944030880567454830972752596096331748665",
                "0.005476828282537948233920845604295437225096",
                "0.02433761549935501382132314294367886902872",
                "0.07952053286932381898372463566795784465513",
                "0.2150924730776640863203997179076918496016",
                "0.5130557593618729844558076135429227986298",
                "1.120602344864599268297428394623701439896",
                "2.296113410156280324924982283320882066138",
                "4.486551733335020714523896309017283060553",
                "8.457272457095396371048754082573023153398",
                "15.50916725181643030029563170831662379057",
                "27.84105241730622729008111925349790128798",
                "49.15324532509174888984481162726819039762",
                "85.65112825079336592077069220664402243081",
                "147.7112980276158645957165048235681206643",
                "252.6442092560161266204194348739111395389",
                "429.2697898788389611618853225096063224222",
                "725.4883751755477704431978101135630367374",
                "1220.797035280268563019605478281930603912",
                "2046.966066287635590483230774198255838706",
                "3422.173053226564710892864293908970622870",
                "5707.320445213969901803474110093288389703",
                "9498.905234057680174938061266680428701568",
                "15782.09367598855168894030053869607157223",
                "26182.92699158263728336820858863494994691",
                "43383.70351537586942578988577384065369268",
                "71806.88966862227642379980685998065526538",
                "118740.8270626184827994487256583234519449",
                "196192.1499791494086497830075037739582114",
                "323933.3433875231843570533701699169430281",
                "534515.4858994211324305300084477933549458",
                "881511.8849826162400208843811640596020742",
                "1.453072795151917821514125013227746735249e6",
                "2.394209679260163780457088755370731784254e6",
                "3.943426214903708296729041859521372856864e6",
                "6.492925498413258308656292375751977633498e6",
                "1.068755703558488343501726687204313365255e7",
                "1.758741512385657666661824845328281597164e7",
                "2.893501263256889111562203965881898662082e7",
                "4.759425570142239359164176832595914756636e7",
                "7.827164561407768615504781911194161010067e7",
                "1.287010901979617113041744863072509044186e8",
                "2.115902479509107315315170288341133432641e8",
                "3.478177352774013524720962155785919848016e8",
                "5.716848901601807788223099319187802892368e8",
                "9.395420817500797427401644166580255713552e8",
                "1.543957489481178283747608693307746010952e9",
                "2.536988861703955517984847383680004324871e9",
                "4.168405836815532023256146387355118920226e9",
                "6.848466505993926844612597131109797018771e9",
                "1.125102058787062508553533192014420526527e10",
                "1.848284252716667544594519683604280823940e10",
                "3.036173608409391789812530916507266276846e10",
                "4.987327744589172708429137526650570623668e10",
                "8.192094150692743807693116398586943483329e10",
                "1.345580606265074412606700211476856060360e11",
                "2.210111148511051684145038299200768749209e11",
                "3.630026616818843397055295813206650250186e11",
                "5.962087360394425752936977364424074729680e11",
                "9.792218351492727825588118269411434314945e11",
                "1.608271411905916136184825819177903112805e12",
                "2.641400484718617550425472892472012369496e12",
                "4.338173109684323419779441713823558715760e12"
            };

            ddouble[] n8_expecteds = {
                "0",
                "3.624159421066302149312427476520676531187e-11",
                "1.880169425772287604059304037109822238870e-8",
                "7.388651319725693844905996842282799499269e-7",
                "0.00001014864223776685253094347591895918474141",
                "0.00007868032893654337884108559026994459637046",
                "0.0004262566362693989806902641367398601731197",
                "0.001808450325566365468650312550677220778511",
                "0.006431687707840815404556629971454419580171",
                "0.02003548050939189141466667170721316484169",
                "0.05633284853517740887246641961862277263383",
                "0.1460521770778564565496691171686541257187",
                "0.3547332405053031387152296593387557075012",
                "0.8168629238518760155495015958416773557742",
                "1.800057470215061512801257559391722300618",
                "3.823836971005041496453894238042175454652",
                "7.876612960760537809525304743656173923994",
                "15.80790016659709524980195334833890236562",
                "31.03093494500402116417602908522003434688",
                "59.77180149492370531432106022083970055329",
                "113.2755870508009404381331997646297266138",
                "211.6805245834621770225415730518206376061",
                "390.7870073726813482516176238268539103323",
                "713.8318915306975578881630649399038585529",
                "1291.887776656213453603533794122215654251",
                "2319.079254510158561373318913888501619107",
                "4133.183010380287084430995673085888230475",
                "7319.605120529465397145831970566700195376",
                "12889.31325495437676103254146679697817893",
                "22582.59153458355907717275615435300706813",
                "39386.45005763561040170833503929855942404",
                "68414.18973026576089856525595962299848057",
                "118397.8343936243621956220154417883538334",
                "204216.1373364124922531503622862776580524",
                "351169.9711947661403097100613509568843599",
                "602202.3515358046419220036650819055511716",
                "1.030074679815818612521615028999475110253e6",
                "1.757875620175069524977608644656594670261e6",
                "2.993524551838389988262715188574763000939e6",
                "5.087755831506893587399998522606480112728e6",
                "8.631464407166457361552908657845115788559e6",
                "1.461897730499841283121930223533720043454e7",
                "2.472165522676854214980953565324513541723e7",
                "4.174599821302155658017596550868115434455e7",
                "7.040007814286631095410333126178234924859e7",
                "1.185748778449904353651708127909491334928e8",
                "1.994849884482122984095613180644060234191e8",
                "3.352426964750368952132797814118826983446e8",
                "5.628216043464906016017264232708217894480e8",
                "9.440016356800219170497130447280699380312e8",
                "1.581944443937929079744799254733146240974e9",
                "2.648805595047903859984034367795510664797e9",
                "4.431710087493197697764055445472321621276e9",
                "7.409268537248398397863319780535868265506e9",
                "1.237886629355837915931355774191523610887e10",
                "2.066832909456909708018636572266039829528e10",
                "3.448775876795452461346423758331046867156e10",
                "5.751414616729662818274558931055232549047e10",
                "9.586242660695511867802802653333886253041e10",
                "1.596978854156424071795030953916237097771e11",
                "2.659126521895299123937631031922945949745e11",
                "4.425671713686416319203672095015473731232e11",
                "7.362584120538808203653840677686276968992e11",
                "1.224340053713984259777553454316261233277e12",
                "2.035184369742387802162231343976307280127e12"
            };

            foreach ((int n, ddouble[] expecteds) in new (int, ddouble[])[] {
                (0, n0_expecteds),
                (1, n1_expecteds),
                (2, n2_expecteds),
                (4, n4_expecteds),
                (8, n8_expecteds)}) {

                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5d, i++) {
                    ddouble expected = expecteds[i];

                    ddouble actual = ddouble.StruveL(n, x);
                    HPAssert.AreEqual(expected, actual, ddouble.Abs(expected) * 1e-29d + 1e-58d, $"{x},{n}");

                    if (x > 0) {
                        ddouble actual_dec = ddouble.StruveL(n, ddouble.BitDecrement(x));
                        HPAssert.AreEqual(expected, actual_dec, ddouble.Abs(expected) * 1e-29d + 1e-58d, $"{x}-eps,{n}");

                        ddouble actual_inc = ddouble.StruveL(n, ddouble.BitIncrement(x));
                        HPAssert.AreEqual(expected, actual_inc, ddouble.Abs(expected) * 1e-29d + 1e-58d, $"{x}+eps,{n}");
                    }
                }
            }
        }

        [TestMethod]
        public void StruveKTest() {
            ddouble[] n0_expecteds = {
                ddouble.PositiveInfinity,
                "0.7540746480904612753124716318170099361459",
                "0.4803996628326109930034961202988381114749",
                "0.3542745418066410276342760023015297137618",
                "0.2804831768583507729550610897561812092446",
                "0.2318873781221396332886871746992420366376",
                "0.1974561388016080160085073509100115257717",
                "0.1717988294570029957457339135285193904845",
                "0.1519553127475513890655310320642426816992",
                "0.1361616926603006882596039340540675995138",
                "0.1233008094723488899679302920680677013485",
                "0.1126306874513186888283941605346916362237",
                "0.1036393441143134645506037288576806712378",
                "0.09596220363175074865861554306536604142392",
                "0.08933270515602521162119358997012139598793",
                "0.08355151053343640052785899001844632246030",
                "0.07846662232257154636422831582169171907073",
                "0.07396015487827876354031104655120644433931",
                "0.06993929982906399042135406724011575536851",
                "0.06633001352915147363390370725030296284295",
                "0.06307251640386187671405184047420391268247",
                "0.06011802583647024001774057456564612549350",
                "0.05742634588945962629414413979891339999554",
                "0.05496406303128900669968686632914984061125",
                "0.05270317751437271633774118574341978412321",
                "0.05062005261335608960082077341788293172779",
                "0.04869459893911251097384957367787815469241",
                "0.04690963477362485107960198356515409510029",
                "0.04525037971896431489791556230021315248971",
                "0.04370405038479388439221865711177130503389",
                "0.04225953494223297756829221975214192685860",
                "0.04090712918954927710553796294071552302437",
                "0.03963832100115227279803949149077750383459",
                "0.03844561313496653954589079438482395609595",
                "0.03732237667595244961659846620676671169712",
                "0.03626272911839145121248237132262263003290",
                "0.03526143239318259862377786103276482347060",
                "0.03431380713999115227854650171289731167296",
                "0.03341566028740064075786083835757925824537",
                "0.03256322359501254876381239741819863234771",
                "0.03175310127193961973482317401500232782868",
                "0.03098222514748631348402051823852385776453",
                "0.03024781615515137820674046887094495638291",
                "0.02954735111776609590759160550257255433845",
                "0.02887853400268774959305745763635582729070",
                "0.02823927096145069476563795078661352381432",
                "0.02762764858574985194085305434010242876481",
                "0.02704191490695534637008568840229265914526",
                "0.02648046274407344772230839366436175817319",
                "0.02594181506871608276640345923299041580043",
                "0.02542461210799103512843944567622506546526",
                "0.02492759994946076835247856836589350500997",
                "0.02444962044816786176873879911849018965044",
                "0.02398960226556403802420792770748976398199",
                "0.02354655289510625942605520801262812840008",
                "0.02311955155017920644968033202586029062583",
                "0.02270774280757951255983141092363595251477",
                "0.02231033091462886240414959052322759577875",
                "0.02192657468053812866023740278933182445039",
                "0.02155578288330464813821716951672483875680",
                "0.02119731013250191523922850222429027082397",
                "0.02085055313607210353552043303424664775084",
                "0.02051494732586857747235853553267490744702",
                "0.02018996380239303065611391494702456172748",
                "0.01987510656407540920180767805396705324091"
            };

            ddouble[] n1_expecteds = {
                ddouble.PositiveInfinity,
                "1.523646136912584139564182530035873453652",
                "0.9796701575022331154824881326959885925960",
                "0.8225971029433269349535649724587262376626",
                "0.7537961598244996640112040581305740203496",
                "0.7172360686897495173132026891649249168196",
                "0.6954351443946503823758103197883428560219",
                "0.6813839003966790724120548566999077058531",
                "0.6718009507518193540526421051652908965388",
                "0.6649770299419964763688504750237331126553",
                "0.6599488024028375967025940143465123715321",
                "0.6561392653440623500767521657768298692568",
                "0.6531855956831039068224238953285149817284",
                "0.6508503723556933875865057342410150916823",
                "0.6489729687028485962423582695503653049708",
                "0.6474415904903218615012663327651344401143",
                "0.6461765078526686345227799083126810282793",
                "0.6451196365279893737033639818111449339778",
                "0.6442278622543612156803923971715245059756",
                "0.6434686470384659316889444410429554393568",
                "0.6428170678875842271869836215229473072668",
                "0.6422537784105649555454694299156029817117",
                "0.6417635788832809658009108853925044854242",
                "0.6413343958939566391644523894093174065086",
                "0.6409565429033403666932941996026985443677",
                "0.6406221767763443454140567094163805861426",
                "0.6403248931631300615975450269094128350481",
                "0.6400594216647873675523506651013080378553",
                "0.6398213936523339954977672033821594932073",
                "0.6396071636263069040032486900066037810807",
                "0.6394136704750924533653347949939625360631",
                "0.6392383287759042103448647647226187892941",
                "0.6390789429365533592170585503820310569073",
                "0.6389336388598845388960670667052679762151",
                "0.6388008091649240417854496659924781322671",
                "0.6386790689797715030287687861635868847774",
                "0.6385672200400797617933602466005940527797",
                "0.6384642213586254526050249709066430289053",
                "0.6383691651281805190841274489361792898634",
                "0.6382812568183730372219593347126018094394",
                "0.6381997986535641757446832175731605706458",
                "0.6381241758316796790854144787782357864204",
                "0.6380538449769615382598611703513795697060",
                "0.6379883244226328525124323312096262683112",
                "0.6379271859997688197644869818905966981343",
                "0.6378700480716312327571109562207514226484",
                "0.6378165696023795401664214249992410175797",
                "0.6377664450884465501642178201455950200518",
                "0.6377194002122533886856135348252780444297",
                "0.6376751881030824493772627141844160717905",
                "0.6376335861101668862102387580191524461731",
                "0.6375943930094220694563078541407870802006",
                "0.6375574265785376884537429353383218705036",
                "0.6375225214859916281878282752413898065189",
                "0.6374895274484260677989673796147153236847",
                "0.6374583076181262178126656535625257097912",
                "0.6374287371683661334803232259821912637382",
                "0.6374007020493750623985003084136537457112",
                "0.6373740978918239836545950277653056452166",
                "0.6373488290381892923444152038556693437406",
                "0.6373248076852427501717562565776992920192",
                "0.6373019531233437767787446737746779591631",
                "0.6372801910602528582412555033376208480652",
                "0.6372594530189091369517428775851311548532",
                "0.6372396758000748481666446744052617103491"
            };

            ddouble[] n2_expecteds = {
                ddouble.PositiveInfinity,
                "5.446613194954472173456847663908160119817",
                "1.691147242961049018986658496256491556430",
                "1.060831481634918890508244821055133993857",
                "0.8977261645445364531064996707010977765303",
                "0.8724179538026444331248208545410791035997",
                "0.9027870631624069153175679157722744930474",
                "0.9602864671032775649349930908003044166400",
                "1.032771525785133412061503425171812697421",
                "1.114313312531958649184298857302677733873",
                "1.201711665434755053838999069487299660827",
                "1.293101658377997052292542103873503334789",
                "1.387328732515217190541274343231939218947",
                "1.483642289530529870339353196185968201341",
                "1.581534278569145140195728659473450355849",
                "1.680649011182936120227982999110733148581",
                "1.780730230954145860467893470563298399700",
                "1.881588722483512933692143522292853172595",
                "1.983081764441315864512004959268173145928",
                "2.085099682555234905408226300600062557528",
                "2.187556805065592778975128395463910375897",
                "2.290385230480648261802912004062050749029",
                "2.393530439861359413310256065796601089011",
                "2.496948147721649325379334152816241520411",
                "2.600602002439842717079948061483926432489",
                "2.704461880535781268480157689630643995963",
                "2.808502603345503574906937457124075325964",
                "2.912702958904904136101394744562520427128",
                "3.017044947565796333097119525898458675945",
                "3.121513193800075513438832771309474698586",
                "3.226094482959019398258094353697340318639",
                "3.330777393046296807538902578765134254414",
                "3.435551999493017393506946445920616101681",
                "3.540409636566716852084226795774766914870",
                "3.645342703112685832727368758392869980566",
                "3.750344503290187888502855206740455747127",
                "3.855409115150092100028694709529868093443",
                "3.960531281525891142914823261934166108122",
                "4.065706318931300200729383354686768364859",
                "4.170930041083330082480699741006928812286",
                "4.276198694377292418343212171009363383488",
                "4.381508903185296410125834654149542114568",
                "4.486857623272866741251515493211969520554",
                "4.592242101958982321948852928808075709407",
                "4.697659843905008962030365084492907583126",
                "4.803108581623998821212618146497328574788",
                "4.908586249965914028174459581112590849067",
                "5.014090963965774809863241123097817920350",
                "5.119620999547598412605773162158204330632",
                "5.225174776662701548217997794406648763458",
                "5.330750844510666841397838434049119198044",
                "5.436347868548268653237122943487107516334",
                "5.541964619038450267074647787693160658609",
                "5.647599960930032791459080889460323843489",
                "5.753252844890787018461091190406386336225",
                "5.858922299343058951220009099770880308319",
                "5.964607423373301079965185509220390082277",
                "6.070307380405420216981749228749065792809",
                "6.176021392543448692356458575966187115265",
                "6.281748735502195911924504542605947594061",
                "6.387488734055661032194239116448130830022",
                "6.493240757942426334242500895400441973945",
                "6.599004218175283980001154576553034046842",
                "6.704778563709205302554575123053190145615",
                "6.810563278427630261614314851323641250460"
            };

            ddouble[] n4_expecteds = {
                ddouble.PositiveInfinity,
                "499.2725817128787530500348203585111819730",
                "33.27907659748888110334343573486692157821",
                "7.366750552515653074590569943939986162542",
                "2.785042524752206926479354987886007633304",
                "1.487655281485439915270294447445970374633",
                "1.041420770502710241640105536081665010322",
                "0.9042251697361314349051041327106170205612",
                "0.9153108814246364520329707682636207464542",
                "1.018128884207826155496094193892260280866",
                "1.191113196624345157330034295425352645121",
                "1.426344632544804214595027290611506710050",
                "1.721876764602567206419536133435570856989",
                "2.078627068582410748519353855405635082059",
                "2.498992163592953966758812035908696783227",
                "2.986181244656778203570989943254749081737",
                "3.543873767313766684439802843564082167272",
                "4.176033735895111741721365296077586598644",
                "4.886804090502106143156005534169361666656",
                "5.680444137509648804343448770303363950679",
                "6.561291128007746638973948208018246171441",
                "7.533735905781038149868189131018461473734",
                "8.602207032098763668374756866896497077551",
                "9.771160172681814867192290782381515392478",
                "11.04507084008123762617810322410307607449",
                "12.42842932801817912293165021031055656110",
                "13.92573710939313910020031229000413204306",
                "15.54150423135452307507353872247375876474",
                "17.28024740206944680607393309432954263132",
                "19.14648856544939210430807461921314268572",
                "21.14475382543479406113871026153450601323",
                "23.27957262427409372760095631973193579899",
                "25.55547710779755827537222935118731251362",
                "27.97700163004596609934380005701020987485",
                "30.54868236293330245741648142908653301461",
                "33.27505698591438658436280780970758286449",
                "36.16066443719542569433291856403668201757",
                "39.21004471272363074192333170234705150705",
                "42.42773870259162421164112971854977343704",
                "45.81828805697877729338081147952096403939",
                "49.38623507558850513867902200209456302488",
                "53.13612261591050546609267076300423745235",
                "57.07249401666780766190706152284552428410",
                "61.19989303359080261071005500062015823407",
                "65.52286378525884497233219067531818519848",
                "70.04595070721125464240733654119585675835",
                "74.77369851288760007209033786790513836720",
                "79.71065216023700288053082570596981352221",
                "84.86135682305635941690364412983999248899",
                "90.23035786629163602489588359159123862544",
                "95.82220082467513981533135284986241751302",
                "101.6414313841827539134758112329913605404",
                "107.6925953658845449683325027764877683820",
                "113.9802387118344958244393041657342315149",
                "120.5089074727039339010104581422857446386",
                "127.2831477969112691599199189450564265660",
                "134.3075059210400740585829624985232892055",
                "141.5865281613700188121124149982245150520",
                "149.1247609063720498838180953783240508216",
                "156.9267506100415234834831014794419457225",
                "164.9970437859616200006739285003799316992",
                "173.3401870020049428753331310432554074555",
                "181.9607268755942875600226872787623443033",
                "190.8632100694545898485289889188965682742",
                "200.0521832877973820980648509161041240290"
            };

            ddouble[] n8_expecteds = {
                ddouble.PositiveInfinity,
                "1.060818575158797902585980353813661443265e8",
                "425674.6184865248471125870174180297781657",
                "17375.13220904873414673685588491256278132",
                "1853.922183979692592724549940944783850864",
                "337.9597499462041915539170935759316791971",
                "87.15020577548868190709622361675926092026",
                "28.77212777223240183290312331752602565654",
                "11.47476347144237175566637432922165521456",
                "5.338974182309988756427307258416833838063",
                "2.844369324089702577661525802392808822972",
                "1.727395627261539661220714408108647284657",
                "1.206396095573216618410496107472217919569",
                "0.9836767074831297522280263054004056371424",
                "0.9410581039296541611696360877824925335766",
                "1.035866219934770640693655913341760831734",
                "1.262249561458332269712088914429382474952",
                "1.636082368842766486164165778535060270891",
                "2.189203519304326047691311739822815579023",
                "2.967697995511708320835331323925913948075",
                "4.032109149562802572445203804926454144702",
                "5.458687413686560458394959369051791655337",
                "7.341278311003870992581038762107124754451",
                "9.793667676736390539819832383186846933354",
                "12.95229989018752449392138504417021872745",
                "16.97933155858417762805238544647805089062",
                "22.06600625008059881467135160561995921143",
                "28.43634780639749950903447728116008575069",
                "36.35117612724155668291080832288478340481",
                "46.11245281682648649559173933474230101264",
                "58.06796606183955412170711150516005722694",
                "72.61636525944281971490649469663616259840",
                "90.21255659757751958964333932310631079020",
                "111.3734712057391292519116035944702764539",
                "136.6842177526877488044821227207099297859",
                "166.8046315310955259745543382040339142076",
                "202.4762321745492878794143350963679441865",
                "244.5296022214267913550882704486381054473",
                "293.8921987861758130357291348420939870908",
                "351.5966106296153229978372630096864426526",
                "418.7892729411775767299308834677190066068",
                "496.7396521607925838658591194640700916192",
                "586.8499131785020215375680126258171450739",
                "690.6650812572705554376888818106200035955",
                "809.8837110297653000712015240443315181218",
                "946.3690749237232044854037911693178724529",
                "1102.160883373347284748278825207097906626",
                "1279.487549176259468287203035624342680093",
                "1480.779008357095021717861389646608643233",
                "1708.680109899995192086477012380189762388",
                "1966.064586713143228924468484200116320492",
                "2256.049620189167851912852078056163336225",
                "2582.011010725760662198994247371784357048",
                "2947.598966571258767470994047389412685904",
                "3356.754523360259542087672846993424036142",
                "3813.726606704582125431108514084207134974",
                "4323.089750205085763770797434707548215465",
                "4889.762481250010292135575228200334704463",
                "5519.026386965627914025001749491457689402",
                "6216.545872685094807478850450466293847113",
                "6988.388625301471206100773083595105356098",
                "7841.046793870943511444048000940824002399",
                "8781.458899832334818482098494188176530891",
                "9817.032489209033417447037196611141892619",
                "10955.66753915950428330708005765076099894"
            };

            foreach ((int n, ddouble[] expecteds) in new (int, ddouble[])[] {
                (0, n0_expecteds),
                (1, n1_expecteds),
                (2, n2_expecteds),
                (4, n4_expecteds),
                (8, n8_expecteds)}) {

                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5d, i++) {
                    ddouble expected = expecteds[i];

                    ddouble actual = ddouble.StruveK(n, x);
                    HPAssert.AreEqual(expected, actual, ddouble.Abs(expected) * 2e-29d, $"{x},{n}");

                    if (x > 0) {
                        ddouble actual_dec = ddouble.StruveK(n, ddouble.BitDecrement(x));
                        HPAssert.AreEqual(expected, actual_dec, ddouble.Abs(expected) * 2e-29d, $"{x}-eps,{n}");

                        ddouble actual_inc = ddouble.StruveK(n, ddouble.BitIncrement(x));
                        HPAssert.AreEqual(expected, actual_inc, ddouble.Abs(expected) * 2e-29d, $"{x}+eps,{n}");
                    }
                }
            }
        }

        [TestMethod]
        public void StruveMTest() {
            ddouble[] n0_expecteds = {
                "-1",
                "-0.7362426713471427390156626010756039280046",
                "-0.5558226918141174468597179474030667926633",
                "-0.4305606790557089868837763759574393909066",
                "-0.3421515443446216062756831144918402575994",
                "-0.2786274503128171915822002747338927480998",
                "-0.2321068541113138030122997769596793385010",
                "-0.1973569171217416640938660607112713737028",
                "-0.1708717488877470653852697780135287070494",
                "-0.1502787972324970924646358883722324808409",
                "-0.1339546970463003413216971940993051641505",
                "-0.1207753210705541014844908273682596351531",
                "-0.1099521725754837649803464855984339355007",
                "-0.1009245833424895922409551481156795071546",
                "-0.09328816325702737590607599556856732279031",
                "-0.08674693092113200672865369240920257534941",
                "-0.08108100870921920891824941458385746549316",
                "-0.07612461643936106814805983504536367762187",
                "-0.07175092936699600735201804678313512505739",
                "-0.06786154782791201394751568320599297476539",
                "-0.06437909165961592147715083287078220424309",
                "-0.06124193131542693455912553234986883950406",
                "-0.05840039421954462579218514868348747793896",
                "-0.05581400007134626552787985129936760135235",
                "-0.05344942144108958070164997150037615899521",
                "-0.05127896120354740083167366992649820097819",
                "-0.04927940236999686075781410653586397248230",
                "-0.04743112925805565304956481191193292751055",
                "-0.04571744857819409188102647120382436701616",
                "-0.04412405944327574771795360705185914597234",
                "-0.04263863551361847354609935070699714926884",
                "-0.04125049246191549731618603499665423537351",
                "-0.03995032100892324484552948885100434908547",
                "-0.03872997083712939625871596961054164567158",
                "-0.03758227434280867075032949832767832926400",
                "-0.03650090185196683721825328420416686367272",
                "-0.03548024188859904862952462848525591843703",
                "-0.03451530154306572658076875434427903348025",
                "-0.03360162308334635274863391343045471426391",
                "-0.03273521378075982205028303429273365637258",
                "-0.03191248655448039034252369041072436572296",
                "-0.03113020952617333116562551474110116443286",
                "-0.03038546295382038371127766926071982569759",
                "-0.02967560230898537653979220623082583779525",
                "-0.02899822649405720688592836119040381319221",
                "-0.02835115038002210019304095403918043482549",
                "-0.02773238099201332019194158720309605069423",
                "-0.02714009678753280632360125595378069698844",
                "-0.02657262956712328274064799882331224067691",
                "-0.02602844863420638603281456196053095148472",
                "-0.02550614688350473840306646484054191285743",
                "-0.02500442854881438806654230232663751036964",
                "-0.02452209838313779008621743753028768359005",
                "-0.02405805207909284568772252152123284307488",
                "-0.02361126776647539508109333634677205848876",
                "-0.02318079844797847800778648917526258639796",
                "-0.02276576525424541627218405510829818355782",
                "-0.02236535141636399879062488456342355625863",
                "-0.02197879686816664323264954746960317881366",
                "-0.02160539340274828994494892311169360079971",
                "-0.02124448031782529241163124491710043440623",
                "-0.02089544049324092554901065300444610069897",
                "-0.02055769685132714078587461456428116535033",
                "-0.02023070915716403293191734909648417163841",
                "-0.01991397112120824815544510538634503885091",
                "-0.019607007771430072845752407005332168028045814390609",
                "-0.019309373066123162383604823515850643403303561411216",
                "-0.019020647722028255384184685827261415992403855734673",
                "-0.018740437235424229304901019131820276803170693079729",
                "-0.018468370076454771362002206944263268738217444527295",
                "-0.018204096039234170064238269311646203653795171841985",
                "-0.017947284732259671288603810289814888522791703610216",
                "-0.017697624195391394930945938379586767319927745962326",
                "-0.017454819631178640465396167643705737897382342009287",
                "-0.017218592239642974899011484702174567099568431222503",
                "-0.016988678146798878319687781180477731806699622403467",
                "-0.016764827418223333737973412021153213819352321263501",
                "-0.016546803149894910901223785782819292704838222478444",
                "-0.016334380629326319513388025477684760536255453715998",
                "-0.016127346560725597721304107931757064442388356220699",
                "-0.015925498348551684334977309844344230347621450724070",
                "-0.015728643434390131762044784759869251242793729404741",
                "-0.015536598682572826616336118505794756686561621714435",
                "-0.015349189810409312101899529177498828283493659195924",
                "-0.015166250859293173687036573543524831662975603409904",
                "-0.014987623703300629223821205315626583126159693978254",
                "-0.014813157592214897175613917002439322630250497600893",
                "-0.014642708726193413063349487185671555388111667724944",
                "-0.014476139859549292722667337621265093864056994955066",
                "-0.014313319931346900403490044616847067973976062157061",
                "-0.014154123720716862958926538568310286985810336049129",
                "-0.013998431524980919043103826105237329189568334752766",
                "-0.013846128858843839194556369348113212315780881500528",
                "-0.013697106173060267653267663294256608305964327799537",
                "-0.013551258591120456594381575246670604871259958663602",
                "-0.013408485662622022624712555509143633173103201512388",
                "-0.013268691132106411431971991532869485279168793446910",
                "-0.013131782722239912074249317432024453638555699410345",
                "-0.012997671930310884431575273027735534750822800152971",
                "-0.012866273837098299469522374758739771127030432111525",
                "-0.012737506927242585014676231702889235610737463337885",
                "-0.012611292920318870243018561069150235867966734901893",
                "-0.012487556611875699189387114017092065799873619438563",
                "-0.012366225723759734614632428154067037723538920938119",
                "-0.012247230763099432329468593882829530314827402323022",
                "-0.012130504889368610177986465136745265823697787547905",
                "-0.012015983788994693129617204870045683719750843312535",
                "-0.011903605557016569924513267039485730183675876934097",
                "-0.011793310585333791816453262113755320295259133052255",
                "-0.011685041457122589600011542117071378256187490788479",
                "-0.011578742847025159650989679648367052647045738965882",
                "-0.011474361426747123799662250013118937222434436495354",
                "-0.011371845775724227419391775850183612086355579586226",
                "-0.011271146296543408986216399315787472399597557190016",
                "-0.011172215134825536634791830956441907473254329007241",
                "-0.011075006103297529308637632483693920963010428845301",
                "-0.010979474609800412540585560613224781486838658158759",
                "-0.010885577588997238053817763253974944434554084817628",
                "-0.010793273437560845836056616886835199986162233217062",
                "-0.010702521952636279232564664117975877845631613822496",
                "-0.010613284273386379734477032182952029602068565622427",
                "-0.010525522825441781025316095621480402330250632473609",
                "-0.010439201268088275636186910649092102260607759537213",
                "-0.010354284444035418843087218498568060376977903644195",
                "-0.010270738331620332993683702455882587821166802922271",
                "-0.010188529999310044890247174816582206621395805639842",
                "-0.010107627562374387222340991191223174936035750053657",
                "-0.010028000141609575335580896838491585453497632684720",
                "-0.0099496178240000812702660672102883823116612582097476",
                "-0.0098724516252134122920729843898616302721705179003818",
                "-0.0097964734538289015934046384407553996504603400519779",
                "-0.0097216560772076715819497687791439839826287452122176",
                "-0.0096479730889165692038933244818164851012568232100835",
                "-0.0095753988776241292630177431837082872960003248945844",
                "-0.0095039085973915243157329365757971698878581278115037",
                "-0.0094334781392860347290412086324465056675046247891420",
                "-0.0093640841042488440348536975889611739905016756183542",
                "-0.0092957037771529550066105824999700455769674160364633",
                "-0.0092283151019907513545189499146955388320933349812819",
                "-0.0091618966581342173943202848281295168678308529183941",
                "-0.0090964276376140908198293208618103744206934025306289",
                "-0.0090318878233672777746121826756993519047778099499985",
                "-0.0089682575684047195055976460988023199230638965215482",
                "-0.0089055177758545795874773321691034458781605417100111",
                "-0.0088436498798381325865600390698742424972673335755123",
                "-0.0087826358271380906865929350419955244654420503511011",
                "-0.0087224580596213149511067032757908705332132981290700",
                "-0.0086630994973799324668193487398421247636416967734256",
                "-0.0086045435225568287812513756488779299082434681367857",
                "-0.0085467739638233153163129670358831970583583157055028",
                "-0.0084897750814784916846995245677345776246653297025782",
                "-0.0084335315531414403588640362632229673989600944749174",
                "-0.0083780284600089127149357931861068961819929629558120",
                "-0.0083232512736525973800974690396626636957965417763462",
                "-0.0082691858433314098856610369763447565751460085239619",
                "-0.0082158183837955122885213968184254394561372862813109",
                "-0.0081631354635599677070094466418656650289569652365778",
                "-0.0081111239936270623060142937790479583282155429317411",
                "-0.0080597712166373905165200588732777820122421539302830",
                "-0.0080090646964308022403609703298287993214359494833906",
                "-0.0079589923079992572467232995903555947156630872563009",
                "-0.0079095422278145254289881169595650426303855288769037",
                "-0.0078607029245145153359611854586407145812672258137125",
                "-0.0078124631499328104758433645864475799391890038110423",
                "-0.0077648119304567461645928719975545471334020795742312",
                "-0.0077177385587000718123882438632201478054248038844989",
                "-0.0076712325854769169959083514655722552189343437954911",
                "-0.0076252838120644167694295355817785266083657095357493",
                "-0.0075798822827419545914894516185206856001236993789593",
                "-0.0075350182775955520119594554224247164107801297771468",
                "-0.0074906823055764747713607403882012322465996477007600",
                "-0.0074468650978036369826269017462665848379302718049067",
                "-0.0074035576010998702541782705923892462252850009661427",
                "-0.0073607509717525845253916373658403943879197949423537",
                "-0.0073184365694897834762229440367816508305586974814016",
                "-0.0072766059516628110051668868993971483630189202365921",
                "-0.0072352508676275977218664228703262910161745817080190",
                "-0.0071943632533165488709172434044615610238824643498316",
                "-0.0071539352259935687159700864243475381728327574755952",
                "-0.0071139590791850522231438277641847039352932154542779",
                "-0.0070744272777799938804759662775119170458912092740356",
                "-0.0070353324532926666058190216659941697054553403890115",
                "-0.0069966673992816118031010354597443504481101730838892",
                "-0.0069584250669189555474584956113230354616578480937484",
                "-0.0069205985607043263855029445335860992594065904177337",
                "-0.0068831811343178980540048807420657032309913978149978",
                "-0.0068461661866073162316721048376556700636731688990052",
                "-0.0068095472577034928873253853436835033917983320378552",
                "-0.0067733180252604654788250197797172818616845066050327",
                "-0.0067374723008147217604974641473543752250174919502122",
                "-0.0067020040262595848094299260208591713152491123661101",
                "-0.0066669072704304375887582547123164989238077754661063",
                "-0.0066321762257967424058606380475122137796077590815257",
                "-0.0065978052052569784448602910295974626844209308708742",
                "-0.0065637886390327805801770092330936457615684248473208",
                "-0.0065301210716587153112348541017733426435887678390364",
                "-0.0064967971590642752755271260251778958860466177275551",
                "-0.0064638116657448127546388719683605203674016437656243",
                "-0.0064311594620182652222747165064887184840202215340129",
                "-0.0063988355213646526129413593015233647053710880271981",
                "-0.0063668349178454469152773208617311900113184712884318",
                "-0.0063351528236000301992244938520771224245847233407337",
                "-0.0063037845064165675399229718537584984720688059545740",
                "-0.0062727253273747267574347709013486374584417078953591",
                "-0.0062419707385577776905002286147165330777690818109813",
                "-0.0062115162808317000919282733540924792603999010720598",
                "-0.0061813575816890213881851324733900644172888602851948",
                "-0.0061514903531551936900893862318753560644835033957734",
                "-0.0061219103897554037682673975247591050593173165572511",
                "-0.0060926135665397903990240822466381484181900643557176",
                "-0.0060635958371651207168028662713556432755161290006136",
                "-0.0060348532320310511426657594574667416660190428042759",
                "-0.0060063818564691692499096275554116230356185841785091",
                "-0.0059781778889830807256885937098875099469329773313554",
                "-0.0059502375795378705313783562223738221564579867689874",
                "-0.0059225572478973295872665805489112386454147886966308",
                "-0.0058951332820073979350810872249813373984660210577269",
                "-0.0058679621364243324845721783789074370229463052831820",
                "-0.0058410403307861622414988105199589737098231482350664",
                "-0.0058143644483260464518676139227583751401495562167543",
                "-0.0057879311344262014836737113712114395569304648182614",
                "-0.0057617370952111106001188557868297436605310088695299",
                "-0.0057357790961787771499292201327006329063232727144826",
                "-0.0057100539608688261989838655548148044185446127030233",
                "-0.00568455856956630233669031028726918132355377231442",
                "-0.00565928985804005239000475293196546276741479461051",
                "-0.00563424481631462114341231300437394205505947568788",
                "-0.00560942048747462596660522173670757913624935135720",
                "-0.0055848139665006125615929596633020076241407419378",
                "-0.0055604223991354289228197904451501716275587561385",
                "-0.0055362429807801881196992279305730559868965134574",
                "-0.0055122729554189227199867751319047647446777555269",
                "-0.005488509614571064630978073837557567603175452768",
                "-0.005464950296270913897351694797237037884957157445",
                "-0.005441592384073288610759232867329901824324354651",
                "-0.005418433306084575605787138099238985097238719797",
                "-0.005395470534018428086185792678096329888858803850",
                "-0.00537270158227538178863205874980760479872371114",
                "-0.00535012400704568579106058620915691799167756782",
                "-0.00532773540543466764911679168103291585369113522",
                "-0.00530553341460997523604982295720443701264499903",
                "-0.00528351571097005950511749475744682267844854840",
                "-0.0052616800093332834243861653386393295650164740",
                "-0.0052400240621470625851570347073238916801578138",
                "-0.0052185456587164624891059818480415545630323924",
                "-0.0051972426244516963061198569040870176336235979",
                "-0.005176112820133984993914718616260228337387496",
                "-0.005155154141199259109697492919853578584904881",
                "-0.005134364517039198450011539811137000868342157",
                "-0.005113741910319121852940913378072556976961153",
                "-0.005093284316312255111369153702326828167978519",
                "-0.00507298976224992000026056684671252915582408",
                "-0.00505285630668720193720313676564428319469438",
                "-0.00503288203888366779500242066225491024948249",
                "-0.00501306507819871888830267384384625087162273",
                "-0.0049934035735011771825138527776561993097600",
                "-0.0049738957025927153413822614828530408349274"
            };

            ddouble[] n1_expecteds = {
                "0",
                "-0.2039521227673736530701464124115482324600",
                "-0.3383947229366763903815206737420714225927",
                "-0.4278095201309166328484066164576559244428",
                "-0.4878770672696132457925327748177573331426",
                "-0.5286854730527568223359174734534145417132",
                "-0.5567572699278333987271815789871513775916",
                "-0.5763331380146807223931136385509240117906",
                "-0.5901873419657651750610765438602295181014",
                "-0.6001473858668084496666267880414942881853",
                "-0.6074263620422447533159550100159275150274",
                "-0.6128363498885194520745875595119991917126",
                "-0.6169260385456033718114462623118511662259",
                "-0.6200699107737552555845042556622706218139",
                "-0.6225263456888438046319950593828635136387",
                "-0.6244756948484733901745996811348985221479",
                "-0.6260453953031214947643372732450375974806",
                "-0.6273266495737618091200861019611432565302",
                "-0.6283855892632094595285278851926927702865",
                "-0.6292708084933370299373730261077321528788",
                "-0.6300184927716849625962145949218369639215",
                "-0.6306559438084015528451020071646821184513",
                "-0.6312040261211634664659759265198440100731",
                "-0.6316788829582310732708413827748610463377",
                "-0.6320931527490976469829427343668519872382",
                "-0.6324568410009903159600617760966764557520",
                "-0.6327779522315966753970694409674150835441",
                "-0.6330629531203968049674974615807791699369",
                "-0.6333171157359904065913927553327812638136",
                "-0.6335447746716194322663517997112809836052",
                "-0.6337495217324100521914933563964703231671",
                "-0.6339343548539339315184706673930037162156",
                "-0.6341017931323535921477488741335138861447",
                "-0.6342539665103871375288325547902067358496",
                "-0.6343926863239208943418082921557634276766",
                "-0.6345195012587664164607591125219579057575",
                "-0.6346357420850686451232622285037697511070",
                "-0.6347425576851356663302790550145445976343",
                "-0.6348409442711016812421383674840233279897",
                "-0.6349317692343928422660258967827705137729",
                "-0.6350157907325777068989286991990657809750",
                "-0.6350936738680345331002031358439939391304",
                "-0.6351660041237899776945773043008211258751",
                "-0.6352332985783890983537331739968747478011",
                "-0.6352960153119124908933914593807450753644",
                "-0.6353545613307026916609856739415608133236",
                "-0.6354092992727557991673213940334249535964",
                "-0.6354605531044868086087512897276930363359",
                "-0.6355086129792893523107107272536195667476",
                "-0.6355537393964457404120094606946986421991",
                "-0.6355961667735945933684584683773691842453",
                "-0.6356361065256875736924056037985055001296",
                "-0.6356737497270638272276799349610126971128",
                "-0.6357092694200971170637553380097412430253",
                "-0.6357428226231752459876568291094354260768",
                "-0.6357745520820488383536432300154057985507",
                "-0.6358045878014423611931894591212600810837",
                "-0.6358330483879447523627920262322254102360",
                "-0.6358600422303458969432798069909369035254",
                "-0.6358856685395647733276483023581718679959",
                "-0.6359100182669711031159430486184206464044",
                "-0.6359331749171113428237331267673609290267",
                "-0.6359552152685126534001810694626695104656",
                "-0.6359762100142750309851518104545384514531",
                "-0.6359962243325072325268876790772855261507",
                "-0.63601531839526374804117132495398963972739973779497",
                "-0.63603354782345481498081573213804194575953907574694",
                "-0.63605096409419408390777859542950876980915290943676",
                "-0.63606761490619005293387085369982864287695848216476",
                "-0.63608354450805389904301499113794735881212392142355",
                "-0.63609879399376808447008709330177537517023916974991",
                "-0.63611340156902070848630441088845030961447100033633",
                "-0.63612740279164636425614021975479030708681277043318",
                "-0.63614083078901385984768771503868806786877228279690",
                "-0.63615371645485504300564627760078749791699819221385",
                "-0.63616608862772913547356729667122546381343188914111",
                "-0.63617797425305670836130235476951220745700921649000",
                "-0.63618939853043104277490309151827994021528783734324",
                "-0.63620038504771732403040059140501902773449822567626",
                "-0.63621095590327784936660367012364830870048851998020",
                "-0.63622113181751073642644434091040603296792755063285",
                "-0.63623093223475756456162582158213809728880085869792",
                "-0.63624037541651945650464029858152579435769441140087",
                "-0.63624947852681917110568336008643004171883743928125",
                "-0.63625825771045699276372693859560331827193118162118",
                "-0.63626672816482899398760830837075240112639483248936",
                "-0.63627490420590625882987842885261258766520798707085",
                "-0.63628279932891171882326637509440422635337425908924",
                "-0.63629042626417636126275637777361362466585315676294",
                "-0.63629779702860785022846649174709703008760132738702",
                "-0.63630492297316129817196779003800433787163012564866",
                "-0.63631181482666338455596416851329248168751768592570",
                "-0.63631848273630666799227787275077396942744783034229",
                "-0.63632493630510028328878926679396434901207405932259",
                "-0.63633118462653582197632472290822637268306337631924",
                "-0.63633723631670268618235720268733191019179817677725",
                "-0.63634309954406525041654772431787229319705053551387",
                "-0.63634878205709447417072867381580451681888982789284",
                "-0.63635429120992892597516197967937731408660628696953",
                "-0.63635963398622428330791217920413112849683006410875",
                "-0.63636481702133606597346626956139613011714639012218",
                "-0.63636984662296747007385806630453985888482921608152",
                "-0.63637472879040254270555947955864646910160821413899",
                "-0.63637946923243443905761720718359529263446657275606",
                "-0.63638407338408901427493475380816676774023687286750",
                "-0.63638854642223541655206415375233887787505664819813",
                "-0.63639289328016757168081371855575796523149345211613",
                "-0.63639711866123339945284716474007603874569563000009",
                "-0.63640122705158220493222321570283475320613859240807",
                "-0.63640522273209487682654333589044891857703724230450",
                "-0.63640910978955624234742650422834741120957994441980",
                "-0.63641289212712412075213197239394745777453766887773",
                "-0.63641657347414523949470637931058354020638940972110",
                "-0.63642015739536418584384432096928995980391088951511",
                "-0.63642364729956792559696708026842862475089275864626",
                "-0.63642704644770509568453290297963135779307508620085",
                "-0.63643035796051623902446511339556489932008783755168",
                "-0.63643358482570837103883722705775115694780623733245",
                "-0.63643672990470472360547878736248748762793757546101",
                "-0.63643979593899818214566622884885983786553619331609",
                "-0.63644278555613479547890490087713419721716536287486",
                "-0.63644570127535177838044586825488564889777769760199",
                "-0.63644854551289262756340262108154703009218026112724",
                "-0.63645132058702031873204916159634116251944563830616",
                "-0.63645402872274803246060707088818149952711726265029",
                "-0.63645667205630545823037442746686295513664529445311",
                "-0.63645925263935743841024697382212120975349022037547",
                "-0.63646177244299052769526175182297243701461336026286",
                "-0.63646423336148194982774097013222689514479074625737",
                "-0.63646663721586442442756114377449752198429750514362",
                "-0.63646898575729940529144857716012941262942939583640",
                "-0.63647128067027041108102471130879673205063447598326",
                "-0.63647352357560733399165058327728018051013831756883",
                "-0.63647571603335187639829008866801068288602309738676",
                "-0.63647785954547358471153228703666095248362256891888",
                "-0.63647995555844531928269573904069997496717199988126",
                "-0.63648200546568641510131606040328279343167485446390",
                "-0.63648401060988124651730952629595885415602674102295",
                "-0.63648597228518040690246425183498282579848344095188",
                "-0.63648789173929124794295470050126192234328019477372",
                "-0.63648977017546409029303421124562659206804552099191",
                "-0.63649160875438001502761510295334668656826129602293",
                "-0.63649340859594577133468212770118372084499554136152",
                "-0.63649517078100098801300231491066808934243584388131",
                "-0.63649689635294255259304984494492375861080097538819",
                "-0.63649858631927072045094978598602339988065942971628",
                "-0.63650024165306123545821619384792217789894646655882",
                "-0.63650186329436748196266874955149514594467435613866",
                "-0.63650345215155644381158503066832912835912894514954",
                "-0.63650500910258201840429829096860086688131867026413",
                "-0.63650653499619902119961472602568187887174720115738",
                "-0.63650803065312101760028935388986423090013676796983",
                "-0.63650949686712493367608087433399266841373137332514",
                "-0.63651093440610522383195441438413900308347526794150",
                "-0.63651234401308021141508662010282314720293826607128",
                "-0.63651372640715306658652700737172661739474385848276",
                "-0.63651508228442974382500379873057882413931143014276",
                "-0.63651641231889606850192935157555916257432929703181",
                "-0.63651771716325603744021558844688735818027027810631",
                "-0.63651899744973328166445544468676164076890872434903",
                "-0.63652025379083753012926632219275742326662806768273",
                "-0.63652148678009781057902237531860313202630141555765",
                "-0.63652269699276402738550642622884620330601012690069",
                "-0.63652388498647846580372604758932251422063103330529",
                "-0.63652505130191868718497152932334404558655753573033",
                "-0.63652619646341319992357478864855714563329399593036",
                "-0.63652732097953121594965841422964786884141759037568",
                "-0.63652842534364773209875657913004899050493302106317",
                "-0.63652951003448510939738368575695247858645538154030",
                "-0.63653057551663226092905583742623425834217962599949",
                "-0.63653162224104250023477369220100778683393465665716",
                "-0.63653265064551104692013891917060831808169887179755",
                "-0.63653366115513313406909305292155833207905434238562",
                "-0.63653465418274361299790472278451186100904388788593",
                "-0.63653563012933890463269898333110407082057213639887",
                "-0.63653658938448210318273085511839526617468458230020",
                "-0.63653753232669199664500502816884818752101181220871",
                "-0.63653845932381672986014306264882659302938676492414",
                "-0.63653937073339279920134958711189821814330522553657",
                "-0.63654026690299003338427389624235497018486788193934",
                "-0.63654114817054318221074750521178931315987307382006",
                "-0.63654201486467070418730806215055027369551679866613",
                "-0.63654286730498131478127434449062663437520170113126",
                "-0.63654370580236882949122251745298244134169275384502",
                "-0.63654453065929580981996181665055298283842531566802",
                "-0.63654534217006649555760942609389130843063438955553",
                "-0.63654614062108948342694025543019905126725368522957",
                "-0.63654692629113059003498995972189644750503331296069",
                "-0.63654769945155631614103465049238191536132535712093",
                "-0.63654846036656830942329640002018131101439595543865",
                "-0.63654920929342920414107430225546812253469047326190",
                "-0.63654994648268019828553455519805312796372203618718",
                "-0.63655067217835071193490989928859784063190859376201",
                "-0.63655138661816045452564920817006627492038539469608",
                "-0.63655209003371421357066915576632167741159839923969",
                "-0.63655278265068966295287851404310385785405655266626",
                "-0.63655346468901847525299696070573105001049523228108",
                "-0.63655413636306100959445073310942420998999624315682",
                "-0.63655479788177483416635084661206517018398802475305",
                "-0.63655544944887733088211538173800850435789975155203",
                "-0.63655609126300261851222033814230619436619312146852",
                "-0.63655672351785302006291398261797434233115664791030",
                "-0.63655734640234529012846292397449853889576034954032",
                "-0.63655796010075180839434374217888974181307349558116",
                "-0.63655856479283693638614233924572887375167786393196",
                "-0.63655916065398872591872054225839669209164097129019",
                "-0.63655974785534615947885989367023702716755084363433",
                "-0.63656032656392209494986631965068310444587857235717",
                "-0.63656089694272207963756777021941282745295570949502",
                "-0.63656145915085919146401266546294514444306562968052",
                "-0.63656201334366505843935985147019328396461922932857",
                "-0.63656255967279720108637829189334119445453607887875",
                "-0.63656309828634283635907736167867911709159790528787",
                "-0.63656362932891927575162923811191154788752829632488",
                "-0.63656415294177104472116219399393978464260991839447",
                "-0.63656466926286384523425920521928409531141526492475",
                "-0.63656517842697547817892525601409676019341682813482",
                "-0.63656568056578383754895128858309146704427552937523",
                "-0.63656617580795208369424897589265552044094965569573",
                "-0.63656666427921109852774776986843591081714362909640",
                "-0.63656714610243932137632869061790542091080355988323",
                "-0.63656762139774006015008252982830268125405498869748",
                "-0.63656809028251636867152442584251807838324290923313",
                "-0.63656855287154357734537820208971964458822542282891",
                "-0.63656900927703956085174442060619794363438912851888",
                "-0.63656945960873282320291620059802025950738539738934",
                "-0.63656990397392847730925956980183417930232521833309",
                "-0.63657034247757219314528202490194112531436573856462",
                "-0.6365707752223121856865014409861987381991166653069",
                "-0.6365712023085593109945793368091387019051027917685",
                "-0.6365716238345453361563140893628700944033052082402",
                "-0.6365720398963794462257329813685313058170477938573",
                "-0.636572450588103048872206939772368259581690634615",
                "-0.636572856001742935096049852272208512411768266328",
                "-0.636573256227362852131532575808480222748729116245",
                "-0.636573651353113542510968406326498097156048308737",
                "-0.636574041465281301208077364416673539723045886802",
                "-0.63657442664833510081000093837406961379252979420",
                "-0.63657480698497233278111871999535278281646251768",
                "-0.63657518255616321107441598708458118247848984286",
                "-0.63657555344119388261395871172063090882563680090",
                "-0.6365759197177082875116211302177743305307476717",
                "-0.6365762814617488102893221395006005497724410381",
                "-0.6365766387477957618515623652991496638054826804",
                "-0.6365769916488057304890679452928767629608320405",
                "-0.6365773402362488387900381690291486932402747558",
                "-0.636577684580144941988196911073555667512964883",
                "-0.636578024749098801984026413402713619949485991",
                "-0.636578360810334270034803108285642107551863378",
                "-0.636578692829727509918061684479319696772979351",
                "-0.636579020871839292229698483762490506507202118",
                "-0.63657934499994638938000600548027143306531806",
                "-0.63657966527607209979652328343894822525539139",
                "-0.63657998176101592882980264316844046588497969",
                "-0.63658029451438245288523147631738705627593334",
                "-0.6365806035946093923691924370279421920883909",
                "-0.6365809090589949181394614602448715982764214"
            };

            ddouble[] n2_expecteds = {
                "0",
                "-0.02653747567224501724766612701108723952069",
                "-0.09123983672995844712185495108227643019044",
                "-0.1784578717316108146236684140922602157184",
                "-0.2786876586533959225335070420007878898820",
                "-0.3861955488435961862764121738795423215108",
                "-0.4975551131936728802697137777916358682444",
                "-0.6107467631612451991716396391824770564594",
                "-0.7246044410616396019554449107368238788492",
                "-0.8384762842875097961149932294777656360764",
                "-0.9520171061753713451212069459096965717026",
                "-1.065061988633476460004939918944153129450",
                "-1.177549704462111993860934505141265109701",
                "-1.289476681695709090263228505858310453459",
                "-1.400869628584571327473183008174073697882",
                "-1.511769509880492460370931411165039923121",
                "-1.622222386196989083428591905579417927824",
                "-1.732274367659564251774996737119473132084",
                "-1.841969004411249045572283677210486853852",
                "-1.951346095379287243173578855866740054666",
                "-2.060441300997216739209691425519939638585",
                "-2.169286192924170863353002599152749504472",
                "-2.277908524515010132257151388476756785946",
                "-2.386332597110860647618154127456206187967",
                "-2.494579652119898678506633063066130620340",
                "-2.602668251508311213092793175292936001966",
                "-2.710614628440039602485583526895228542586",
                "-2.818433000746186985042435891642261196733",
                "-2.926135845950336968149038708157504658734",
                "-3.033734139724982892270439450684431388946",
                "-3.141237561120537181964908837304421680202",
                "-3.248654668422943757204067166106939818552",
                "-3.355993049494479542229914498197954836719",
                "-3.463259450190901069534300272316135581842",
                "-3.570459884073935784138148727851051308593",
                "-3.677599726233284700420501959560325836200",
                "-3.784683793640190590957928035147403968252",
                "-3.891716414096108981889240785459322169325",
                "-3.998701485523175383675218546851623114436",
                "-4.105642527069075183603719764359361375548",
                "-4.212542723265098240156197843757867441878",
                "-4.319404962278496131635420432044071553785",
                "-4.426231869134147882602444252805329474484",
                "-4.533025834641452682687756228429241448879",
                "-4.639789040646146526631361954113181607837",
                "-4.746523482129708600667466239753139223564",
                "-4.853230986598013257756493977522514026685",
                "-4.959913231133204804363483887890207186579",
                "-5.066571757426166581319035866139303528551",
                "-5.173207985059540083156867066630446480621",
                "-5.279823223271461696563048566454164445933",
                "-5.386418681396731288624872170419694015610",
                "-5.492995478153940417723340726626605103571",
                "-5.599554649923286751001080499953112031712",
                "-5.706097158139657464539600904489923504613",
                "-5.812623895908476631592653456711789984737",
                "-5.919135693937282544891950069173506265148",
                "-6.025633325863618705210818978597409635657",
                "-6.132117513049245196621905882448829528960",
                "-6.238588928901621455724818872101224256551",
                "-6.345048202775840649625918909909780206024",
                "-6.451495923503512798107197371567525614973",
                "-6.557932642589333536218004721953197193282",
                "-6.664358877111099879289470216427513507152",
                "-6.770775112354627538928221862671294140270",
                "-6.8771818042112886485922844305863500322047391972281",
                "-6.9835793813626418868217137008678133640856165148551",
                "-7.0899682472737993774048069963410914513539404952599",
                "-7.1963487820147074869295607908211088865098339382845",
                "-7.3027213439263617298296109747675791478994699067666",
                "-7.4090862711470869011186184404117387914426602109823",
                "-7.5154438830123560408663054506232815285042400432874",
                "-7.6217944813401649360453587902738989056913900320357",
                "-7.7281383516126960939201491240080610518190519169327",
                "-7.8344757640638747623978728411191468329842443854699",
                "-7.9408069746814201128719523606503971421262988753388",
                "-8.0471322261311103438336295796617311249272195010700",
                "-8.1534517486101967249017641709475636464798989373798",
                "-8.2597657606362059680066052289815075336238237898774",
                "-8.3660744697767519558428563879918435083652551743330",
                "-8.4723780733254273885207891393329232372037395126834",
                "-8.5786767589283551736737864848222058827189824582191",
                "-8.6849707051655412897947636235895135823252648045634",
                "-8.7912600820907792164007440730548711961957785979133",
                "-8.8975450517335054532795879443759670428178618990840",
                "-9.0038257685656914289591901505406599265944935879380",
                "-9.1101023799365750971266607645218234007765473346086",
                "-9.2163750264777821189770782742814170027498343731271",
                "-9.3226438424811585505003894989099737139160295530878",
                "-9.4289089562514316009574787391726798731756932602532",
                "-9.5351704904356298402843093280285940384813166304477",
                "-9.6414285623310270376862588405866415571546615234793",
                "-9.7476832841732226938313571370905546358165182334220",
                "-9.8539347634058355892686291959689012759903301461026",
                "-9.9601831029331628106511119640558021275690404516051",
                "-10.066428401357044402955111300918393639487822596228",
                "-10.172670753199071848539843358860543976601375681856",
                "-10.278910249109185942345060022099328957290222144803",
                "-10.385146976061625382176532358412440766685726201306",
                "-10.491381017539110691193308851114217720815636543341",
                "-10.597612453706078193634655139088057526036694657097",
                "-10.703841361571715011219521014964805469928784364617",
                "-10.810067815143487843524245396698709999080321364529",
                "-10.916291885571805110263448883661531730718850132744",
                "-11.022513641286403391243553056153767601842225524705",
                "-11.128733148125004574321676028688851984316823212306",
                "-11.234950469454749330042152317714302438611572345370",
                "-11.341165666286875129558364506064261273486194944239",
                "-11.447378797385072700326742624353202914435385530350",
                "-11.553589919367923293019881466358664294586174203868",
                "-11.659799086805790161768619848024450059614950186196",
                "-11.766006352312511011390677605438859296861654071059",
                "-11.872211766632213634847425641736830374699590458812",
                "-11.978415378721554366613435918948944693987749481218",
                "-12.084617235827658145399888826907237680872857834803",
                "-12.190817383562019761015191679924996238406316889137",
                "-12.297015865970608117551810441418856196083209152747",
                "-12.403212725600398953803201315641454117927609658135",
                "-12.509408003562546308572241071546242273670051961112",
                "-12.615601739592389000410654164090428100494314113378",
                "-12.721793972106475414729214605288196519118268046096",
                "-12.827984738256777870953384989987615171769022021457",
                "-12.934174073982256700874905589938788727071232271199",
                "-13.040362014057923835835229013041612701267077126287",
                "-13.146548592141546110346334794877666145050676530499",
                "-13.252733840818119584300522140847172761595326967922",
                "-13.358917791642237911224124829599187642663868524938",
                "-13.465100475178470086884949132661831798743324120801",
                "-13.571281921039855755949563636348215185445609650575",
                "-13.677462157924619593084989467177275136647039663823",
                "-13.783641213651200071144106738607585870966313861276",
                "-13.889819115191682148240108114671592770145774667330",
                "-13.995995888703718015835614483588011247754610547838",
                "-14.102171559561015022282542303406257088951341352056",
                "-14.208346152382465193757562097743199751857289289514",
                "-14.314519691059986392616500038409385015436512089582",
                "-14.420692198785141059185178163155656975111950491739",
                "-14.526863698074594656062939037881703903970334474219",
                "-14.633034210794472354935232013466162271341555136119",
                "-14.739203758183669156976792533832169887773035333411",
                "-14.845372360876165502859655781975180547387363799612",
                "-14.951540038922397492105640121168550186361906174914",
                "-15.057706811809728080142987842705245952494774335312",
                "-15.163872698482063042104148956015640418869352526248",
                "-15.270037717358653073271816604916116226732871075343",
                "-15.376201886352121126171997193392332634236614901454",
                "-15.482365222885751953475202606862222870803296082623",
                "-15.588527743910078824702797717081583069557158425430",
                "-15.694689465918800504541433550097277079604861966461",
                "-15.800850404964059813278561919552123672788786427841",
                "-15.907010576671113428007752802458485930967383311717",
                "-16.013169996252421019876378175483358876283346681320",
                "-16.119328678521180351321225195434211564750735361849",
                "-16.225486637904333571980569322202555329692158178076",
                "-16.331643888455068647229197021486880129415091154776",
                "-16.437800443864838623892449366626714420847640622899",
                "-16.543956317474920278854895098954370115993803418907",
                "-16.650111522287532603521319207832776853495730753438",
                "-16.756266070976534546253958773222506514835739937036",
                "-16.862419975897720462127839750843099309797582077862",
                "-16.968573249098730801007759734603735276143026264546",
                "-17.074725902328594697693012531564257214485750616848",
                "-17.180877947046920308563419816696886969776834641662",
                "-17.287029394432747964867051351329998294901293467935",
                "-17.393180255393080480785681776433352177236277228440",
                "-17.499330540571104262149030704811956162004875677858",
                "-17.605480260354114206761623343464077769309382104766",
                "-17.711629424881154767531133077383266545913816655361",
                "-17.817778044050388962863676099679249412540878894178",
                "-17.923926127526206563173753659200828221405450205663",
                "-18.030073684746082156023643561221373844304953192639",
                "-18.136220724927193293654787881320024130027576696233",
                "-18.242367257072808453906281748479736286670943270467",
                "-18.348513289978454097238049539636650684034503509928",
                "-18.454658832237869677387826874941985484280278243917",
                "-18.560803892248759059778381622718604636775508609028",
                "-18.666948478218346418922902120059689129100628807402",
                "-18.773092598168744322596712212600730821360642994720",
                "-18.879236259942141365368048967218630899187662661174",
                "-18.985379471205816386191482817862056376654147226174",
                "-19.091522239456985993208510959752306709777495963155",
                "-19.197664572027491822772585590631149650253371927170",
                "-19.303806476088333678176061225511839472144777188835",
                "-19.409947958654054425810485878042709467242965387908",
                "-19.516089026586982271792781646852219878758084903080",
                "-19.622229686601335799735810808193383515046478133418",
                "-19.728369945267196919671604133880400023599739053936",
                "-19.834509809014356658526849027465335365416715095033",
                "-19.940649284136038513417057376996714871414073750960",
                "-20.046788376792503889816078180300668090804723417037",
                "-20.152927093014543956851034880176072015907477422510",
                "-20.259065438706862071078934046201001045560247580145",
                "-20.365203419651350747657671726827504765843944318157",
                "-20.471341041510266993394764977087514815955802733351",
                "-20.577478309829309659330298326598566496154879891144",
                "-20.683615230040602320897859917881602379269926169428",
                "-20.789751807465585050941923969407073629272913214230",
                "-20.895888047317818314605885126876155210504134009527",
                "-21.002023954705702085014601161544807432887562388067",
                "-21.108159534635113154449702568763879143266473374320",
                "-21.214294792011963497062868030434133337385280707587",
                "-21.320429731644682425815461442831330503851507468524",
                "-21.426564358246625178011085688382567202170804194391",
                "-21.532698676438410460253542956007657362014005255826",
                "-21.638832690750189384682493177879694693808365650279",
                "-21.744966405623848133691368378968289826725820279657",
                "-21.851099825415146599807208508246846521152965952778",
                "-21.957232954395795160811510252032080831709849329156",
                "-22.063365796755471667316862692163043983566190326359",
                "-22.169498356603780640707884024454045412088280628345",
                "-22.275630637972156603437875265062029313167207118773",
                "-22.381762644815713390984548095496493171269338700111",
                "-22.487894381015041225157322825178724241193495095900",
                "-22.594025850377953261771002161844261913246070685691",
                "-22.700157056641183261819458899037651345590284394307",
                "-22.806288003472035974068650787256386216850154735249",
                "-22.912418694469991758317696248866788419245962103459",
                "-23.018549133168266922333032472439829848815279961492",
                "-23.124679323035331191532833601529184075248093809505",
                "-23.230809267476383678781449618458376950695145621920",
                "-23.336938969834788672046449999510568075745966926875",
                "-23.443068433393472510078705256082468175146260202467",
                "-23.549197661376282770608302335736132194576022141235",
                "-23.655326656949310951719905837271491610828453044662",
                "-23.761455423222179784998598775929065138999865825594",
                "-23.867583963249296278643406304131821629989563693059",
                "-23.973712280031071549956543701192375565052837984625",
                "-24.079840376515108469361435620188633906659846681544",
                "-24.185968255597358102314617949461165760753250461762",
                "-24.292095920123245901091861883595574705070550504391",
                "-24.398223372888768565386404149292406479339057175546",
                "-24.504350616641562458899069313176717707561124709620",
                "-24.610477654081944438571111516721404730204514040488",
                "-24.716604487863925923758165230181497265107586908534",
                "-24.822731120596201004417625762128143366845349959970",
                "-24.928857554843109360234269469472704672388295872036",
                "-25.034983793125574736494382461065271094388650198877",
                "-25.14110983792201969739361686674000390136921221418",
                "-25.24723569166925735328676137095070147368644899139",
                "-25.35336135676336073511902739608517625386066041077",
                "-25.45948683556051046688055265069749184737909437082",
                "-25.5656121303778213653625673803942380131079539377",
                "-25.6717372434941485757306472818976682411007190826",
                "-25.7778621771508738314348359625312077484427770874",
                "-25.8839869335526724077167817427066694166008041863",
                "-25.9901115148682613194204264349204127018757966238",
                "-26.096235923231129295936572287138313883817826879",
                "-26.202360160740249048885474445992221815131872792",
                "-26.308484229460772331539307679094495790981500413",
                "-26.414608131424708272982937814990889270010146212",
                "-26.520731868631585454582987873381187319140470909",
                "-26.62685544304909818145886864174417785169128287",
                "-26.73297885661373738730338136297601030775763881",
                "-26.83910211123140659706378237811221843243240103",
                "-26.94522520877802335864681576802555821590454374",
                "-27.0513481511001065419340211957203457107821995",
                "-27.1574709400153498909682821250756447093263046"
            };

            ddouble[] n4_expecteds = {
                "0",
                "-0.0001435932071565453561259974073124989400597",
                "-0.002042717132990120842040808955983596598512",
                "-0.009261337988773567016992864632939053750594",
                "-0.02639095447982522441656369274039212442739",
                "-0.05845663388255504856805255285380056050251",
                "-0.1106127088602713543490828815901174534689",
                "-0.1879975774051561177534862837213030209955",
                "-0.2956733627889897215364675033091823284819",
                "-0.4386088665367575310220627785145490801651",
                "-0.6216830303078492356829864634243219473451",
                "-0.8496967897724544097293775431451420530876",
                "-1.127387165984269681283261132679380510581",
                "-1.459440700743614616874740618868650471056",
                "-1.850505071344509397741342897804756993605",
                "-2.305198594139154874572352009704203756123",
                "-2.828117733940607596081957766802208222859",
                "-3.423842897383491675627609738860483703426",
                "-4.096942825478463051956285895118033258577",
                "-4.851977880407335055869282057394848929442",
                "-5.693502479223034721765244144255749829873",
                "-6.626066880106163442689158690045892854633",
                "-7.654218483227089892487631015993872781619",
                "-8.782502771111828928359059510803556626179",
                "-10.01546398326932881499917106803020560174",
                "-11.35764559614000870737966891892474811236",
                "-12.81359066118854914265771014599893017770",
                "-14.38784204014238273596158033936768464979",
                "-16.08494256601867843584033094363545884714",
                "-17.90943515088389854571839867380534096676",
                "-19.86586285560434271518688959767933086481",
                "-21.95876893266745992633556861734335385359",
                "-24.19269685009422600883601099412734256130",
                "-26.57219030222949252911148289512632618031",
                "-29.10179321157082583569731782592221713276",
                "-31.78604972461446276231247679955587992877",
                "-34.62950420383977026843514575379440425069",
                "-37.63670121733301674643922952851464841646",
                "-40.81218552710294092119977830814040609147",
                "-44.16050207681751469949686887837989555925",
                "-47.68619597945915859793237665689801336045",
                "-51.39381250522952173578138786393088030678",
                "-55.28789706991662208042230007397727539037",
                "-59.37299522385345015954038902684168993207",
                "-63.65365264153847034551203906556163311792",
                "-68.13441511194783100054239394950594271309",
                "-72.81982852954144928015326993908522924654",
                "-77.71443888594678713978099846941436751695",
                "-82.82279226229241063990162511235385776326",
                "-88.14943482215638824003928279663696816484",
                "-93.69891280509083336450191011916293391462",
                "-99.47577252068241930258102508999357168775",
                "-105.4845603431087610040925492471392843379",
                "-111.7298227061516452864325269603847350547",
                "-118.2161060986298251099846912194097906031",
                "-124.9479570602162106224290677322974781142",
                "-131.9299221776066044109237261724535609941",
                "-139.1665480810095128650096276797488465572",
                "-146.6623814409289330738366025812279077713",
                "-154.4219689652143082593095509043754810652",
                "-162.4498573963540285678905860123939636924",
                "-170.7505935089909072990386128425078964745",
                "-179.3287241076399750389879781333273723325",
                "-188.1887960245907026460631242981110348982",
                "-197.3353561179773904424931893929560448966",
                "-206.77295127000295035016510354157227185685110570397",
                "-216.50612838530266709285434676693125866995773015742",
                "-226.53943438943576213251483213140530748871138953484",
                "-236.87741622749370839740495469846968074197764798794",
                "-247.52462086281526389500314442317290959051211669692",
                "-258.48559527579911661952756995072018208716479608090",
                "-269.76488646280587005586560151099584982312755637800",
                "-281.36704143514185588866762523155939594917783576460",
                "-293.29660721811794557253093566023493814240294976403",
                "-305.55813085017715199087272963147603262365935971220",
                "-318.15615938208537276783634983864198461558687437115",
                "-331.09523987618013360936479911024333986179573924742",
                "-344.37991940567264853908003672065710398539629796180",
                "-358.01474505399892878661963875337822433972324699928",
                "-372.00426391421604766021965128101729871023852505957",
                "-386.35302308844000886000220131100426254224613495069",
                "-401.06556968732197385470902643742444804961649137704",
                "-416.14645082955988329915052876000052461245567543790",
                "-431.60021364144276084590497272438259971482085581533",
                "-447.43140525642521765254160836777137585350750756417",
                "-463.64457281472988469813869721208282465752090321504",
                "-480.24426346297568976210501010689485003058936934087",
                "-497.23502435383006843799848891558020566180907564001",
                "-514.62140264568335552157426445026174565527872441141",
                "-532.40794550234374602381847678678610983121520136766",
                "-550.59920009275134526330002446728427569761295568422",
                "-569.19971359070994619931833633921107744802455891278",
                "-588.21403317463528046798303351557297187886930145962",
                "-607.64670602731858845844834326800390635812159601024",
                "-627.50227933570444409920053795931235892182816658609",
                "-647.78530029068185261006176627847429351326518440965",
                "-668.50031608688771503132000747818015478746002758697",
                "-689.65187392252182251350555220170828753675297833606",
                "-711.24452099917260672293411140969908472065750199762",
                "-733.28280452165293081557877413252680526675090818426",
                "-755.77127169784525873050299924681936749639032122574",
                "-778.71446973855558948359367737345832315902455175786",
                "-802.11694585737558809115430579854252407461729628381",
                "-825.98324727055238607255482916111019992329232795595",
                "-850.31792119686556248983143629007461059506726969824",
                "-875.12551485751085146820417235035369511417437461792",
                "-900.41057547599015436630461357720186294088164294847",
                "-926.17765027800746446557728620563650733120820519109",
                "-952.43128649137033944005298743584584944934783825770",
                "-979.17603134589658214597038343307548040920789772557",
                "-1006.4164320733258136132144623036104144618932382559",
                "-1034.1570359072356436888337713797080744467838375044",
                "-1062.4023900829621647240478980188433025871454158988",
                "-1091.1570418375245121440785394147973293870515059299",
                "-1120.4255384095532528168613954861510349153693342594",
                "-1150.2124270392223779534913706391554522312821720955",
                "-1180.5222549681846919316427021846240559010472148966",
                "-1211.3595694395104020258767789379795951147153296481",
                "-1242.7289176976287266403793446398969025583757990139",
                "-1274.6348469882723513476598916263070605674095517017",
                "-1307.0819045584245729119006923940687284901504893986",
                "-1340.0746376562689815827625689155387666372339899517",
                "-1373.6175935311415413438854533174995320634530120482",
                "-1407.7153194334849365444473244314438803093304643361",
                "-1442.3723626148050614818304608417249974753460150486",
                "-1477.5932703276295370844389262520309177370177508337",
                "-1513.3825898254681459080145585128613649561595996651",
                "-1549.7448683627750832449882835970827533610871884228",
                "-1586.6846531949129282899353521645095254426260761819",
                "-1624.2064915781182450376826534612485188421251649902",
                "-1662.3149307694687279440448620215967692612658030144",
                "-1701.0145180268518123801643153421484864652672824930",
                "-1740.3098006089346745854400133461179634456456683285",
                "-1780.2053257751355501945036925232638517646314931029",
                "-1820.7056407855963045022600988465496255764588505873",
                "-1861.8152929011561914576065383893373780232080196384",
                "-1903.5388293833267419595024901284220774899176180706",
                "-1945.8807974942677253855860765384096867585716145542",
                "-1988.8457444967641314292522434161043332644990199858",
                "-2032.4382176542041222705539716805435641841040937886",
                "-2076.6627642305579078729099763728720334330254961749",
                "-2121.5239314903574997938461543347506300601925011974",
                "-2167.0262666986773013353886114806108389904523858598",
                "-2213.1743171211154941489410217494377073297043756338",
                "-2259.9726300237761835604155925965397705938754314777",
                "-2307.4257526732522669032234165080028335603654990517",
                "-2355.5382323366089910479822738483871762607947879742",
                "-2404.3146162813681671063728103075859423349036024323",
                "-2453.7594517754930119698085010366171065334642435349",
                "-2503.8772860873735879283016204293639795825049484748",
                "-2554.6726664858128131074466669184698254112627296158",
                "-2606.1501402400130168677004018951001306282582422707",
                "-2658.3142546195630156355994148469835534138066818649",
                "-2711.1695568944256858863278364552418833437770276617",
                "-2764.7205943349260121758841095779109265094133914920",
                "-2818.9719142117395892334260143520796338407016264802",
                "-2873.9280637958815581743256582582517845847412880162",
                "-2929.5935903586959578858900382838023805141885705121",
                "-2985.9730411718454735741885092385437333748558286992",
                "-3043.0709635073015653453265723972834761069875768010",
                "-3100.8919046373349605309437448802328083893522972956",
                "-3159.4404118345064942586131622393219709836264871382",
                "-3218.7210323716582835159113978973386776983485763627",
                "-3278.7383135219052206647598782683219963483939584508",
                "-3339.4968025586267730325996693140289261234579668095",
                "-3401.0010467554590758412806882746347129789924747856",
                "-3463.2555933862873063353126272660793273785489474078",
                "-3526.2649897252383275402927795459045277786258401478",
                "-3590.0337830466735906217260995992079127687583727384",
                "-3654.5665206251822853258001432413796774620555025264",
                "-3719.8677497355747284685792317203593488786677826901",
                "-3785.9420176528759809000450593316925917591828672429",
                "-3852.7938716523196838058481830812060768269052863102",
                "-3920.4278590093421056238722236518096424342256870229",
                "-3988.8485269995763912459944977656541426748912464965",
                "-4058.0604228988470055489214403181214689766865327425",
                "-4128.0680939831643636527817584595216725037320300547",
                "-4198.8760875287196406433056122757323810246465358140",
                "-4270.4889508118797538138730301765690504098744162998",
                "-4342.9112311091825107883900416327099081711806811851",
                "-4416.1474756973319171757032095485291602322832940639",
                "-4490.2022318531936376818981920857147188476392148672",
                "-4565.0800468537906048691039934734312828736969981507",
                "-4640.7854679762987699990555498636081213434025289304",
                "-4717.3230424980429906373254756858247032365674274004",
                "-4794.6973176964930499204543945379008388214458177333",
                "-4872.9128408492598026037849633759296674851529766990",
                "-4951.9741592340914432131998622119001430004649126289",
                "-5031.8858201288698918197089133230783959247527366316",
                "-5112.6523708116072931424252097869329540197220838869",
                "-5194.2783585604426248633864713186274100777025252359",
                "-5276.7683306536384112073610406672823450886224874984",
                "-5360.1268343695775380016482769392682455019606578628",
                "-5444.3584169867601655853374531946349057753178680784",
                "-5529.4676257838007360849024684846414855344756393746",
                "-5615.4590080394250717137358898700481095745411510148",
                "-5702.3371110324675608875997426243098261403793581140",
                "-5790.1064820418684290763084633038895236570603388683",
                "-5878.7716683466710914345607026004905393224372228867",
                "-5968.3372172260195843719841948521501686319859350791",
                "-6058.8076759591560733344194310781729878920155186834",
                "-6150.1875918254184341754967553554820632194792981705",
                "-6242.4815121042379055998975982533231700439987159168",
                "-6335.6939840751368102575609711523557293163340373511",
                "-6429.8295550177263421617161676975818263730960837940",
                "-6524.8927722117044181931956284422802797295867055784",
                "-6620.8881829368535915392012216643924233630580458505",
                "-6717.8203344730390249967458078400753154686189576686",
                "-6815.6937741002065221495434175744152927881613506379",
                "-6914.5130490983806145023402473530283758808766274604",
                "-7014.2827067476627027287210650071280857878844910317",
                "-7115.0072943282292502574396260918905737117881386960",
                "-7216.6913591203300274884478938806816087778894396547",
                "-7319.3394484042864049931706584121433772334489246378",
                "-7422.9561094604896941143162538651439662506765793551",
                "-7527.5458895693995334387507981814073081356474699826",
                "-7633.1133360115423196728070210878124271624299236212",
                "-7739.6629960675096815029579072157674371557587657312",
                "-7847.1994170179569950761632723148283822472157262552",
                "-7955.7271461436019397834921266340447798302202445297",
                "-8065.2507307252230930779285490772452885202831342970",
                "-8175.7747180436585631026725193932353225997539134991",
                "-8287.3036553798046579498341286416415228791870494399",
                "-8399.8420900146145904112701089036666065641974203383",
                "-8513.3945692290972171235021089928034638237881085649",
                "-8627.9656403043158110472593333947466298211760647665",
                "-8743.5598505213868662592733107359876877006707272085",
                "-8860.1817471614789340695856150948272781506516360832",
                "-8977.8358775058114895118731442380309525859713228939",
                "-9096.5267888356538272872099071556572323771029250483",
                "-9216.2590284323239862733262133194434053632357030003",
                "-9337.0371435771877017418500367240194779016930658757",
                "-9458.8656815516573844552729585385359458336029657981",
                "-9581.7491896371911258435238720858251759032359214622",
                "-9705.6922151152917284871046729680536089975113231636",
                "-9830.6993052675057611597883917225127303667328214126",
                "-9956.7750073754226377089445276534037757785545297551",
                "-10083.923868720673719075679619619416614729100266466",
                "-10212.150436584931437780202387101610540677326130019",
                "-10341.459258249908444220179364948571706420097145375",
                "-10471.854880997356774151374424790761487965210729116",
                "-10603.341852109067036740597909772521107503511847732",
                "-10735.924718866867622600960767348960111761893787525",
                "-10869.608028552623931238667057832749383869179088094",
                "-11004.396328448237617359114174850661123757009886349",
                "-11140.294165835645855497932355494386063927234292462",
                "-11277.306087996820622459810650400176532305053187037",
                "-11415.436642213767997064551344880391739338835400436",
                "-11554.690375768527476715793615892038687896661513088",
                "-11695.071835943171310323273640983722268049176264506",
                "-11836.585570019803847124365081024540308816572513416",
                "-11979.23612528056090096499249528566128669004206642",
                "-12123.02804900760912961385153833656425590592995468",
                "-12267.96588848314542869722356617281831390411204915",
                "-12414.05419098939633985455752836761200025012963468",
                "-12561.2975038086174727274269190201479966144614904",
                "-12709.7003742230929404064715053121544738055433432"
            };

            ddouble[] n8_expecteds = {
                "0",
                "-3.448368938925137416314633640872352950422e-10",
                "-8.080454607591691025746017886918123028080e-8",
                "-1.903718872875402992919660002611999051966e-6",
                "-0.00001755072727456215743774893726366968105595",
                "-0.00009691656608753182897978047895693730196548",
                "-0.0003874456901902376902459631558720236902268",
                "-0.001240488481044899286379028060994089028407",
                "-0.003378239908816548598804577928328978468503",
                "-0.008134718054729697542724838153254312919752",
                "-0.01778378362453105042437274893644290544931",
                "-0.03596686423802320925268164850495702088892",
                "-0.06823282769823549410788029498120406488966",
                "-0.1227023217439221130062173096025917556846",
                "-0.2108688358856705785840339018653858771930",
                "-0.3485487201594292591222117891145252146266",
                "-0.5569923985638492322974238154236311672198",
                "-0.8641690298124775247670896154171584301466",
                "-1.306236887465022927116664218542866504190",
                "-1.929211751256948748749957727750777252543",
                "-2.790845619335905086982918344003999375000",
                "-3.962728066226385717070895421600983879104",
                "-5.532622583507934424827471328469148886338",
                "-7.607050249621830932318725148385361792498",
                "-10.31413308230183850506228713763962249388",
                "-13.80670943228709014675319927434860189339",
                "-18.26573378062900581890832744723151585677",
                "-23.90397330440670286591705079037930022012",
                "-30.97001357731226775501222830975435998983",
                "-39.75258577259369408113754236937307739915",
                "-50.58522773643089461073572440465564327163",
                "-63.85129130010578918839864623041021144742",
                "-79.98930819941186985688203376266397837143",
                "-99.49872696970458575039446874245989028447",
                "-122.9460331848727430216313235284881685266",
                "-150.9712654083483248424711314027456763937",
                "-184.2949392240915025583547245147688969330",
                "-223.7253917153045658945845526073950870235",
                "-270.1665587584525848575716987611384589081",
                "-324.6261975000052909298814357790094056081",
                "-388.2245663831666422267119063239718032880",
                "-462.2035750917267254125468502466699803822",
                "-547.9364167780548191460747780753401519895",
                "-646.9376949421516972592654653575494755392",
                "-760.8740573285923195805683124795304612736",
                "-891.5753492081155225621699574162213045781",
                "-1041.046298410553734272028978141992031675",
                "-1211.478744475741708132859690104411270897",
                "-1405.264424288997507325427220861585085373",
                "-1625.008326567730310455185592857576657808",
                "-1873.542627565697012591060788208434978245",
                "-2153.941220361402155850473205349042693775",
                "-2469.534850097112652458902881106818799908",
                "-2823.926867534939382704500723134175308937",
                "-3221.009613296421480745757362330482616656",
                "-3664.981445152035469612937314751188581021",
                "-4160.364420727039955023733231334338014157",
                "-4712.022647990056982747139943499124037061",
                "-5325.181315890783108686620147200233598310",
                "-6005.446417513216474403297615606427702610",
                "-6758.825178110780513345946656988827319961",
                "-7591.747200389720158349473368418168971283",
                "-8511.086339407142431290380803583768923206",
                "-9524.183319450069947410696949128595080189",
                "-10638.86910526187305612894268139578914404",
                "-11863.489039982443980400621545597109577496636579166",
                "-13206.927762168474335244428081422125691897784489673",
                "-14678.634914260195742101506005199891014411463081002",
                "-16288.651654860941858312426923479727129571327400172",
                "-18047.637987195888967511155601274459392758710559051",
                "-19966.900916116331291386358959588162123856151344552",
                "-22058.423446015846356063751612564250303278945899180",
                "-24334.894432024705052165699354919717401111818189664",
                "-26809.739296848880445294787945622387953485419646920",
                "-29497.151625620008905537995517464257122518379256240",
                "-32412.125651122656715701373613399411614202551699000",
                "-35570.489641765244975838466254093190423516892964959",
                "-38988.940204660985335694741613861181874565783235441",
                "-42685.077516185178848088892178033905755140213018731",
                "-46677.441492375230037523766540205519216642386655999",
                "-50985.548911539728113174384238141525601958003654499",
                "-55629.931501442947118535351519739818441031744774443",
                "-60632.175003431116696953180942422423790026366289808",
                "-66014.959225866815059247680505685107803932961553443",
                "-71802.099099237835663456445386898767448223797336421",
                "-78018.586745306879054729172823202415651693033741313",
                "-84690.634572668421263283711296777848155328907801203",
                "-91845.719411079110118195806808582578157780478203154",
                "-99512.627696928040803009465386537026431110743224909",
                "-107721.50172221326195435616753223812115308389497548",
                "-116503.88695939086358580274570026102346794174084137",
                "-125892.78047446299810503307202524939222225943539319",
                "-135922.68044067118568238321090869584544186191689313",
                "-146629.63676516125522199731732579307084155600276782",
                "-158051.30284098627218286505474054660801530347063766",
                "-170226.98843681380449524553665472498520653538362744",
                "-183197.71373670387781806065369102452344424598887634",
                "-197006.26454232397138440111338423720430993786530950",
                "-211697.24864996740568503656084968236212022669235909",
                "-227317.15341474147324350916715416602950251779982715",
                "-243914.40451429166374081065428055173351716437027970",
                "-261539.42592442833475262249405240536267040720322006",
                "-280244.70111902217936749342011062740532039581587238",
                "-300084.83550653484196001727409201457191948528019302",
                "-321116.62011555103339895806219819000762925578102756",
                "-343399.09654167849697626587678828660378033267774616",
                "-366993.62316818217634896974060273436715673081327389",
                "-391963.94267271893679196661132147713970689315315369",
                "-418376.25083253919106570539244529617607889079518178",
                "-446299.26664052178120865532357276291444583654292478",
                "-475804.30374440846757022149011852300956299106371233",
                "-506965.34322160437640540455430675271921503461726544",
                "-539859.10770191075735798053862886035931112347833303",
                "-574565.13685055640216428731811680716835154732142912",
                "-611165.86422389407591483875090724121706496815838860",
                "-649746.69551012831221593945345433763375868670754113",
                "-690396.08816744092359823994131270698880712558930569",
                "-733205.63247188057852375207585947342225315681085846",
                "-778270.13398738279634723900599276804053399883358344",
                "-825687.69747028671159210393554396722236142108769719",
                "-875559.81222071495890493101730377935434523871938902",
                "-927991.43889318303005668325477653498982873323945631",
                "-983091.09777880445436224092141001560328327368233760",
                "-1.0409709585714581538934746205639835986259778701617e6",
                "-1.1017469316302843248643950098646776287459290880858e6",
                "-1.1655387607508751965701119579646208957165641722162e6",
                "-1.2324701174575270192643752108000025373193159619569e6",
                "-1.3026686968289196323633623269699119450290664277454e6",
                "-1.3762663148695899643661335326680344366812070987531e6",
                "-1.4533990074395658158847930560435593230535393104806e6",
                "-1.5342071307545262771798881740725280623429480994253e6",
                "-1.6188354634688551315989462892549642660827904916558e6",
                "-1.7074333103539535963183023724478961818393682077962e6",
                "-1.8001546075841787517905094422047757844597370773086e6",
                "-1.8971580296427740113016586219808743905184408890740e6",
                "-1.9986070978601579820448677769586371709452789351937e6",
                "-2.1046702905969380691180336575840154711124635748754e6",
                "-2.2155211550840151738556865610428456227753597771254e6",
                "-2.3313384209321458379064432746071852942503633788687e6",
                "-2.4523061153233281844691278111974182632803894623697e6",
                "-2.5786136798963780081021243292178113858883222940020e6",
                "-2.7104560893390613645219466060304598679382358244408e6",
                "-2.8480339716991500118083572896415813792569336275710e6",
                "-2.9915537304267660544346514946720573381284277802669e6",
                "-3.1412276681603821415429365756183483922631080269710e6",
                "-3.2972741122688435708853963778226081347117508537764e6",
                "-3.4599175421617786498536270508625988315194638292595e6",
                "-3.6293887183807636650191755736896460249150562184215e6",
                "-3.8059248134836088116094043021039868538126893788400e6",
                "-3.9897695447341314343437477821397818094537604719870e6",
                "-4.1811733086097829310563243173717670364565824521477e6",
                "-4.3803933171394956705317167442979401267557883734594e6",
                "-4.5876937360841162759815468443284574944061096386025e6",
                "-4.8033458249717916255902379719981176812019337208728e6",
                "-5.0276280790006739215590928627711470364550993363695e6",
                "-5.2608263728213111790785101490233627452583515118041e6",
                "-5.5032341062110894866588257063228918231384709286450e6",
                "-5.7551523516530933892508953239231357496382511650570e6",
                "-6.0168900038317507455881350012929596429796636257717e6",
                "-6.2887639310576284111823059869827652516919124443201e6",
                "-6.5710991286337450984058749846516244525641057695218e6",
                "-6.8642288741757677650942971624730632446081535624209e6",
                "-7.1684948848984578831020620506186597654831211347145e6",
                "-7.4842474768807339382468113606250515595121041921816e6",
                "-7.8118457263217165130762844067500087214978905657941e6",
                "-8.1516576328001223038932722860623395145105224438198e6",
                "-8.5040602845493734234741673540822193805402826975100e6",
                "-8.8694400257607883409170808325401259873706214023114e6",
                "-9.2481926259272208100558695676988588998762391406069e6",
                "-9.6407234512395131378767639332168084190883693732320e6",
                "-1.0047447638048130144374623504083507971830274835352e7",
                "-1.0468790268402340165286166235520480651615930400784e7",
                "-1.0905186547679309449137821237592358692149131527179e7",
                "-1.1357081984315476300046145576519802776983783489504e7",
                "-1.1824932571652571317709022552663802527978178081507e7",
                "-1.2309204971910650086026123261720160901070621485320e7",
                "-1.2810376702300504661787365564183615488401928209588e7",
                "-1.3328936323287820214868345460344872297846046054775e7",
                "-1.3865383629021443171371945854843300188899351380860e7",
                "-1.4420229839938127211155547327799162436746171640538e7",
                "-1.4993997797556123471183475312872884579723460113835e7",
                "-1.5587222161469981306144518494215233531466976734711e7",
                "-1.6200449608558925957774544727453528401054949639692e7",
                "-1.6834239034421179484324423794513749440523965938465e7",
                "-1.7489161757046591301613641226012848816035618906423e7",
                "-1.8165801722739944687110154655064855667197436200928e7",
                "-1.8864755714307305598477204069738195885740129120155e7",
                "-1.9586633561517780158027940256467535486700931273606e7",
                "-2.0332058353853047154528882004131233860125460650387e7",
                "-2.1101666655557031913793352582156182602025016476948e7",
                "-2.1896108722998087889506179913934004321645338309859e7",
                "-2.2716048724356052325721073022029255575809795726319e7",
                "-2.3562164961646542342472209992908709663920411025057e7",
                "-2.4435150095094857795941690151528363368081605580594e7",
                "-2.5335711369871857264624615592632997064631505205773e7",
                "-2.6264570845204173512933674916522133394719264547598e7",
                "-2.7222465625871134783685205181342479947862113538602e7",
                "-2.8210148096100758270908806919865338733348609626838e7",
                "-2.9228386155877182124422681774110733740891248484724e7",
                "-3.0277963459671902337616953064266636817220818251568e7",
                "-3.1359679657611180869887316608074430018301933867424e7",
                "-3.2474350639091991355161452513418354594265710139658e7",
                "-3.3622808778858868747960708642184262070432615489303e7",
                "-3.4805903185554029258439643141597612765343272445196e7",
                "-3.6024499952753126927846087006813738242776020987657e7",
                "-3.7279482412499013195844458215045724009264880601705e7",
                "-3.8571751391345865811145126689800513586776480447629e7",
                "-3.9902225468926053436882694340312132053995035079654e7",
                "-4.1271841239052102302186116796434083202576658556639e7",
                "-4.2681553573366131251383653337772093061313507250295e7",
                "-4.4132335887549121542285689006954959130740361289339e7",
                "-4.5625180410102387744988528104742725654181903589357e7",
                "-4.7161098453713616092642311288341812494583352512256e7",
                "-4.8741120689219836635626259428363667884811472786965e7",
                "-5.0366297422179695550574496314431814134841325016002e7",
                "-5.2037698872067393955695749320415169333185119647715e7",
                "-5.3756415454100659583830272329554742864924831001336e7",
                "-5.5523558063715117664687378655474349548869590161518e7",
                "-5.7340258363697427367707013451736705227150588375465e7",
                "-5.9207669073989550156988835251309883866992909664877e7",
                "-6.1126964264176516409732314885873096073649017820005e7",
                "-6.3099339648670056649631397168044313390177143124790e7",
                "-6.5126012884600463746667306439138077126006359418494e7",
                "-6.7208223872429052434743111449939805491329370346454e7",
                "-6.9347235059293582498603698108526555262464159821472e7",
                "-7.1544331745099011981484830451149911378717818689377e7",
                "-7.3800822391365946764935010820986419452111467190897e7",
                "-7.6118038932849152872253879724218574531453781856155e7",
                "-7.8497337091938497846990924220310929479034188902901e7",
                "-8.0940096695854687557948291038284486367412280579242e7",
                "-8.3447721996652164782131526936077692042635469136942e7",
                "-8.6021641994041535917092094176634348479669394093995e7",
                "-8.8663310761043892174105533421298189132057666223887e7",
                "-9.1374207772489391603629169875826784852642518876180e7",
                "-9.4155838236372468304483281202636023417260249087551e7",
                "-9.7009733428076035168199667568965747133021451595010e7",
                "-9.9937451027477046509981585267248101835373759200035e7",
                "-1.0294057545894578693771902565237863725085133779847e8",
                "-1.0602071823425125281050334072080291401769484318532e8",
                "-1.0917951829838499263808523553701838569583684483584e8",
                "-1.1241864237831577277272016592170550714620768796516e8",
                "-1.1573978533468743474484519737852556382431752449277e8",
                "-1.1914467051647231059403139817882086494855191357144e8",
                "-1.2263505011859256254665585586912510162748697165625e8",
                "-1.2621270554252181339173742223862001064590214158308e8",
                "-1.2987944775987943390638030700457018569268078209160e8",
                "-1.3363711767902985368226965516451512440977195127689e8",
                "-1.3748758651469926170466325714489544625449054949649e8",
                "-1.4143275616062206303532355456629243393498130749992e8",
                "-1.4547455956522945795083411766421305718572772615290e8",
                "-1.4961496111039250988774478316923160518418588995790e8",
                "-1.5385595699323206854598965377844229619993211173239e8",
                "-1.5819957561100791450202217225801894809314541125517e8",
                "-1.6264787794909949168311149471997925255309109560867e8",
                "-1.6720295797209059405424439873013045578346701950697e8",
                "-1.7186694301797037286907697264313345779716669425670e8",
                "-1.7664199419546303083638034293857871865093483661310e8"
            };

            ddouble[] n0largex_expecteds = {
                "-0.00248683393651926370601572952876222388",
                "-0.00124340273625521586330705415594527985",
                "-0.000621699589356170616667469520009126930",
                "-0.000310849572338812787917529897604571803",
                "-0.000155424758377220968656141337943869714",
                "-0.0000777123757145942947433853940981023214",
                "-0.0000388561874230453420653926017939756599",
                "-0.0000194280936572412021941420770900427705",
            };

            foreach ((int n, ddouble[] expecteds) in new (int, ddouble[])[] {
                (0, n0_expecteds),
                (1, n1_expecteds),
                (2, n2_expecteds),
                (4, n4_expecteds),
                (8, n8_expecteds)}) {

                for ((ddouble x, int i) = (0, 0); i < expecteds.Length; x += 0.5d, i++) {
                    ddouble expected = expecteds[i];

                    ddouble actual = ddouble.StruveM(n, x);
                    HPAssert.AreEqual(expected, actual, ddouble.Abs(expected) * 1e-29d, $"{x},{n}");

                    if (x > 0) {
                        ddouble actual_dec = ddouble.StruveM(n, ddouble.BitDecrement(x));
                        HPAssert.AreEqual(expected, actual_dec, ddouble.Abs(expected) * 1e-29d, $"{x}-eps,{n}");

                        ddouble actual_inc = ddouble.StruveM(n, ddouble.BitIncrement(x));
                        HPAssert.AreEqual(expected, actual_inc, ddouble.Abs(expected) * 1e-29d, $"{x}+eps,{n}");
                    }
                }
            }

            for ((ddouble x, int i) = (256, 0); i < n0largex_expecteds.Length; x *= 2, i++) {
                int n = 0;

                ddouble expected = n0largex_expecteds[i];

                ddouble actual = ddouble.StruveM(n, x);
                HPAssert.AreEqual(expected, actual, ddouble.Abs(expected) * 1e-29d, $"{x},{n}");

                if (x > 0) {
                    ddouble actual_dec = ddouble.StruveM(n, ddouble.BitDecrement(x));
                    HPAssert.AreEqual(expected, actual_dec, ddouble.Abs(expected) * 1e-29d, $"{x}-eps,{n}");

                    ddouble actual_inc = ddouble.StruveM(n, ddouble.BitIncrement(x));
                    HPAssert.AreEqual(expected, actual_inc, ddouble.Abs(expected) * 1e-29d, $"{x}+eps,{n}");
                }
            }
        }
    }
}
